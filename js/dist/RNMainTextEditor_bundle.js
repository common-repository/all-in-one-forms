rndefine("#RNMainTextEditor",["#RNMainBasicTextEditor/TextEditor","#RNMainBasicTextEditor/SchemaBase","#RNMainBasicTextEditor/MenuItem","#RNMainBasicTextEditor/NodeIsSelected","#RNMainBasicTextEditor/NumberMenuItem","#RNMainBasicTextEditor/DropDownMenuItem","#RNMainBasicTextEditor/ButtonMenuItem","#RNMainBasicTextEditor/TextEditorUtilities","lit/decorators","lit","#RNMainProseMirror/ProseMirror","#RNMainInputs/InputBase","lit/directives/repeat.js","#RNMainCore/SingleEvent","lit-html/directives/live.js","#RNMainDialog/DialogBase","#RNMainDialog/Dialog","#RNMainBasicTextEditor/TextEditorUtils","#RNMainBasicTextEditor/Utils","#RNMainBasicTextEditor/ColorMark","#RNMainBasicTextEditor/Schema","#RNMainCore/LitElementBase","#RNMainCore/EventManager","#RNMainBasicTextEditor/MenuBar","#RNMainBasicTextEditor/FontSizeMark","#RNMainParser/FormulaBuilder.Model","#RNMainBasicTextEditor/BasicLinkType","#RNMainBasicTextEditor/LinkTypeBase","#RNMainLit/Lit","#RNMainBasicTextEditor/AdditionalItemBase","#RNMainBasicTextEditor/MenuItemBase"],(function(e,t,n,i,r,o,a,s,l,u,c,d,p,h,f,m,g,v,b,y,w,x,M,S,O,E,k,L,C,I,T){"use strict";var D={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=[],n="f02b",i="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z";e.definition={prefix:"fas",iconName:"tag",icon:[512,512,t,n,i]},e.faTag=e.definition,e.prefix="fas",e.iconName="tag",e.width=512,e.height=512,e.ligatures=t,e.unicode=n,e.svgPathData=i}(D);var P={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t="search",n=[],i="f002",r="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z";e.definition={prefix:"fas",iconName:t,icon:[512,512,n,i,r]},e.faSearch=e.definition,e.prefix="fas",e.iconName=t,e.width=512,e.height=512,e.ligatures=n,e.unicode=i,e.svgPathData=r}(P);class V{constructor(e,t=null,n="",i=null){this.Group=e,this.Value=t,this.Label=n,this.AdditionalOptions=i,this.IsVisible=!0}Render(){return u.html` <li class='serverItem' style="margin:0;padding:10px;" @mousedown=${()=>this.ValueSelected()}>${this.Label}</li> `}ValueSelected(){this.Group.Collection.ItemSelected.Publish({Type:this.Group.Type,Value:this.Value,AdditionalOptions:this.AdditionalOptions})}Filter(e){this.IsVisible=this.Label.toLowerCase().indexOf(e)>=0}}class A{constructor(e,t=null,n){this.Collection=e,this.Type=t,this.Label=n,this.Items=[]}CreateItem(e=null,t,n=null){let i=new V(this,e,t);return this.Items.push(i),this}get IsVisible(){return this.Items.filter((e=>e.IsVisible)).length>0}Render(){return u.html` <rn-accordion-item title=${this.Label} ?isOpen=${!0} .content=${u.html` <ul style="margin:0;padding: 0;"> ${p.repeat(this.Items.filter((e=>e.IsVisible)),(e=>e.Value),(e=>e.Render()))} </ul> `}></rn-accordion-item> `}Filter(e){this.Items.forEach((t=>t.Filter(e)))}}var _,B,N,H,R,j={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=[],n="f11a",i="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 448c-110.3 0-200-89.7-200-200S137.7 56 248 56s200 89.7 200 200-89.7 200-200 200zm-80-216c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32zm160-64c-17.7 0-32 14.3-32 32s14.3 32 32 32 32-14.3 32-32-14.3-32-32-32zm8 144H160c-13.2 0-24 10.8-24 24s10.8 24 24 24h176c13.2 0 24-10.8 24-24s-10.8-24-24-24z";e.definition={prefix:"far",iconName:"meh",icon:[496,512,t,n,i]},e.faMeh=e.definition,e.prefix="far",e.iconName="meh",e.width=496,e.height=512,e.ligatures=t,e.unicode=n,e.svgPathData=i}(j);class F{constructor(){this.Groups=[],this.ItemSelected=new h.SingleEvent}CreateGroup(e,t,n=null){let i=new A(this,e,t);return this.Groups.push(i),null!=n&&n(i),this}Render(){let e=this.Groups.filter((e=>e.IsVisible));return 0==e.length?u.html` <div style="padding: 10px;margin-top: 10px;display: flex;align-items: center;"> <rn-fontawesome .icon="${j.faMeh}" style="font-size: 20px;margin-right: 5px"></rn-fontawesome> There are no available tags </div> `:u.html` <div style="margin-top: 10px"> ${p.repeat(e,(e=>e.Type),(e=>e.Render()))} </div> `}Filter(e){this.Groups.forEach((t=>t.Filter(e)))}GetField(e,t){let n=this.Groups.find((t=>t.Type==e));return null==n?null:n.Items.find((e=>e.Value==t))}}function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}l.customElement("rn-single-line-dialog")(class extends m.DialogBase{constructor(...e){super(...e),this.collection=null}static get properties(){return{applyIsBusy:{type:Boolean}}}InternalGetOptions(){return{Title:"Select a tag",Styles:{maxWidth:"80%",width:"800px"}}}connectedCallback(){super.connectedCallback(),this.collection.ItemSelected.Subscribe(this,(e=>this.SendResult(e)))}disconnectedCallback(){super.disconnectedCallback(),this.collection.ItemSelected.Unsubscribe(this)}SubRender(){return null==this.collection&&(this.collection=new F),u.html` <div class='formulaFieldPicker'> <div> <div style="width: 100%;position:relative;"> <rn-fontawesome .icon=${P.faSearch} style="position:absolute;left: 2px;color:#ccc;font-size: 20px;margin-top: -10px;top:50%;"></rn-fontawesome> <input type='text' style="width:100%;padding-left: 25px;" placeholder='Search a tag by label or id' @input=${e=>this.Search(e.target.value)} value=${f.live(this.filter)}/> </div> ${this.collection.Render()} </div> </div> `}Search(e){this.collection.Filter(e),this.forceUpdate()}});let $=(_=l.customElement("rn-single-line-text-editor"),B=l.query(".singleLine"),_((H=class extends d.InputBase{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"Editor",R,this),this.LatestValue=null,this.View=null,this.nodes=[],this.collection=null,this._schema=null}static get properties(){return{}}get schema(){return null==this._schema&&(this._schema=new c.Schema({nodes:{text:{group:"inline",inline:!0},doc:{content:"(block|inline)*"},field:{attrs:{Type:{default:null},Value:{default:null},AdditionalOptions:{default:null}},draggable:!1,group:"block",inline:!0,toDOM:e=>{let t=e.attrs.Type,n=e.attrs.Value,i=this.collection.GetField(t,n),r="Unknown";return null!=i&&(r=i.Label),u.renderInline(u.html`<span style="background-color: #efefef;border: 1px solid #999;padding: 0 2px;">${r}</span>`)},parseDOM:[{tag:"span",getAttrs:e=>({Type:e.getAttribute("data-type"),Value:e.getAttribute("data-id"),AdditionalOptions:e.getAttribute("data-url")})}]}}})),this._schema}update(e){if(this.LatestValue!=this.GetValue()&&null!=this.LatestValue)if(null!=this.View){let e=this.CreateState();this.View.updateState(e)}else this.LatestValue=this.value;super.update(e)}CreateState(){var e,t;let n={};null===(e=this.nodes)||void 0===e||e.forEach((e=>{n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n,{},e.GetNodes())}));const i=new c.Schema({nodes:c.addListNodes(this.schema.spec.nodes.append(n))});return c.EditorState.create({doc:null==this.GetValue()||""==this.GetValue()?c.DOMParser.fromSchema(i).parse(null!==(t=this.GetValue())&&void 0!==t?t:""):i.nodeFromJSON(this.GetValue())})}firstUpdated(e){super.firstUpdated(e);let t=this.CreateState();this.View=new c.EditorView(this.Editor,{dispatchTransaction:e=>{const t=this.View.state.apply(e);this.View.updateState(t);let n=t.toJSON().doc;null==n.content&&(n=null),this.LatestValue=n,this.SetValue(n)},state:t})}SubRender(){return null==this.LatestValue&&(this.LatestValue=this.value),u.html` <div style="width: 100%;position: relative;"> <div class="singleLine" style="background-color: white"> </div> <rn-fontawesome .collection="${this.collection}" @click="${()=>this.OpenDialog()}" class="rnIcon" style="font-size: 16px;height: 33.5px;right: 2px;position: absolute;top:0;" .icon="${D.faTag}"></rn-fontawesome> </div> `}async OpenDialog(){let e=await g.Dialog.Show(u.html`<rn-single-line-dialog .collection="${this.collection}"></rn-single-line-dialog>`);null!=e&&this.View.dispatch(this.View.state.tr.replaceSelectionWith(this.View.state.doc.type.schema.nodes.field.createAndFill({Type:e.Type,Value:e.Value,AdditionalOptions:e.AdditionalOptions})))}},R=babelHelpers.applyDecoratedDescriptor(H.prototype,"Editor",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=H))||N);!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t="table",n=[],i="f0ce",r="M464 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zM224 416H64v-96h160v96zm0-160H64v-96h160v96zm224 160H288v-96h160v96zm0-160H288v-96h160v96z";e.definition={prefix:"fas",iconName:t,icon:[512,512,n,i,r]},e.faTable=e.definition,e.prefix="fas",e.iconName=t,e.width=512,e.height=512,e.ligatures=n,e.unicode=i,e.svgPathData=r}({});var z={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t="align-center",n=[],i="f037",r="M432 160H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0 256H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zM108.1 96h231.81A12.09 12.09 0 0 0 352 83.9V44.09A12.09 12.09 0 0 0 339.91 32H108.1A12.09 12.09 0 0 0 96 44.09V83.9A12.1 12.1 0 0 0 108.1 96zm231.81 256A12.09 12.09 0 0 0 352 339.9v-39.81A12.09 12.09 0 0 0 339.91 288H108.1A12.09 12.09 0 0 0 96 300.09v39.81a12.1 12.1 0 0 0 12.1 12.1z";e.definition={prefix:"fas",iconName:t,icon:[448,512,n,i,r]},e.faAlignCenter=e.definition,e.prefix="fas",e.iconName=t,e.width=448,e.height=512,e.ligatures=n,e.unicode=i,e.svgPathData=r}(z);var G={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t="align-left",n=[],i="f036",r="M12.83 352h262.34A12.82 12.82 0 0 0 288 339.17v-38.34A12.82 12.82 0 0 0 275.17 288H12.83A12.82 12.82 0 0 0 0 300.83v38.34A12.82 12.82 0 0 0 12.83 352zm0-256h262.34A12.82 12.82 0 0 0 288 83.17V44.83A12.82 12.82 0 0 0 275.17 32H12.83A12.82 12.82 0 0 0 0 44.83v38.34A12.82 12.82 0 0 0 12.83 96zM432 160H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0 256H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z";e.definition={prefix:"fas",iconName:t,icon:[448,512,n,i,r]},e.faAlignLeft=e.definition,e.prefix="fas",e.iconName=t,e.width=448,e.height=512,e.ligatures=n,e.unicode=i,e.svgPathData=r}(G);var U={};function q(){var e=arguments[0];"string"==typeof e&&(e=document.createElement(e));var t=1,n=arguments[1];if(n&&"object"==typeof n&&null==n.nodeType&&!Array.isArray(n)){for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){var r=n[i];"string"==typeof r?e.setAttribute(i,r):null!=r&&(e[i]=r)}t++}for(;t<arguments.length;t++)K(e,arguments[t]);return e}function K(e,t){if("string"==typeof t)e.appendChild(document.createTextNode(t));else if(null==t);else if(null!=t.nodeType)e.appendChild(t);else{if(!Array.isArray(t))throw new RangeError("Unsupported child node: "+t);for(var n=0;n<t.length;n++)K(e,t[n])}}!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t="align-right",n=[],i="f038",r="M16 224h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16zm416 192H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm3.17-384H172.83A12.82 12.82 0 0 0 160 44.83v38.34A12.82 12.82 0 0 0 172.83 96h262.34A12.82 12.82 0 0 0 448 83.17V44.83A12.82 12.82 0 0 0 435.17 32zm0 256H172.83A12.82 12.82 0 0 0 160 300.83v38.34A12.82 12.82 0 0 0 172.83 352h262.34A12.82 12.82 0 0 0 448 339.17v-38.34A12.82 12.82 0 0 0 435.17 288z";e.definition={prefix:"fas",iconName:t,icon:[448,512,n,i,r]},e.faAlignRight=e.definition,e.prefix="fas",e.iconName=t,e.width=448,e.height=512,e.ligatures=n,e.unicode=i,e.svgPathData=r}(U);class J{constructor(e,t=!1){this.Options=e,this.IsSubMenu=t}}const X="ProseMirror-menu";function Y(e,t,n){n?e.classList.add(t):e.classList.remove(t)}function Q(e,t){return e._props.translate?e._props.translate(t):t}class Z extends J{constructor(e,t=!1){super(e,t)}render(e){let t=this.Options,n=t.render?t.render(e):t.icon?c.getIcon(t.icon):t.label?q("div",null,Q(e,t.label)):null;if(!n)throw new RangeError("MenuItem without icon or label property");if(t.title){const i="function"==typeof t.title?t.title(e.state):t.title;n.setAttribute("title",Q(e,i))}return t.class&&n.classList.add(t.class),t.css&&(n.style.cssText+=t.css),n.addEventListener("mousedown",(i=>{"SELECT"!=i.target.tagName&&i.preventDefault(),n.classList.contains(X+"-disabled")||t.run(e.state,e.dispatch,e,i)})),{dom:n,update:function(e){if(t.select){let i=t.select(e);if(n.style.display=i?"":"none",!i)return!1}let i=!0;if(t.enable&&(i=t.enable(e)||!1,Y(n,X+"-disabled",!i)),t.active){let r=i&&t.active(e)||!1;Y(n,X+"-active",r)}return!0}}}}var ee="top",te="bottom",ne="right",ie="left",re="auto",oe=[ee,te,ne,ie],ae="start",se="end",le="clippingParents",ue="viewport",ce="popper",de="reference",pe=oe.reduce((function(e,t){return e.concat([t+"-"+ae,t+"-"+se])}),[]),he=[].concat(oe,[re]).reduce((function(e,t){return e.concat([t,t+"-"+ae,t+"-"+se])}),[]),fe=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function me(e){return e?(e.nodeName||"").toLowerCase():null}function ge(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function ve(e){return e instanceof ge(e).Element||e instanceof Element}function be(e){return e instanceof ge(e).HTMLElement||e instanceof HTMLElement}function ye(e){return"undefined"!=typeof ShadowRoot&&(e instanceof ge(e).ShadowRoot||e instanceof ShadowRoot)}var we={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},i=t.attributes[e]||{},r=t.elements[e];be(r)&&me(r)&&(Object.assign(r.style,n),Object.keys(i).forEach((function(e){var t=i[e];!1===t?r.removeAttribute(e):r.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var i=t.elements[e],r=t.attributes[e]||{},o=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]="",e}),{});be(i)&&me(i)&&(Object.assign(i.style,o),Object.keys(r).forEach((function(e){i.removeAttribute(e)})))}))}},requires:["computeStyles"]};function xe(e){return e.split("-")[0]}var Me=Math.round;function Se(e,t){void 0===t&&(t=!1);var n=e.getBoundingClientRect(),i=1,r=1;return be(e)&&t&&(i=n.width/e.offsetWidth||1,r=n.height/e.offsetHeight||1),{width:Me(n.width/i),height:Me(n.height/r),top:Me(n.top/r),right:Me(n.right/i),bottom:Me(n.bottom/r),left:Me(n.left/i),x:Me(n.left/i),y:Me(n.top/r)}}function Oe(e){var t=Se(e),n=e.offsetWidth,i=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-i)<=1&&(i=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:i}}function Ee(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&ye(n)){var i=t;do{if(i&&e.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function ke(e){return ge(e).getComputedStyle(e)}function Le(e){return["table","td","th"].indexOf(me(e))>=0}function Ce(e){return((ve(e)?e.ownerDocument:e.document)||window.document).documentElement}function Ie(e){return"html"===me(e)?e:e.assignedSlot||e.parentNode||(ye(e)?e.host:null)||Ce(e)}function Te(e){return be(e)&&"fixed"!==ke(e).position?e.offsetParent:null}function De(e){for(var t=ge(e),n=Te(e);n&&Le(n)&&"static"===ke(n).position;)n=Te(n);return n&&("html"===me(n)||"body"===me(n)&&"static"===ke(n).position)?t:n||function(e){var t=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");if(-1!==navigator.userAgent.indexOf("Trident")&&be(e)&&"fixed"===ke(e).position)return null;for(var n=Ie(e);be(n)&&["html","body"].indexOf(me(n))<0;){var i=ke(n);if("none"!==i.transform||"none"!==i.perspective||"paint"===i.contain||-1!==["transform","perspective"].indexOf(i.willChange)||t&&"filter"===i.willChange||t&&i.filter&&"none"!==i.filter)return n;n=n.parentNode}return null}(e)||t}function Pe(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}var Ve=Math.max,Ae=Math.min,_e=Math.round;function Be(e,t,n){return Ve(e,Ae(t,n))}function Ne(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function He(e,t){return t.reduce((function(t,n){return t[n]=e,t}),{})}var Re={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,i=e.name,r=e.options,o=n.elements.arrow,a=n.modifiersData.popperOffsets,s=xe(n.placement),l=Pe(s),u=[ie,ne].indexOf(s)>=0?"height":"width";if(o&&a){var c=function(e,t){return Ne("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:He(e,oe))}(r.padding,n),d=Oe(o),p="y"===l?ee:ie,h="y"===l?te:ne,f=n.rects.reference[u]+n.rects.reference[l]-a[l]-n.rects.popper[u],m=a[l]-n.rects.reference[l],g=De(o),v=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,b=f/2-m/2,y=c[p],w=v-d[u]-c[h],x=v/2-d[u]/2+b,M=Be(y,x,w),S=l;n.modifiersData[i]=((t={})[S]=M,t.centerOffset=M-x,t)}},effect:function(e){var t=e.state,n=e.options.element,i=void 0===n?"[data-popper-arrow]":n;null!=i&&("string"!=typeof i||(i=t.elements.popper.querySelector(i)))&&Ee(t.elements.popper,i)&&(t.elements.arrow=i)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},je={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Fe(e){var t,n=e.popper,i=e.popperRect,r=e.placement,o=e.offsets,a=e.position,s=e.gpuAcceleration,l=e.adaptive,u=e.roundOffsets,c=!0===u?function(e){var t=e.x,n=e.y,i=window.devicePixelRatio||1;return{x:_e(_e(t*i)/i)||0,y:_e(_e(n*i)/i)||0}}(o):"function"==typeof u?u(o):o,d=c.x,p=void 0===d?0:d,h=c.y,f=void 0===h?0:h,m=o.hasOwnProperty("x"),g=o.hasOwnProperty("y"),v=ie,b=ee,y=window;if(l){var w=De(n),x="clientHeight",M="clientWidth";w===ge(n)&&"static"!==ke(w=Ce(n)).position&&(x="scrollHeight",M="scrollWidth"),r===ee&&(b=te,f-=w[x]-i.height,f*=s?1:-1),r===ie&&(v=ne,p-=w[M]-i.width,p*=s?1:-1)}var S,O=Object.assign({position:a},l&&je);return s?Object.assign({},O,((S={})[b]=g?"0":"",S[v]=m?"0":"",S.transform=(y.devicePixelRatio||1)<2?"translate("+p+"px, "+f+"px)":"translate3d("+p+"px, "+f+"px, 0)",S)):Object.assign({},O,((t={})[b]=g?f+"px":"",t[v]=m?p+"px":"",t.transform="",t))}var We={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,i=n.gpuAcceleration,r=void 0===i||i,o=n.adaptive,a=void 0===o||o,s=n.roundOffsets,l=void 0===s||s,u={placement:xe(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,Fe(Object.assign({},u,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,Fe(Object.assign({},u,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},$e={passive:!0};var ze={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,i=e.options,r=i.scroll,o=void 0===r||r,a=i.resize,s=void 0===a||a,l=ge(t.elements.popper),u=[].concat(t.scrollParents.reference,t.scrollParents.popper);return o&&u.forEach((function(e){e.addEventListener("scroll",n.update,$e)})),s&&l.addEventListener("resize",n.update,$e),function(){o&&u.forEach((function(e){e.removeEventListener("scroll",n.update,$e)})),s&&l.removeEventListener("resize",n.update,$e)}},data:{}},Ge={left:"right",right:"left",bottom:"top",top:"bottom"};function Ue(e){return e.replace(/left|right|bottom|top/g,(function(e){return Ge[e]}))}var qe={start:"end",end:"start"};function Ke(e){return e.replace(/start|end/g,(function(e){return qe[e]}))}function Je(e){var t=ge(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Xe(e){return Se(Ce(e)).left+Je(e).scrollLeft}function Ye(e){var t=ke(e),n=t.overflow,i=t.overflowX,r=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+r+i)}function Qe(e){return["html","body","#document"].indexOf(me(e))>=0?e.ownerDocument.body:be(e)&&Ye(e)?e:Qe(Ie(e))}function Ze(e,t){var n;void 0===t&&(t=[]);var i=Qe(e),r=i===(null==(n=e.ownerDocument)?void 0:n.body),o=ge(i),a=r?[o].concat(o.visualViewport||[],Ye(i)?i:[]):i,s=t.concat(a);return r?s:s.concat(Ze(Ie(a)))}function et(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function tt(e,t){return t===ue?et(function(e){var t=ge(e),n=Ce(e),i=t.visualViewport,r=n.clientWidth,o=n.clientHeight,a=0,s=0;return i&&(r=i.width,o=i.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(a=i.offsetLeft,s=i.offsetTop)),{width:r,height:o,x:a+Xe(e),y:s}}(e)):be(t)?function(e){var t=Se(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}(t):et(function(e){var t,n=Ce(e),i=Je(e),r=null==(t=e.ownerDocument)?void 0:t.body,o=Ve(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),a=Ve(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),s=-i.scrollLeft+Xe(e),l=-i.scrollTop;return"rtl"===ke(r||n).direction&&(s+=Ve(n.clientWidth,r?r.clientWidth:0)-o),{width:o,height:a,x:s,y:l}}(Ce(e)))}function nt(e,t,n){var i="clippingParents"===t?function(e){var t=Ze(Ie(e)),n=["absolute","fixed"].indexOf(ke(e).position)>=0&&be(e)?De(e):e;return ve(n)?t.filter((function(e){return ve(e)&&Ee(e,n)&&"body"!==me(e)})):[]}(e):[].concat(t),r=[].concat(i,[n]),o=r[0],a=r.reduce((function(t,n){var i=tt(e,n);return t.top=Ve(i.top,t.top),t.right=Ae(i.right,t.right),t.bottom=Ae(i.bottom,t.bottom),t.left=Ve(i.left,t.left),t}),tt(e,o));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function it(e){return e.split("-")[1]}function rt(e){var t,n=e.reference,i=e.element,r=e.placement,o=r?xe(r):null,a=r?it(r):null,s=n.x+n.width/2-i.width/2,l=n.y+n.height/2-i.height/2;switch(o){case ee:t={x:s,y:n.y-i.height};break;case te:t={x:s,y:n.y+n.height};break;case ne:t={x:n.x+n.width,y:l};break;case ie:t={x:n.x-i.width,y:l};break;default:t={x:n.x,y:n.y}}var u=o?Pe(o):null;if(null!=u){var c="y"===u?"height":"width";switch(a){case ae:t[u]=t[u]-(n[c]/2-i[c]/2);break;case se:t[u]=t[u]+(n[c]/2-i[c]/2)}}return t}function ot(e,t){void 0===t&&(t={});var n=t,i=n.placement,r=void 0===i?e.placement:i,o=n.boundary,a=void 0===o?le:o,s=n.rootBoundary,l=void 0===s?ue:s,u=n.elementContext,c=void 0===u?ce:u,d=n.altBoundary,p=void 0!==d&&d,h=n.padding,f=void 0===h?0:h,m=Ne("number"!=typeof f?f:He(f,oe)),g=c===ce?de:ce,v=e.elements.reference,b=e.rects.popper,y=e.elements[p?g:c],w=nt(ve(y)?y:y.contextElement||Ce(e.elements.popper),a,l),x=Se(v),M=rt({reference:x,element:b,strategy:"absolute",placement:r}),S=et(Object.assign({},b,M)),O=c===ce?S:x,E={top:w.top-O.top+m.top,bottom:O.bottom-w.bottom+m.bottom,left:w.left-O.left+m.left,right:O.right-w.right+m.right},k=e.modifiersData.offset;if(c===ce&&k){var L=k[r];Object.keys(E).forEach((function(e){var t=[ne,te].indexOf(e)>=0?1:-1,n=[ee,te].indexOf(e)>=0?"y":"x";E[e]+=L[n]*t}))}return E}function at(e,t){void 0===t&&(t={});var n=t,i=n.placement,r=n.boundary,o=n.rootBoundary,a=n.padding,s=n.flipVariations,l=n.allowedAutoPlacements,u=void 0===l?he:l,c=it(i),d=c?s?pe:pe.filter((function(e){return it(e)===c})):oe,p=d.filter((function(e){return u.indexOf(e)>=0}));0===p.length&&(p=d);var h=p.reduce((function(t,n){return t[n]=ot(e,{placement:n,boundary:r,rootBoundary:o,padding:a})[xe(n)],t}),{});return Object.keys(h).sort((function(e,t){return h[e]-h[t]}))}var st={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,i=e.name;if(!t.modifiersData[i]._skip){for(var r=n.mainAxis,o=void 0===r||r,a=n.altAxis,s=void 0===a||a,l=n.fallbackPlacements,u=n.padding,c=n.boundary,d=n.rootBoundary,p=n.altBoundary,h=n.flipVariations,f=void 0===h||h,m=n.allowedAutoPlacements,g=t.options.placement,v=xe(g),b=l||(v===g||!f?[Ue(g)]:function(e){if(xe(e)===re)return[];var t=Ue(e);return[Ke(e),t,Ke(t)]}(g)),y=[g].concat(b).reduce((function(e,n){return e.concat(xe(n)===re?at(t,{placement:n,boundary:c,rootBoundary:d,padding:u,flipVariations:f,allowedAutoPlacements:m}):n)}),[]),w=t.rects.reference,x=t.rects.popper,M=new Map,S=!0,O=y[0],E=0;E<y.length;E++){var k=y[E],L=xe(k),C=it(k)===ae,I=[ee,te].indexOf(L)>=0,T=I?"width":"height",D=ot(t,{placement:k,boundary:c,rootBoundary:d,altBoundary:p,padding:u}),P=I?C?ne:ie:C?te:ee;w[T]>x[T]&&(P=Ue(P));var V=Ue(P),A=[];if(o&&A.push(D[L]<=0),s&&A.push(D[P]<=0,D[V]<=0),A.every((function(e){return e}))){O=k,S=!1;break}M.set(k,A)}if(S)for(var _=function(e){var t=y.find((function(t){var n=M.get(t);if(n)return n.slice(0,e).every((function(e){return e}))}));if(t)return O=t,"break"},B=f?3:1;B>0;B--){if("break"===_(B))break}t.placement!==O&&(t.modifiersData[i]._skip=!0,t.placement=O,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function lt(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function ut(e){return[ee,ne,te,ie].some((function(t){return e[t]>=0}))}var ct={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,i=t.rects.reference,r=t.rects.popper,o=t.modifiersData.preventOverflow,a=ot(t,{elementContext:"reference"}),s=ot(t,{altBoundary:!0}),l=lt(a,i),u=lt(s,r,o),c=ut(l),d=ut(u);t.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:u,isReferenceHidden:c,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":d})}};var dt={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,i=e.name,r=n.offset,o=void 0===r?[0,0]:r,a=he.reduce((function(e,n){return e[n]=function(e,t,n){var i=xe(e),r=[ie,ee].indexOf(i)>=0?-1:1,o="function"==typeof n?n(Object.assign({},t,{placement:e})):n,a=o[0],s=o[1];return a=a||0,s=(s||0)*r,[ie,ne].indexOf(i)>=0?{x:s,y:a}:{x:a,y:s}}(n,t.rects,o),e}),{}),s=a[t.placement],l=s.x,u=s.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=u),t.modifiersData[i]=a}};var pt={name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=rt({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}};var ht={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,i=e.name,r=n.mainAxis,o=void 0===r||r,a=n.altAxis,s=void 0!==a&&a,l=n.boundary,u=n.rootBoundary,c=n.altBoundary,d=n.padding,p=n.tether,h=void 0===p||p,f=n.tetherOffset,m=void 0===f?0:f,g=ot(t,{boundary:l,rootBoundary:u,padding:d,altBoundary:c}),v=xe(t.placement),b=it(t.placement),y=!b,w=Pe(v),x="x"===w?"y":"x",M=t.modifiersData.popperOffsets,S=t.rects.reference,O=t.rects.popper,E="function"==typeof m?m(Object.assign({},t.rects,{placement:t.placement})):m,k={x:0,y:0};if(M){if(o||s){var L="y"===w?ee:ie,C="y"===w?te:ne,I="y"===w?"height":"width",T=M[w],D=M[w]+g[L],P=M[w]-g[C],V=h?-O[I]/2:0,A=b===ae?S[I]:O[I],_=b===ae?-O[I]:-S[I],B=t.elements.arrow,N=h&&B?Oe(B):{width:0,height:0},H=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},R=H[L],j=H[C],F=Be(0,S[I],N[I]),W=y?S[I]/2-V-F-R-E:A-F-R-E,$=y?-S[I]/2+V+F+j+E:_+F+j+E,z=t.elements.arrow&&De(t.elements.arrow),G=z?"y"===w?z.clientTop||0:z.clientLeft||0:0,U=t.modifiersData.offset?t.modifiersData.offset[t.placement][w]:0,q=M[w]+W-U-G,K=M[w]+$-U;if(o){var J=Be(h?Ae(D,q):D,T,h?Ve(P,K):P);M[w]=J,k[w]=J-T}if(s){var X="x"===w?ee:ie,Y="x"===w?te:ne,Q=M[x],Z=Q+g[X],re=Q-g[Y],oe=Be(h?Ae(Z,q):Z,Q,h?Ve(re,K):re);M[x]=oe,k[x]=oe-Q}}t.modifiersData[i]=k}},requiresIfExists:["offset"]};function ft(e,t,n){void 0===n&&(n=!1);var i,r,o=be(t),a=be(t)&&function(e){var t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,i=t.height/e.offsetHeight||1;return 1!==n||1!==i}(t),s=Ce(t),l=Se(e,a),u={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(o||!o&&!n)&&(("body"!==me(t)||Ye(s))&&(u=(i=t)!==ge(i)&&be(i)?{scrollLeft:(r=i).scrollLeft,scrollTop:r.scrollTop}:Je(i)),be(t)?((c=Se(t,!0)).x+=t.clientLeft,c.y+=t.clientTop):s&&(c.x=Xe(s))),{x:l.left+u.scrollLeft-c.x,y:l.top+u.scrollTop-c.y,width:l.width,height:l.height}}function mt(e){var t=new Map,n=new Set,i=[];function r(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!n.has(e)){var i=t.get(e);i&&r(i)}})),i.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||r(e)})),i}var gt={placement:"bottom",modifiers:[],strategy:"absolute"};function vt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function bt(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,i=void 0===n?[]:n,r=t.defaultOptions,o=void 0===r?gt:r;return function(e,t,n){void 0===n&&(n=o);var r,a,s={placement:"bottom",orderedModifiers:[],options:Object.assign({},gt,o),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},l=[],u=!1,c={state:s,setOptions:function(n){d(),s.options=Object.assign({},o,s.options,n),s.scrollParents={reference:ve(e)?Ze(e):e.contextElement?Ze(e.contextElement):[],popper:Ze(t)};var r,a,u=function(e){var t=mt(e);return fe.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}((r=[].concat(i,s.options.modifiers),a=r.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e}),{}),Object.keys(a).map((function(e){return a[e]}))));return s.orderedModifiers=u.filter((function(e){return e.enabled})),s.orderedModifiers.forEach((function(e){var t=e.name,n=e.options,i=void 0===n?{}:n,r=e.effect;if("function"==typeof r){var o=r({state:s,name:t,instance:c,options:i}),a=function(){};l.push(o||a)}})),c.update()},forceUpdate:function(){if(!u){var e=s.elements,t=e.reference,n=e.popper;if(vt(t,n)){s.rects={reference:ft(t,De(n),"fixed"===s.options.strategy),popper:Oe(n)},s.reset=!1,s.placement=s.options.placement,s.orderedModifiers.forEach((function(e){return s.modifiersData[e.name]=Object.assign({},e.data)}));for(var i=0;i<s.orderedModifiers.length;i++)if(!0!==s.reset){var r=s.orderedModifiers[i],o=r.fn,a=r.options,l=void 0===a?{}:a,d=r.name;"function"==typeof o&&(s=o({state:s,options:l,name:d,instance:c})||s)}else s.reset=!1,i=-1}}},update:(r=function(){return new Promise((function(e){c.forceUpdate(),e(s)}))},function(){return a||(a=new Promise((function(e){Promise.resolve().then((function(){a=void 0,e(r())}))}))),a}),destroy:function(){d(),u=!0}};if(!vt(e,t))return c;function d(){l.forEach((function(e){return e()})),l=[]}return c.setOptions(n).then((function(e){!u&&n.onFirstUpdate&&n.onFirstUpdate(e)})),c}}bt();var yt=bt({defaultModifiers:[ze,pt,We,we,dt,st,ht,Re,ct]});const wt="ProseMirror-menu";let xt={time:0,node:null};function Mt(e){xt.time=Date.now(),xt.node=e.target}function St(e){return Date.now()-100<xt.time&&xt.node&&e.contains(xt.node)}function Ot(e,t){return e._props.translate?e._props.translate(t):t}class Et extends J{constructor(e,t,n=!1){super(t,n),this.content=Array.isArray(e)?e:[e]}render(e){let t=kt(this.content,e),n=q("div",{class:wt+"-dropdown "+(this.Options.class||""),style:this.Options.css},Ot(e,this.Options.label));this.Options.title&&n.setAttribute("title",Ot(e,this.Options.title));let i=q("div",{class:wt+"-dropdown-wrap"},n);this.wrap=i;let r=null,o=null,a=()=>{r&&r.close()&&(r=null,window.removeEventListener("mousedown",o))};return n.addEventListener("mousedown",(e=>{e.preventDefault(),Mt(e),r?a():(r=this.expand(i,t.dom),window.addEventListener("mousedown",o=()=>{St(i)||a()}))})),{dom:i,update:function(e){let n=t.update(e);return i.style.display=n?"":"none",n}}}expand(e,t){let n=q("div",{class:wt+"-dropdown-menu "+(this.Options.class||"")},t),i=!1;return n.style.zIndex="10000000000000",document.body.appendChild(n),yt(this.wrap,n,{placement:"bottom-start",modifiers:[{name:"offset",options:{offset:[0,2]}},{name:"arrow",options:{padding:5}}]}),{close:function(){if(!i)return i=!0,n.remove(),!0},node:n}}}function kt(e,t){let n=[],i=[];for(let r=0;r<e.length;r++){let{dom:o,update:a}=e[r].render(t);n.push(q("div",{class:wt+"-dropdown-item"},o)),i.push(a)}return{dom:n,update:Lt(i,n)}}function Lt(e,t){return n=>{let i=!1;for(let r=0;r<e.length;r++){let o=e[r](n);t[r].style.display=o?"":"none",o&&(i=!0)}return i}}class Ct{constructor(e,t){this.options=t||{},this.content=Array.isArray(e)?e:[e]}render(e){let t=kt(this.content,e),n=q("div",{class:wt+"-submenu-label"},Ot(e,this.options.label)),i=q("div",{class:wt+"-submenu-wrap"},n,q("div",{class:wt+"-submenu"},t.dom)),r=null;return n.addEventListener("mousedown",(e=>{var t,n,o;e.preventDefault(),Mt(e),t=i,n=wt+"-submenu-wrap-active",o?t.classList.add(n):t.classList.remove(n),r||window.addEventListener("mousedown",r=()=>{St(i)||(i.classList.remove(wt+"-submenu-wrap-active"),window.removeEventListener("mousedown",r),r=null)})})),{dom:i,update:function(e){let n=t.update(e);return i.style.display=n?"":"none",n}}}}var It=function(e){var t=e[0],n=e[1]/100,i=e[2]/100;return 0===i?[0,0,0]:[t,100*(2*(n*=(i*=2)<=1?i:2-i)/(i+n)),100*((i+n)/2)]};var Tt=function(e){var t,n,i=e[0],r=e[1]/100,o=e[2]/100;return t=r*o,[i,100*(t=(t/=(n=(2-r)*o)<=1?n:2-n)||0),100*(n/=2)]};function Dt(e){var t=e[0],n=e[1],i=e[2],r=Math.max(t,n,i),o=r-Math.min(t,n,i),a=o&&60*(r===t?(n-i)/o%6:r===n?(i-t)/o+2:(t-n)/o+4);return[a<0?a+360:a,r&&100*o/r,100*r/255]}function Pt(e){var t=e[0]/60,n=e[1]/100,i=e[2]/100,r=i*n,o=i-r,a=255*(r*(1-Math.abs(t%2-1))+o)+.5|0,s=255*(r+o)+.5|0,l=255*o+.5|0,u=0|t;return 1===u?[a,s,l]:2===u?[l,s,a]:3===u?[l,a,s]:4===u?[a,l,s]:5===u?[s,l,a]:[s,a,l]}var Vt=function(e,t,n){return Math.min(Math.max(e,t),n)},At=Vt;function _t(e){var t=Math.round(At(e,0,255)).toString(16);return 1==t.length?"0"+t:t}var Bt=function(e){var t=4===e.length?_t(255*e[3]):"";return"#"+_t(e[0])+_t(e[1])+_t(e[2])+t};var Nt=function(e){4!==e.length&&5!==e.length||(e=function(e){for(var t="#",n=1;n<e.length;n++){var i=e.charAt(n);t+=i+i}return t}(e));var t=[parseInt(e.substring(1,3),16),parseInt(e.substring(3,5),16),parseInt(e.substring(5,7),16)];if(9===e.length){var n=parseFloat((parseInt(e.substring(7,9),16)/255).toFixed(2));t.push(n)}return t};function Ht(e,t){return e?[Wt(e[0])?jt(e[0]):t[0],Wt(e[1])?Ft(e[1]):t[1],Wt(e[2])?Ft(e[2]):t[2]]:t}function Rt(e){return[jt(e[0]),Ft(e[1]),Ft(e[2])]}function jt(e){var t=Math.round(e%360*10)/10;return t<0?t+360:t}function Ft(e){return e<0?0:e>100?100:(10*e+.5|0)/10}function Wt(e){return"number"==typeof e&&isFinite(e)}var $t="undefined"!=typeof globalThis?globalThis:self,zt="PointerEvent"in $t?function(e,t,n){e.addEventListener("pointerdown",(function(e){0===e.button&&!1!==t(e)&&this.setPointerCapture(e.pointerId)})),e.addEventListener("pointermove",(function(e){this.hasPointerCapture(e.pointerId)&&n(e)}))}:"ontouchend"in $t?function(e,t,n){var i=!1;e.addEventListener("touchstart",(function(e){1===e.touches.length&&!1!==t(e.touches[0])&&(i=!0,e.preventDefault())})),e.addEventListener("touchmove",(function(e){i&&1===e.touches.length&&(e.preventDefault(),n(e.touches[0]))}))}:function(e,t,n){var i=function(e){n(e)},r=function(){removeEventListener("mouseup",r),removeEventListener("mousemove",i)};e.addEventListener("mousedown",(function(e){0===e.button&&!1!==t(e)&&(addEventListener("mousemove",i),addEventListener("mouseup",r))}))},Gt={hsv:[0,100,100],hsl:[0,100,50],wheelDiameter:200,wheelThickness:20,handleDiameter:16,wheelReflectsSaturation:!0,onChange:function(){}},Ut=$t.DOMMatrix||$t.WebKitCSSMatrix||$t.MSCSSMatrix,qt=function(e,t){return e===t||e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},Kt=function(){function e(t){var n=this;this.options=t,this.wheelDiameter=this.options.wheelDiameter||Gt.wheelDiameter,this.wheelThickness=this.options.wheelThickness||Gt.wheelThickness,this.handleDiameter=this.options.handleDiameter||Gt.handleDiameter,this.onChange=this.options.onChange||Gt.onChange,this.wheelReflectsSaturation=void 0!==this.options.wheelReflectsSaturation?this.options.wheelReflectsSaturation:Gt.wheelReflectsSaturation,this.rootElement=this.options.appendTo.appendChild(Jt("div","reinvented-color-wheel")),this.hueWheelElement=this.rootElement.appendChild(Jt("canvas","reinvented-color-wheel--hue-wheel")),this.hueWheelContext=this.hueWheelElement.getContext("2d"),this.hueHandleElement=this.rootElement.appendChild(Jt("div","reinvented-color-wheel--hue-handle")),this.svSpaceElement=this.rootElement.appendChild(Jt("canvas","reinvented-color-wheel--sv-space")),this.svSpaceContext=this.svSpaceElement.getContext("2d"),this.svHandleElement=this.rootElement.appendChild(Jt("div","reinvented-color-wheel--sv-handle")),this._redrawHueWheel=function(){n._redrawHueWheelRequested=!1;var e=n.wheelDiameter,t=e/2,i=t-n.wheelThickness/2,r=Math.PI/180,o=n.wheelReflectsSaturation?","+n._hsl[1]+"%,"+n._hsl[2]+"%)":",100%,50%)",a=n.hueWheelContext;a.clearRect(0,0,e,e),a.lineWidth=n.wheelThickness;for(var s=0;s<360;s++)a.beginPath(),a.arc(t,t,i,(s-90.7)*r,(s-89.3)*r),a.strokeStyle="hsl("+s+o,a.stroke()},this.hueWheelContext.imageSmoothingEnabled=!1,this.svSpaceContext.imageSmoothingEnabled=!1,this._hsv=Ht(t.hsv?t.hsv:t.hsl?e.hsl2hsv(t.hsl):t.rgb?e.rgb2hsv(t.rgb):t.hex?e.rgb2hsv(e.hex2rgb(t.hex)):void 0,Gt.hsv),this._hsl=Rt(e.hsv2hsl(this._hsv)),this._rgb=e.hsv2rgb(this._hsv),this._hex=e.rgb2hex(this._rgb);var i=function(e,t){var i=n._inverseTransform.multiply(new Ut("matrix(1,0,0,1,"+e+","+t+")"));return{x:i.e,y:i.f}},r=function(e){n._inverseTransform=function(e){for(var t=[e];e=e.parentElement;)t.push(e);for(var n=new Ut,i=t.length-1;i>=0;i--){var r=getComputedStyle(t[i]),o=r.transform;if(o&&"none"!==o){var a=r.transformOrigin.split(" ").map(parseFloat);n=n.translate(a[0],a[1]).multiply(new Ut(o)).translate(-a[0],-a[1])}}return n.inverse()}(e);var t=e.getBoundingClientRect();n._center=i(t.left+t.width/2,t.top+t.height/2)},o=function(e){var t=i(e.clientX,e.clientY),r=t.x-n._center.x,o=t.y-n._center.y,a=Math.atan2(o,r);n.hsv=[180*a/Math.PI+90,n.hsv[1],n.hsv[2]]},a=function(e){var t=i(e.clientX,e.clientY),r=100/n.svSpaceElement.width,o=(t.x-n._center.x)*r+50,a=(n._center.y-t.y)*r+50;n.hsv=[n._hsv[0],o,a]},s=function(e){r(n.svSpaceElement),a(e)};zt(this.hueWheelElement,(function(e){r(n.hueWheelElement);var t=i(e.clientX,e.clientY),a=t.x-n._center.x,s=t.y-n._center.y,l=n.wheelDiameter/2-n.wheelThickness;if(a*a+s*s<l*l)return!1;o(e)}),o),zt(this.svSpaceElement,s,a),zt(this.svHandleElement,s,a),this.redraw()}return Object.defineProperty(e.prototype,"hsv",{get:function(){return this._hsv},set:function(e){qt(this._hsv,e)||this._setHSV(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hsl",{get:function(){return this._hsl},set:function(t){qt(this._hsl,t)||this._setHSV(e.hsl2hsv(t))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rgb",{get:function(){return this._rgb},set:function(t){qt(this._rgb,t)||this._setHSV(e.rgb2hsv(t))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hex",{get:function(){return this._hex},set:function(t){this._hex!==t&&(this.rgb=e.hex2rgb(t))},enumerable:!1,configurable:!0}),e.prototype.setHSV=function(){this.hsv=arguments},e.prototype.setHSL=function(){this.hsl=arguments},e.prototype.redraw=function(){this.hueWheelElement.width=this.hueWheelElement.height=this.wheelDiameter,this.svSpaceElement.width=this.svSpaceElement.height=(this.wheelDiameter-2*this.wheelThickness)*Math.SQRT1_2;var e=this.hueHandleElement.style,t=this.svHandleElement.style;e.width=e.height=t.width=t.height=this.handleDiameter+"px",e.marginLeft=e.marginTop=t.marginLeft=t.marginTop=-this.handleDiameter/2+"px",this._redrawHueWheel(),this._redrawHueHandle(),this._redrawSvSpace(),this._redrawSvHandle()},e.prototype._setHSV=function(t){var n=this._hsv,i=this._hsv=Ht(t,n),r=n[0]-i[0],o=n[1]-i[1]||n[2]-i[2];r&&(this._hsl=[i[0],this._hsl[1],this._hsl[2]],this._redrawHueHandle(),this._updateSvBackground()),o&&(this._hsl=Rt(e.hsv2hsl(i)),this._redrawSvHandle(),this.wheelReflectsSaturation&&!this._redrawHueWheelRequested&&(requestAnimationFrame(this._redrawHueWheel),this._redrawHueWheelRequested=!0)),(r||o)&&(this._rgb=e.hsv2rgb(i),this._hex=e.rgb2hex(this._rgb),this.onChange(this))},e.prototype._redrawSvSpace=function(){this._updateSvBackground();var e=this.svSpaceElement.width,t=this.svSpaceContext,n=t.createLinearGradient(0,0,e,0),i=t.createLinearGradient(0,0,0,e);n.addColorStop(0,"rgba(255,255,255,1)"),n.addColorStop(1,"rgba(255,255,255,0)"),i.addColorStop(0,"rgba(0,0,0,0)"),i.addColorStop(1,"rgba(0,0,0,1)"),t.fillStyle=n,t.fillRect(0,0,e,e),t.fillStyle=i,t.fillRect(0,0,e,e)},e.prototype._updateSvBackground=function(){this.svSpaceElement.style.backgroundColor="hsl("+this._hsv[0]+",100%,50%)"},e.prototype._redrawHueHandle=function(){var e=this.wheelDiameter/2,t=e-this.wheelThickness/2,n=(this._hsv[0]-90)*Math.PI/180,i=this.hueHandleElement.style;i.left=t*Math.cos(n)+e+"px",i.top=t*Math.sin(n)+e+"px"},e.prototype._redrawSvHandle=function(){var e=this.svSpaceElement.width,t=this.svHandleElement.style,n=(this.wheelDiameter-e)/2,i=this._hsv;t.left=n+e*i[1]/100+"px",t.top=n+e*(1-i[2]/100)+"px"},e.default=e,e.defaultOptions=Gt,e.hsv2hsl=Tt,e.hsl2hsv=It,e.hsv2rgb=Pt,e.rgb2hsv=Dt,e.rgb2hex=Bt,e.hex2rgb=Nt,e}();function Jt(e,t){var n=document.createElement(e);return n.className=t,n}var Xt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t="check",n=[],i="f00c",r="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z";e.definition={prefix:"fas",iconName:t,icon:[512,512,n,i,r]},e.faCheck=e.definition,e.prefix="fas",e.iconName=t,e.width=512,e.height=512,e.ligatures=n,e.unicode=i,e.svgPathData=r}(Xt);var Yt,Qt,Zt,en,tn={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t="times",n=[],i="f00d",r="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z";e.definition={prefix:"fas",iconName:t,icon:[352,512,n,i,r]},e.faTimes=e.definition,e.prefix="fas",e.iconName=t,e.width=352,e.height=512,e.ligatures=n,e.unicode=i,e.svgPathData=r}(tn),Yt=l.customElement("rn-text-container-color-dialog"),Qt=l.query(".colorContainer"),Yt((Zt=class extends x.LitElementBase{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"colorContainer",en,this),this.color="#000000"}static get properties(){return{color:{type:String}}}render(){return u.html` <div style="background-color: white;padding:20px; border: 1px solid #dfdfdf;border-radius: 5px;text-align: center;" class="rednao"> <div class="colorContainer"></div> <div style="position:relative;"> <div style="position:absolute;top:0;left: 0;height: 100%;width: 33.5px;background-color: ${this.color}"></div> <input .value=${this.color} style="padding-left: 36px" type="text" @change="${e=>{if(e.stopPropagation(),!/^#[0-9A-F]{6}$/i.test(e.target.value))return e.target.value=this.color,void this.forceUpdate();this.color=e.target.value,this.colorWheel.hex=e.target.value,this.colorWheel.redraw()}}"/> </div> <div> <button class="rnbtn rnbtn-danger" style="margin-top: 10px;display: inline-flex;align-items: center;margin-right: 10px;" @click="${e=>this.FireEvent("change",null)}"> <rn-fontawesome .icon="${tn.faTimes}" style="margin-right: 3px"></rn-fontawesome> Cancel </button> <button class="rnbtn rnbtn-primary" style="margin-top: 10px;display: inline-flex;align-items: center;" @click="${e=>this.FireEvent("change",this.color)}"> <rn-fontawesome .icon="${Xt.faCheck}" style="margin-right: 3px"></rn-fontawesome> Apply </button> </div> </div> `}firstUpdated(e){super.firstUpdated(e),this.colorWheel=new Kt({appendTo:this.colorContainer,hex:this.color,wheelDiameter:200,wheelThickness:20,handleDiameter:16,wheelReflectsSaturation:!0,onChange:e=>{this.color=e.hex}})}},en=babelHelpers.applyDecoratedDescriptor(Zt.prototype,"colorContainer",[Qt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zt));const nn="ProseMirror-menubar";function rn(e,t){return n=>{let i=!1;for(let r=0;r<e.length;r++){let o=e[r](n);t[r].style.display=o?"":"none",o&&(i=!0)}return i}}class on{constructor(e,t,n){this.KeepOpen=!1,this.editorView=e,this.options=t,this.model=n,this.menuWrapper=q("div",{class:"menuWrapper"}),this.menu=this.menuWrapper.appendChild(q("div",{class:nn})),document.body.appendChild(this.menuWrapper),this.menu.className=nn+" floatingMenu",this.spacer=null,this.maxHeight=0,this.widthForMaxHeight=0,this.floating=!1,t.floating=!0;let{dom:i,update:r}=function(e,t){let n=document.createDocumentFragment(),i=[],r=[];for(let o=0;o<t.length;o++){let a=t[o],s=[],l=[];for(let t=0;t<a.length;t++){let{dom:i,update:r}=a[t].render(e),o=q("span",{class:nn+"item"},i);n.appendChild(o),l.push(o),s.push(r)}s.length&&(i.push(rn(s,l)),o<t.length-1&&r.push(n.appendChild(q("span",{class:nn+"separator"}))))}return{dom:n,update:function(e){let t=!1,n=!1;for(let o=0;o<i.length;o++){let a=i[o](e);o&&(r[o-1].style.display=n&&a?"":"none"),n=a,a&&(t=!0)}return t}}}(this.editorView,this.GetMenuContent(this.options.content,!1));this.contentUpdate=r,this.menu.appendChild(i),this.Popper=yt(e.dom,this.menuWrapper,{placement:"top",modifiers:[{name:"offset",options:{offset:[0,2]}},{name:"arrow",options:{padding:5}}]}),this.menuWrapper.style.display="none",this.update()}GetMenuContent(e,t=!1){let n=[];for(let i of e){let e=[];for(let n of i)1==n.IsSubMenu&&t&&e.push(n),1==n.IsSubMenu||t||e.push(n);e.length>0&&n.push(e)}return n}update(){this.contentUpdate(this.editorView.state),this.floating?this.updateScrollCursor():(this.menu.offsetWidth!=this.widthForMaxHeight&&(this.widthForMaxHeight=this.menu.offsetWidth,this.maxHeight=0),this.menu.offsetHeight>this.maxHeight&&(this.maxHeight=this.menu.offsetHeight))}updateScrollCursor(){let e=this.editorView.root.getSelection();if(!e.focusNode)return;let t=e.getRangeAt(0).getClientRects(),n=t[function(e){return e.anchorNode==e.focusNode?e.anchorOffset>e.focusOffset:e.anchorNode.compareDocumentPosition(e.focusNode)==Node.DOCUMENT_POSITION_FOLLOWING}(e)?0:t.length-1];if(!n)return;let i=this.menu.getBoundingClientRect();if(n.top<i.bottom&&n.bottom>i.top){let e=function(e){for(let t=e.parentNode;t;t=t.parentNode)if(t.scrollHeight>t.clientHeight)return t}(this.wrapper);e&&(e.scrollTop-=i.bottom-n.top)}}updateFloat(e=void 0){}destroy(){null!=this.menuWrapper&&this.menuWrapper.remove()}}var an={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t="plus",n=[],i="f067",r="M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z";e.definition={prefix:"fas",iconName:t,icon:[448,512,n,i,r]},e.faPlus=e.definition,e.prefix="fas",e.iconName=t,e.width=448,e.height=512,e.ligatures=n,e.unicode=i,e.svgPathData=r}(an);class sn extends t.SchemaBase{constructor(e,t=null,n=!1,i=[]){super(),this.FormBuilder=e,this.OwnerField=t,this.ShowPostSubmissionFields=n,this.CustomGroups=i}GetNodes(){return{field:{inline:!0,attrs:{type:{default:null},id:{default:null},options:{default:null}},group:"inline",draggable:!1,parseDOM:[{tag:"field",getAttrs:e=>({type:e.getAttribute("data-type"),id:e.getAttribute("data-id"),options:e.getAttribute("data-options")})}],toDOM:e=>{let t="Unknown Field";var n;if("fixed"===e.attrs.type)null!=this.FormBuilder&&(t=this.FormBuilder.ParseFixedField(e.attrs.id,null===(n=e.attrs)||void 0===n?void 0:n.options,this.OwnerField));else if("field"==e.attrs.type){var i;let n=null===(i=this.FormBuilder)||void 0===i?void 0:i.GetFieldById(e.attrs.id,!0);null!=n&&(t=M.EventManager.Publish("GetFriendlyName",{Field:n}))}if(null!=e.attrs.type&&null!=e.attrs.id){let n=this.CustomGroups.find((t=>t.Type==e.attrs.type&&t.Value==e.attrs.id));null!=n&&(t=n.Label)}return u.renderInline(u.html`<div style="padding:0 2px;border: 1px solid #999;display: inline-block;background-color: #efefef">${t}</div>`)}}}}GetMenuItems(){return[new n.MenuItem({title:"Insert Smart Tag",render:()=>u.renderInline(u.html`<div class="MenuNode" style="cursor:pointer;display: inline-flex;align-items: center;" ><rn-fontawesome style="font-size: 16px; margin-right: 3px;" .icon="${an.faPlus}"></rn-fontawesome>Smart Tag</div>`),enable:function(e){return!0},run:async(e,t,n)=>{var i,r;let o=await g.Dialog.Show(u.html`<rn-formula-field-picker .formBuilder="${this.FormBuilder}" .customGroups="${this.CustomGroups}" .showPostSubmissionFields="${this.ShowPostSubmissionFields}" .fields="${null!==(i=null===(r=this.FormBuilder)||void 0===r?void 0:r.GetFields(!1,!1,!0))&&void 0!==i?i:[]}" .ownerField="${this.OwnerField}"></rn-formula-field-picker>`);null!=o&&(n.dispatch(n.state.tr.replaceSelectionWith(e.doc.type.schema.nodes.field.createAndFill({type:o.Type,id:o.Value,options:o.Options}))),n.focus())}})]}}var ln=function(e){this.options=e};function un(e,t){var n={label:t.title,run:e};for(var i in t)n[i]=t[i];return t.enable&&!0!==t.enable||t.select||(n[t.enable?"enable":"select"]=function(t){return e(t)}),new Z(n)}function cn(e,t){var n=e.selection,i=n.from,r=n.$from,o=n.to;return n.empty?t.isInSet(e.storedMarks||r.marks()):e.doc.rangeHasMark(i,o,t)}function dn(e,t){var n={active:function(t){return cn(t,e)},enable:!0};for(var i in t)n[i]=t[i];return un(c.toggleMark(e),n)}function pn(e,t){return un(c.wrapInList(e,t.attrs),t)}function hn(e,t){var n,i,r={};(n=e.marks.strong)&&(r.toggleStrong=dn(n,{title:"Toggle strong style",icon:c.icons.strong})),(n=e.marks.em)&&(r.toggleEm=dn(n,{title:"Toggle emphasis",icon:c.icons.em})),(n=e.marks.code)&&(r.toggleCode=dn(n,{title:"Toggle code font",icon:c.icons.code})),(n=e.marks.link)&&(r.toggleLink=(i=n,new Z({title:"Add or remove link",icon:c.icons.link,active:function(e){return cn(e,i)},enable:function(e){return!e.selection.empty},run:async function(e,t,n){if(n.pluginViews[1].KeepOpen=!0,cn(e,i))return c.toggleMark(i)(e,t),!0;let r=await g.Dialog.Show(u.html`<rn-te-link-dialog></rn-te-link-dialog>`);n.pluginViews[1].KeepOpen=!1,null!=r&&(c.toggleMark(i,{href:r.URL,type:r.Target})(n.state,n.dispatch),n.focus())}}))),(n=e.nodes.image)&&(n=e.nodes.bullet_list)&&(r.wrapBulletList=pn(n,{title:"Wrap in bullet list",icon:c.icons.bulletList})),(n=e.nodes.ordered_list)&&(r.wrapOrderedList=pn(n,{title:"Wrap in ordered list",icon:c.icons.orderedList}));var o,a=function(e){return e.filter((function(e){return e}))};return r.insertMenu=new Et(a([r.insertHorizontalRule]),{label:"Insert"}),r.typeMenu=new Et(a([r.makeParagraph,r.makeHead1&&new Ct(a([r.makeHead1,r.makeHead2,r.makeHead3,r.makeHead4,r.makeHead5,r.makeHead6]),{label:"Heading"})]),{label:"Type..."}),r.inlineMenu=[a([(o=null,new Z({title:"Color",select:(e,t)=>{let n="plain",i=e.selection.$head;w.schema.nodes.paragraph;for(let e=i.depth;e>0;e--)"paragraph"==i.node(e).type.name?(n="plain",w.schema.nodes.paragraph):"heading"==i.node(e).type.name&&(n="h"+i.node(e).attrs.level);return o.value=n,e.selection instanceof c.TextSelection||e.selection instanceof c.AllSelection},render:e=>{function t(t){let n=e.state.config.schema.nodes.paragraph,i={};"h"==t[0]&&(n=e.state.config.schema.nodes.heading,i={level:t[1]});let{from:r,to:o}=e.state.selection,a=!1;return e.state.doc.nodesBetween(r,o,((t,r)=>{if(a)return!1;if(t.isTextblock&&!t.hasMarkup(n,i)){if(t.type==n)a=!0;else{let t=e.state.doc.resolve(r),i=t.index();a=t.parent.canReplaceWith(i,i+1,n)}a&&null!=t.attrs.align&&(i.align=t.attrs.align)}})),!!a&&(e.dispatch(e.state.tr.setBlockType(r,o,n,i).scrollIntoView()),e.focus(),!0)}return o=u.renderInline(u.html`<select tabindex="1" @change="${e=>t(e.target.value)}" style="border: none;outline: none;box-shadow: none;" @click="${e=>{e.stopImmediatePropagation()}}" @blur="${t=>{null!=e.pluginViews&&(e.pluginViews[1].KeepOpen=!1,e.pluginViews[1].model.MaybeDestroyEditor())}}" @mousedown="${t=>{e.pluginViews[1].KeepOpen=!0}}"><option value="h1">H1</option> <option value="h2">H2</option> <option value="h3">H3</option> <option value="h4">H4</option> <option value="h5">H5</option> <option value="h6">H6</option> <option value="plain">Plain</option></select>`),o},enable:function(e){return e.selection instanceof c.TextSelection||e.selection instanceof c.AllSelection},run:async(e,t,n)=>{}})),r.toggleStrong,r.toggleEm,r.toggleLink,mn()])],r.blockMenu=[a([r.wrapBulletList,r.wrapOrderedList,r.wrapBlockQuote,fn,c.liftItem,c.selectParentNodeItem])],r.fullMenu=r.inlineMenu.concat([a([c.undoItem,c.redoItem])],r.blockMenu,[a([S.AlignMenu("left",G.faAlignLeft),S.AlignMenu("center",z.faAlignCenter),S.AlignMenu("right",U.faAlignRight)])],[a(null==t?[]:new sn(t.FormBuilder).GetMenuItems())]),r}ln.prototype.read=function(e){return e.value},ln.prototype.validateType=function(e){},ln.prototype.validate=function(e){return!e&&this.options.required?"Required field":this.validateType(e)||this.options.validate&&this.options.validate(e)},ln.prototype.clean=function(e){return this.options.clean?this.options.clean(e):e},function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(){var e=document.createElement("input");return e.type="text",e.placeholder=this.options.label,e.value=this.options.value||"",e.autocomplete="off",e}}(ln);const fn=new Z({title:"Join with above block",run:c.joinUp,select:e=>c.joinUp(e),icon:c.icons.join},!0);function mn(){var e=null;return new Z({title:"Color",select:t=>{let n=b.getActiveMarks(t).find((e=>"color"==e.type.name)),i="#000000";return null!=n&&(i=n.attrs.color),e.querySelector(".divColor").style.backgroundColor=i,!0},render:t=>e=u.renderInline(u.html` <div style="display: inline-flex;align-items: center;" @mousedown="${e=>{t.pluginViews[1].KeepOpen=!0}}"> <div style="vertical-align:middle;border: 1px solid black;padding: 2px;cursor:pointer;display: block;align-items: center;" @click="${()=>{}}"> <div class="divColor" style="background-color: black;border: 1px solid black;height: 7px;width: 12px;"> </div> </div> </div>`),enable:function(e){return!0},run:async(t,n,i)=>{let r=await async function(e,t="#000000"){return new Promise((async n=>{let i=await u.renderInline(u.html`<rn-text-color-dialog .color="${t}" style="z-index: 1000000000000000" @change="${e=>{i.remove(),n(e.detail)}}"></rn-text-color-dialog>`);document.body.appendChild(i),yt(e,i,{modifiers:[{name:"offset",options:{offset:[0,2]}},{name:"arrow",options:{padding:5}}]})}))}(e);i.pluginViews[1].KeepOpen=!1,null!=r&&(e.querySelector(".divColor").style.backgroundColor=r,function(e,t,n=null){let{empty:i,$cursor:r,ranges:o}=e.state.selection,a=e.state,s=e.dispatch;if(i&&!r)return!1;if(s)if(r)t.isInSet(a.storedMarks||r.marks())&&s(a.tr.removeStoredMark(t)),s(a.tr.addStoredMark(t.create(n)));else{let e=a.tr;for(let i=0;i<o.length;i++){let{$from:r,$to:a}=o[i];e.removeMark(r.pos,a.pos,t);let s=r.pos,l=a.pos,u=r.nodeAfter,c=a.nodeBefore,d=u&&u.isText?/^\s*/.exec(u.text)[0].length:0,p=c&&c.isText?/\s*$/.exec(c.text)[0].length:0;s+d<l&&(s+=d,l-=p),e.addMark(s,l,t.create(n))}s(e.scrollIntoView())}}(i,t.doc.type.schema.marks.color,{color:r}),i.focus())}})}var gn,vn,bn,yn,wn="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);function xn(e,t){var n,i={};function r(e,n){if(t){var r=t[e];if(!1===r)return;r&&(e=r)}i[e]=n}if(r("Mod-z",c.undo),r("Shift-Mod-z",c.redo),r("Backspace",c.undoInputRule),wn||r("Mod-y",c.redo),r("Alt-ArrowUp",c.joinUp),r("Alt-ArrowDown",c.joinDown),r("Mod-BracketLeft",c.lift),r("Escape",c.selectParentNode),(n=e.marks.strong)&&(r("Mod-b",c.toggleMark(n)),r("Mod-B",c.toggleMark(n))),(n=e.marks.em)&&(r("Mod-i",c.toggleMark(n)),r("Mod-I",c.toggleMark(n))),(n=e.marks.code)&&r("Mod-`",c.toggleMark(n)),(n=e.nodes.bullet_list)&&r("Shift-Ctrl-8",c.wrapInList(n)),(n=e.nodes.ordered_list)&&r("Shift-Ctrl-9",c.wrapInList(n)),(n=e.nodes.blockquote)&&r("Ctrl->",c.wrapIn(n)),n=e.nodes.hard_break){var o=n,a=c.chainCommands(c.exitCode,(function(e,t){return t(e.tr.replaceSelectionWith(o.create()).scrollIntoView()),!0}));r("Mod-Enter",a),r("Shift-Enter",a),wn&&r("Ctrl-Enter",a)}if((n=e.nodes.list_item)&&(r("Enter",c.splitListItem(n)),r("Mod-[",c.liftListItem(n)),r("Mod-]",c.sinkListItem(n))),(n=e.nodes.paragraph)&&r("Shift-Ctrl-0",c.setBlockType(n)),(n=e.nodes.code_block)&&r("Shift-Ctrl-\\",c.setBlockType(n)),n=e.nodes.heading)for(var s=1;s<=6;s++)r("Shift-Ctrl-"+s,c.setBlockType(n,{level:s}));if(n=e.nodes.horizontal_rule){var l=n;r("Mod-_",(function(e,t){return t(e.tr.replaceSelectionWith(l.create()).scrollIntoView()),!0}))}return i}function Mn(e){var t,n,i=c.smartQuotes.concat(c.ellipsis,c.emDash);return(t=e.nodes.blockquote)&&i.push((n=t,c.wrappingInputRule(/^\s*>\s$/,n))),(t=e.nodes.ordered_list)&&i.push(function(e){return c.wrappingInputRule(/^(\d+)\.\s$/,e,(function(e){return{order:+e[1]}}),(function(e,t){return t.childCount+t.attrs.order==+e[1]}))}(t)),(t=e.nodes.bullet_list)&&i.push(function(e){return c.wrappingInputRule(/^\s*([-+*])\s$/,e)}(t)),(t=e.nodes.code_block)&&i.push(function(e){return c.textblockTypeInputRule(/^```$/,e)}(t)),(t=e.nodes.heading)&&i.push(function(e,t){return c.textblockTypeInputRule(new RegExp("^(#{1,"+t+"})\\s$"),e,(function(e){return{level:e[1].length}}))}(t,6)),c.inputRules({rules:i})}function Sn(e,t,n){var i=[Mn(e.schema),c.keymap(xn(e.schema,e.mapKeys)),c.keymap(c.baseKeymap),c.dropCursor(),c.gapCursor()];return!1!==e.menuBar&&i.push(function(e,t,n){return new c.Plugin({props:{handleDOMEvents:{focus(e){e.pluginViews[1].Popper.update(),e.pluginViews[1].model.KeepOpen=!1,e.pluginViews[1].menuWrapper.style.display="flex",setTimeout((()=>{e.pluginViews[1].menuWrapper.classList.add("show")}),20)},blur(e){e.pluginViews[1].KeepOpen||(e.pluginViews[1].menuWrapper.style.display="none",e.pluginViews[1].menuWrapper.classList.remove("show"),n.MaybeDestroyEditor())}}},view:t=>new on(t,e,n)})}({floating:!1!==e.floatingMenu,content:e.menuContent||hn(e.schema,t).fullMenu},0,n)),!1!==e.history&&i.push(c.history()),i.concat(new c.Plugin({props:{attributes:{class:"ProseMirror-example-setup-style"}}}))}function On(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function En(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?On(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):On(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}gn=l.customElement("rn-text-container"),vn=l.query(".editor"),gn((bn=class e extends x.LitElementBase{constructor(){super(),this.nodes=[],this.isPlain=!1,babelHelpers.initializerDefineProperty(this,"Editor",yn,this),this.LatestValue=null,this.KeepOpen=!1}get Plugins(){if(null==this._plugins){let e={schema:this.Schema};this.isPlain?e.menuBar=!1:e.menuContent=this.menu;let t=this;this._plugins=[...Sn(e,this.field,this),new c.Plugin({props:{handleDOMEvents:{keydown(e,n){if("Tab"==n.code){n.preventDefault();let e=Array.from(document.querySelectorAll("rn-text-container")),i=e.indexOf(t);i>=0&&null!=e[i+1]&&(t.MaybeDestroyEditor(),e[i+1].FocusElement())}"Enter"!=n.code&&"NumpadEnter"!=n.code||(t.isPlain&&(n.preventDefault(),n.stopImmediatePropagation()),t.FireEvent("EnterClicked",{Object:t.object,Property:t.property}))},focus(e){null!=this.field&&this.field.Select()},blur(){}}}})]}return this._plugins}async FocusElement(){this.CreateEditor(),await this.AllUpdateComplete,this.View.focus();let e=this.View.state.doc;this.View.dispatch(this.View.state.tr.setSelection(new c.AllSelection(e)))}GetDisplay(){return"inline-flex"}get Schema(){if(null==this._schema){let e=En({},null==this.field?{}:new sn(this.field.FormBuilder).GetNodes()),t=this.isPlain?w.schemaSingleLine:w.schema;this._schema=new c.Schema({nodes:c.addListNodes(t.spec.nodes.append(e),"paragraph block*","block"),marks:En({},w.marks,{},y.ColorMark,{},O.FontSizeMark)})}return this._schema}static get properties(){return{}}get value(){return null==this.object?"":this.object[this.property]}set value(e){this.object[this.property]=e}render(){null==this.LatestValue&&(this.LatestValue=this.value);let e=null;if(null==this.View)if(this.isPlain)e=this.LatestValue;else if(null!=this.field){var t;e=null===(t=M.EventManager.Publish("GetHTML",{HTML:this.LatestValue,FormBuilder:this.field.FormBuilder,Options:{FieldFormatter:e=>"{"+M.EventManager.Publish("GetFriendlyName",{Field:e})+"}"}}))||void 0===t?void 0:t.Code}return u.html` <div class="editor" @dragstart="${e=>{e.stopImmediatePropagation(),e.preventDefault()}}" draggable="true" @mouseenter="${()=>this.CreateEditor()}" @mouseleave="${()=>this.MaybeDestroyEditor()}">${e} </div> `}update(e){if(this.LatestValue!=this.value&&null!=this.LatestValue)if(null!=this.View){let e=this.CreateState();this.View.updateState(e)}else this.LatestValue=this.value;super.update(e)}CreateState(){let e=null;if(this.isPlain){let t=document.createElement("p");t.innerText=this.value,e=c.DOMParser.fromSchema(this.Schema).parse(t)}else e=this.Schema.nodeFromJSON(this.value);return this.field,c.EditorState.create({doc:e,plugins:this.Plugins})}firstUpdated(e){super.firstUpdated(e)}CreateEditor(){if(null!=this.View)return;null!=e.LatestTextContainer&&e.LatestTextContainer!=this&&e.LatestTextContainer.MaybeDestroyEditor(),this.menu=hn(this.Schema,this.field).fullMenu;let t=[];for(let e of this.nodes){let n=e.GetMenuItems();n.length>0&&n.forEach((e=>t.push(e)))}t.length>0&&this.menu.push(t);let n=this.CreateState(),i=(e,t)=>{t.preventDefault(),t.stopImmediatePropagation()};null!=this.View&&this.View.destroy(),this.View=new c.EditorView(this.Editor,{handleDOMEvents:{dragenter(e,t){i(0,t)},dragover(e,t){i(0,t)},drop(e,t){t.preventDefault()}},dispatchTransaction:e=>{const t=this.View.state.apply(e);this.View.updateState(t),e.docChanged&&(this.LatestValue=this.ParseValue(),this.FireEvent("change",this.LatestValue))},state:n}),e.LatestTextContainer=this,this.LatestValue=this.ParseValue(),this.forceUpdate()}ParseValue(){let e=this.View.state.toJSON().doc;if(1==e.content.length&&"paragraph"==e.content[0].type&&null==e.content[0].content&&(e=null),this.isPlain)if(null==e)e="";else{let t="";for(let n of e.content)if("paragraph"==n.type&&null!=n.content)for(let e of n.content)t=(""==t?"":" ")+e.text;e=t}return e}MaybeDestroyEditor(){var t;null==this.View||this.View.hasFocus()||(this.View.destroy(),e.LatestTextContainer==this&&(e.LatestTextContainer=null),this.View=null,null===(t=this.field)||void 0===t||t.Refresh())}},yn=babelHelpers.applyDecoratedDescriptor(bn.prototype,"Editor",[vn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bn));var kn,Ln,Cn,In,Tn={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t="image",n=[],i="f03e",r="M464 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm-6 336H54a6 6 0 0 1-6-6V118a6 6 0 0 1 6-6h404a6 6 0 0 1 6 6v276a6 6 0 0 1-6 6zM128 152c-22.091 0-40 17.909-40 40s17.909 40 40 40 40-17.909 40-40-17.909-40-40-40zM96 352h320v-80l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L192 304l-39.515-39.515c-4.686-4.686-12.284-4.686-16.971 0L96 304v48z";e.definition={prefix:"far",iconName:t,icon:[512,512,n,i,r]},e.faImage=e.definition,e.prefix="far",e.iconName=t,e.width=512,e.height=512,e.ligatures=n,e.unicode=i,e.svgPathData=r}(Tn);class Dn extends t.SchemaBase{constructor(){super()}GetNodes(){return{image:{inline:!1,attrs:{type:{default:null},id:{default:null},url:{default:null},width:{default:""},height:{default:""}},group:"block",draggable:!1,parseDOM:[{tag:"img",getAttrs:e=>({type:e.getAttribute("data-type"),id:e.getAttribute("data-id"),url:e.getAttribute("data-url"),width:e.getAttribute("data-width"),height:e.getAttribute("data-height")})}],toDOM:e=>{let t=e.attrs.width,n=e.attrs.height,i={};return""!=t&&(t.endsWith("%")&&t.toLowerCase().endsWith("px")||(t+="px"),i.width=t),""!=n&&(n.endsWith("%")&&n.toLowerCase().endsWith("px")||(n+="px"),i.height=n),u.renderInline(u.html`<img style="${u.rnsg(i)}" src="${e.attrs.url}"></img>`)}}}}GetMenuItems(){return[new n.MenuItem({title:"Insert Image",render:()=>u.renderInline(u.html`<div style="cursor:pointer;display: flex;align-items: center;" title="Insert Image"><rn-fontawesome style="margin-right: 3px;font-size: 16px" .icon="${Tn.faImage}"></rn-fontawesome></div>`),enable:function(e){return!0},run:async(e,t,n)=>{let i=window.wp.media({title:"Which image do you want to use in your pdf?",multiple:!1,library:{type:"image"},button:{text:"Select an image"}});i.on("select",(()=>{let t=i.state().get("selection");null!=t&&t.each((t=>{t.attributes.id,t.attributes.url,n.dispatch(n.state.tr.replaceSelectionWith(e.doc.type.schema.nodes.image.createAndFill({type:"img",id:t.attributes.id,url:t.attributes.url}))),n.focus()}))})),i.open()}}),new r.NumberMenuItem("Width (px)","width").SetIsSubMenu().SetSelectOnlyNode("image"),,new r.NumberMenuItem("Height (px)","height").SetIsSubMenu().SetSelectOnlyNode("image")]}}class Pn extends t.SchemaBase{constructor(e){super(),this.FormBuilder=e}GetNodes(){return{formula:{inline:!0,attrs:{formula:{default:null}},group:"inline",draggable:!1,parseDOM:[{tag:"formula",getAttrs:e=>({formula:e.getAttribute("data-formula")})}],toDOM:e=>u.renderInline(u.html`<div style="padding:0 2px;border: 1px solid #999;display: inline-block;background-color: #efefef">${"Formula"}</div>`)}}}GetMenuItems(){return[new n.MenuItem({title:"Insert Smart Tag",render:()=>u.renderInline(u.html`<div style="cursor:pointer;display: inline-flex;align-items: center;" title="formula"><rn-fontawesome style="margin-right: 3px;font-size: 16px" .icon="${an.faPlus}"></rn-fontawesome>Formula</div>`),enable:function(e){return!0},run:async(e,t,n)=>{var i,r,o;let a=null===(i=n.state.selection)||void 0===i?void 0:i.node,s=null;null!=a&&"formula"==(null==a||null===(r=a.type)||void 0===r?void 0:r.name)&&(s=a.attrs.formula),new E.FormulaBuilderModel(this.FormBuilder,M.EventManager.Publish("GetAutocompleteDictionary",this.FormBuilder)).RenderDialog(null,null===(o=s)||void 0===o?void 0:o.Code,null,!1,(t=>{null!=t&&(n.dispatch(n.state.tr.replaceSelectionWith(e.doc.type.schema.nodes.formula.createAndFill({formula:t}))),n.focus())}))}})]}}kn=C.customElementOnce("rn-font-control"),Ln=l.query("select"),kn((Cn=class extends x.LitElementBase{constructor(...e){super(...e),this.Multiple=!1,babelHelpers.initializerDefineProperty(this,"Select",In,this),this.Options=[{Label:"Default",Id:"Default"},{Label:"Arial",Id:"Arial"},{Label:"Arial Black",Id:"Arial Black"},{Label:"Comic Sans MS",Id:"Comic Sans MS"},{Label:"Courier New",Id:"Courier New"},{Label:"Georgia",Id:"Georgia"},{Label:"Impact",Id:"Impact"},{Label:"Lucida Console",Id:"Lucida Console"},{Label:"Lucida Sans Unicode",Id:"Lucida Sans Unicode"},{Label:"Palatino Linotype",Id:"Palatino Linotype"},{Label:"Tahoma",Id:"Tahoma"},{Label:"Times New Roman",Id:"Times New Roman"},{Label:"Trebuchet MS",Id:"Trebuchet MS"},{Label:"Verdana",Id:"Verdana"},{Label:"New (Essential required)",Id:"New font"}]}static get properties(){return{Value:{type:Object},Multiple:{type:Boolean}}}render(){let e=[];null!=rednaoFormDesigner.Fonts&&(e=Object.keys(rednaoFormDesigner.Fonts));let t=""==this.Value?"Default":this.Value;return u.html` <div> <select ?multiple="${this.Multiple}" .value="${t}" style="width: 100%;max-width: 100%;display: none;"> ${p.repeat(this.Options,(e=>e.Id),(e=>u.html`<option ?selected="${this.IsSelected(e.Id)}" .value="${e.Id}">${e.Label}</option>`))} <optgroup label="Custom fonts"> ${p.repeat(e,(e=>e),(e=>u.html`<option ?selected="${this.IsSelected(e)}" .value="${e}">${e}</option>`))} <option value="New font">Add new font</option> </optgroup> </select> </div> `}firstUpdated(e){super.firstUpdated(e);let t=[];this.Multiple&&t.push("remove_button"),this.TomSelect=new TomSelect(this.Select,{render:{option:function(e,t){let n=e.value;return["Default","New font"].indexOf(n)>-1&&(n="unset"),'<div style="font-family: '+n+'">'+t(e.text)+"</div>"},item:function(e,t){let n=e.value;return["Default","New font"].indexOf(n)>-1&&(n="unset"),'<div style="font-family: '+n+'">'+t(e.text)+"</div>"}},plugins:t,onDropdownOpen:e=>{let t=this.TomSelect.control.getBoundingClientRect();e.style.position="absolute",e.style.zIndex="10000000000000000000000",e.style.width=t.width+"px",yt(this.TomSelect.control,e,{modifiers:[{name:"offset",options:{offset:[0,2]}}]})},onChange:e=>{if("Default"==e&&(e=""),"New font"==e)return M.EventManager.Publish("LicenseRequired")?void M.EventManager.Publish("OpenSettings",{Tab:"CustomFont"}):void this.TomSelect.setValue(""==this.Value?"Default":this.Value,!0);this.FireEvent("Change",e)},dropdownParent:document.body})}IsSelected(e){return"Default"==e&&(e=""),this.Multiple?this.Value.indexOf(e)>=0:this.Value==e}},In=babelHelpers.applyDecoratedDescriptor(Cn.prototype,"Select",[Ln],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cn)),exports.TextEditor=e.TextEditor,exports.SchemaBase=t.SchemaBase,exports.MenuItem=n.MenuItem,exports.SchemaBase=t.SchemaBase,exports.SharedMenuFunctions={},exports.NodeIsSelected=i.NodeIsSelected,exports.NumberMenuItem=r.NumberMenuItem,exports.DropDownMenuItem=o.DropDownMenuItem,exports.ButtonMenuItem=a.ButtonMenuItem,exports.TextEditorUtilities=s.TextEditorUtilities,exports.SingleLineTextEditor=$,exports.SingleLineCollection=F,exports.TextEditorUtils=v.TextEditorUtils,exports.Utils={},exports.Utils.getActiveMarks=b.getActiveMarks,exports.ColorMark={},exports.ColorMark.ColorMark=y.ColorMark,exports.FontSizeMark={},exports.FontSizeMark.FontSizeMark=O.FontSizeMark,exports.BasicLinkType=k.BasicLinkType,exports.LinkTypeBase=L.LinkTypeBase,exports.SingleLineTextEditor=$,exports.SingleLineCollection=F,exports.Schema={},exports.Schema.schema=w.schema,exports.Schema.schemaSingleLine=w.schemaSingleLine,exports.Schema.marks=w.marks,exports.ImageNode=Dn,exports.FieldNode=sn,exports.FormulaNode=Pn,exports.TextContainerGenerator=class{static GenerateText(e,t={}){return{type:"doc",content:[{type:"paragraph",attrs:{align:null==t.Alignment?null:"left"},content:[{type:"text",text:e}]}]}}static GenerateTag(e,t={}){return{type:"doc",content:[{type:"paragraph",attrs:{align:null==t.Alignment?null:"left"},content:[{type:"field",attrs:{id:e}}]}]}}static GenerateHeading(e,t=1){return{type:"doc",content:[{type:"heading",attrs:{level:t},content:[{type:"text",text:e}]}]}}},exports.TextContainerUtilities=class{static FocusElement(e,t,n){e.querySelectorAll("rn-text-container").forEach(((e,i)=>{e.object==t&&e.property==n&&e.FocusElement()}))}},exports.BasicLinkType=k.BasicLinkType,exports.AdditionalItemBase=I.AdditionalItemBase,exports.SchemaBase=t.SchemaBase,exports.MenuItemBase=T.MenuItemBase}));
