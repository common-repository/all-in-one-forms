rndefine("#RNMainHTMLGenerator",["exports","#RNMainCore/EventManager","lit"],(function(e,t,n){"use strict";class l{constructor(e,t={},n=null){this.FormBuilder=e,this.Options=t,this.Field=n}ParseContent(e,t,l=[]){var r,i,a,s;if(null==t)return null;for(let u of t)switch(u.type){case"paragraph":let t=this.CreateAndAppend(e,"p");null!=(null==u||null===(r=u.attrs)||void 0===r?void 0:r.align)&&(t.style.textAlign=u.attrs.align),null==u.content&&t.appendChild(document.createElement("br")),this.ParseContent(t,u.content,l);break;case"text":this.ParseText(e,u);break;case"horizontal_rule":this.CreateAndAppend(e,"hr");break;case"heading":let h=u.attrs.level,c=this.CreateAndAppend(e,"h"+h);null!=(null==u||null===(i=u.attrs)||void 0===i?void 0:i.align)&&(c.style.textAlign=u.attrs.align),this.ParseContent(c,u.content,l);break;case"blockquote":let m=this.CreateAndAppend(e,"blockQuote");this.ParseContent(m,u.content,l);break;case"bullet_list":let b=this.CreateAndAppend(e,"ul");this.ParseContent(b,u.content,l);break;case"ordered_list":let k=this.CreateAndAppend(e,"ol");this.ParseContent(k,u.content,l);break;case"list_item":let C=this.CreateAndAppend(e,"li");this.ParseContent(C,u.content,l);break;case"table":let f=this.CreateAndAppend(e,"table"),A=this.CreateAndAppend(f,"tbody");this.ParseContent(A,u.content,l);break;case"table_row":let F=this.CreateAndAppend(e,"tr");this.ParseContent(F,u.content,l);break;case"table_cell":let v=this.CreateAndAppend(e,"td");this.ParseContent(v,u.content,l);break;case"hard_break":this.CreateAndAppend(e,"br");break;case"image":let y=this.CreateAndAppend(e,"img");y.src=u.attrs.url;let g=null!==(a=u.attrs.width)&&void 0!==a?a:"",x=null!==(s=u.attrs.height)&&void 0!==s?s:"";""==g&&(y.style.maxWidth="300px"),""==x&&(y.style.maxHeight="300px"),y.style.width=g,y.style.height=x;break;case"field":let{id:M,type:T,options:P}=u.attrs,H="Unknown",O=document.createElement("div");if(O.style.display="inline-block","fixed"==T){var o,d;if(null!=this.FormBuilder)H=this.FormBuilder.ParseFixedField(null==u||null===(o=u.attrs)||void 0===o?void 0:o.id,null===(d=u.attrs)||void 0===d?void 0:d.options,this.Field),this.FormBuilder.IsDesign&&""!=H.trim()&&(H="["+H+"]");O.innerText=H}else{var p;let e=null===(p=this.FormBuilder)||void 0===p?void 0:p.GetFieldById(M,!0,!0);null!=e?(l.indexOf(e)<0&&l.push(e),null!=this.Options.FieldFormatter?(H=this.Options.FieldFormatter(e),O.innerText=H):null!=e&&(H=e.GetHtml(),"string"==typeof H?O.innerText=H:O.innerHTML=n.renderInline(H,!0).innerHTML)):O.innerText=H}null!=this.Options.CustomFieldFormatter&&(O=this.Options.CustomFieldFormatter(O,u)),null!=u.marks&&(O=this.ApplyMarks(O,u.marks)),e.appendChild(O);break;default:if(null!=this.Options.NodeFormatter){let t=this.Options.NodeFormatter(u);null!=t&&e.appendChild(t);continue}console.error("Unknown type ",u)}return{Code:e,Fields:l}}CreateAndAppend(e,t){let n=document.createElement(t);return e.appendChild(n),n}ParseText(e,t){if(null==t.marks||0==t.marks.length){let n=document.createTextNode(t.text);return void e.appendChild(n)}let n=document.createElement("span");n.innerText=t.text,n=this.ApplyMarks(n,t.marks),e.appendChild(n)}ApplyMarks(e,t){for(let n of t)switch(n.type){case"strong":e.style.fontWeight="bold";break;case"em":e.style.fontStyle="italic";break;case"link":let t=document.createElement("a");t.href=n.attrs.href,t.target=n.attrs.target,t.appendChild(e),e=t;break;case"color":e.style.color=n.attrs.color;break;case"fontsize":e.style.fontSize=n.attrs.size;break;case"fontfamily":e.style.fontFamily=n.attrs.name;break;default:console.error("Undefined mark",n)}return e}}t.EventManager.Subscribe("GetHTML",(e=>{var t,n,r;let i=new l(e.FormBuilder,null!==(t=e.Options)&&void 0!==t?t:{},e.Field),a=document.createElement("div");a.classList.add("rnHTML");let s=i.ParseContent(a,null===(n=e.HTML)||void 0===n?void 0:n.content);if(null!=(null===(r=e.HTML)||void 0===r?void 0:r.Fields)&&null!=(null==s?void 0:s.Fields))for(let t of e.HTML.Fields)if(null!=e.FormBuilder){let n=e.FormBuilder.GetFieldById(t,!1,!0,!1);null!=n&&-1==s.Fields.indexOf(n)&&s.Fields.push(n)}return s})),e.HTMLGenerator=l,Object.defineProperty(e,"__esModule",{value:!0})}));
