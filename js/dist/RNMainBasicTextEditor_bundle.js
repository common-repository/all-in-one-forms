rndefine("#RNMainBasicTextEditor",["#RNMainCore/LitElementBase","lit/decorators","lit","#RNMainProseMirror/ProseMirror","#RNMainDialog/Dialog","#RNMainCore/Sanitizer","#RNMainCore/EventManager","lit/directives/repeat.js","#RNMainDialog/DialogBase"],(function(e,t,n,r,o,i,l,a,s){"use strict";var c={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t="table",n=[],r="f0ce",o="M464 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zM224 416H64v-96h160v96zm0-160H64v-96h160v96zm224 160H288v-96h160v96zm0-160H288v-96h160v96z";e.definition={prefix:"fas",iconName:t,icon:[512,512,n,r,o]},e.faTable=e.definition,e.prefix="fas",e.iconName=t,e.width=512,e.height=512,e.ligatures=n,e.unicode=r,e.svgPathData=o}(c);var p="top",d="bottom",h="right",u="left",f="auto",m=[p,d,h,u],g="start",v="end",w="clippingParents",b="viewport",y="popper",x="reference",S=m.reduce((function(e,t){return e.concat([t+"-"+g,t+"-"+v])}),[]),C=[].concat(m,[f]).reduce((function(e,t){return e.concat([t,t+"-"+g,t+"-"+v])}),[]),k=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function M(e){return e?(e.nodeName||"").toLowerCase():null}function O(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function A(e){return e instanceof O(e).Element||e instanceof Element}function D(e){return e instanceof O(e).HTMLElement||e instanceof HTMLElement}function E(e){return"undefined"!=typeof ShadowRoot&&(e instanceof O(e).ShadowRoot||e instanceof ShadowRoot)}var $={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},r=t.attributes[e]||{},o=t.elements[e];D(o)&&M(o)&&(Object.assign(o.style,n),Object.keys(r).forEach((function(e){var t=r[e];!1===t?o.removeAttribute(e):o.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var r=t.elements[e],o=t.attributes[e]||{},i=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]="",e}),{});D(r)&&M(r)&&(Object.assign(r.style,i),Object.keys(o).forEach((function(e){r.removeAttribute(e)})))}))}},requires:["computeStyles"]};function L(e){return e.split("-")[0]}var T=Math.round;function _(e,t){void 0===t&&(t=!1);var n=e.getBoundingClientRect(),r=1,o=1;return D(e)&&t&&(r=n.width/e.offsetWidth||1,o=n.height/e.offsetHeight||1),{width:T(n.width/r),height:T(n.height/o),top:T(n.top/o),right:T(n.right/r),bottom:T(n.bottom/o),left:T(n.left/r),x:T(n.left/r),y:T(n.top/o)}}function N(e){var t=_(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function R(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&E(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function H(e){return O(e).getComputedStyle(e)}function P(e){return["table","td","th"].indexOf(M(e))>=0}function F(e){return((A(e)?e.ownerDocument:e.document)||window.document).documentElement}function z(e){return"html"===M(e)?e:e.assignedSlot||e.parentNode||(E(e)?e.host:null)||F(e)}function I(e){return D(e)&&"fixed"!==H(e).position?e.offsetParent:null}function j(e){for(var t=O(e),n=I(e);n&&P(n)&&"static"===H(n).position;)n=I(n);return n&&("html"===M(n)||"body"===M(n)&&"static"===H(n).position)?t:n||function(e){var t=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");if(-1!==navigator.userAgent.indexOf("Trident")&&D(e)&&"fixed"===H(e).position)return null;for(var n=z(e);D(n)&&["html","body"].indexOf(M(n))<0;){var r=H(n);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||t&&"filter"===r.willChange||t&&r.filter&&"none"!==r.filter)return n;n=n.parentNode}return null}(e)||t}function B(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}var V=Math.max,W=Math.min,U=Math.round;function q(e,t,n){return V(e,W(t,n))}function G(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function X(e,t){return t.reduce((function(t,n){return t[n]=e,t}),{})}var K={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,r=e.name,o=e.options,i=n.elements.arrow,l=n.modifiersData.popperOffsets,a=L(n.placement),s=B(a),c=[u,h].indexOf(a)>=0?"height":"width";if(i&&l){var f=function(e,t){return G("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:X(e,m))}(o.padding,n),g=N(i),v="y"===s?p:u,w="y"===s?d:h,b=n.rects.reference[c]+n.rects.reference[s]-l[s]-n.rects.popper[c],y=l[s]-n.rects.reference[s],x=j(i),S=x?"y"===s?x.clientHeight||0:x.clientWidth||0:0,C=b/2-y/2,k=f[v],M=S-g[c]-f[w],O=S/2-g[c]/2+C,A=q(k,O,M),D=s;n.modifiersData[r]=((t={})[D]=A,t.centerOffset=A-O,t)}},effect:function(e){var t=e.state,n=e.options.element,r=void 0===n?"[data-popper-arrow]":n;null!=r&&("string"!=typeof r||(r=t.elements.popper.querySelector(r)))&&R(t.elements.popper,r)&&(t.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},J={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Y(e){var t,n=e.popper,r=e.popperRect,o=e.placement,i=e.offsets,l=e.position,a=e.gpuAcceleration,s=e.adaptive,c=e.roundOffsets,f=!0===c?function(e){var t=e.x,n=e.y,r=window.devicePixelRatio||1;return{x:U(U(t*r)/r)||0,y:U(U(n*r)/r)||0}}(i):"function"==typeof c?c(i):i,m=f.x,g=void 0===m?0:m,v=f.y,w=void 0===v?0:v,b=i.hasOwnProperty("x"),y=i.hasOwnProperty("y"),x=u,S=p,C=window;if(s){var k=j(n),M="clientHeight",A="clientWidth";k===O(n)&&"static"!==H(k=F(n)).position&&(M="scrollHeight",A="scrollWidth"),o===p&&(S=d,w-=k[M]-r.height,w*=a?1:-1),o===u&&(x=h,g-=k[A]-r.width,g*=a?1:-1)}var D,E=Object.assign({position:l},s&&J);return a?Object.assign({},E,((D={})[S]=y?"0":"",D[x]=b?"0":"",D.transform=(C.devicePixelRatio||1)<2?"translate("+g+"px, "+w+"px)":"translate3d("+g+"px, "+w+"px, 0)",D)):Object.assign({},E,((t={})[S]=y?w+"px":"",t[x]=b?g+"px":"",t.transform="",t))}var Q={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,r=n.gpuAcceleration,o=void 0===r||r,i=n.adaptive,l=void 0===i||i,a=n.roundOffsets,s=void 0===a||a,c={placement:L(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:o};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,Y(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:l,roundOffsets:s})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,Y(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:s})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},Z={passive:!0};var ee={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,r=e.options,o=r.scroll,i=void 0===o||o,l=r.resize,a=void 0===l||l,s=O(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return i&&c.forEach((function(e){e.addEventListener("scroll",n.update,Z)})),a&&s.addEventListener("resize",n.update,Z),function(){i&&c.forEach((function(e){e.removeEventListener("scroll",n.update,Z)})),a&&s.removeEventListener("resize",n.update,Z)}},data:{}},te={left:"right",right:"left",bottom:"top",top:"bottom"};function ne(e){return e.replace(/left|right|bottom|top/g,(function(e){return te[e]}))}var re={start:"end",end:"start"};function oe(e){return e.replace(/start|end/g,(function(e){return re[e]}))}function ie(e){var t=O(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function le(e){return _(F(e)).left+ie(e).scrollLeft}function ae(e){var t=H(e),n=t.overflow,r=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+r)}function se(e){return["html","body","#document"].indexOf(M(e))>=0?e.ownerDocument.body:D(e)&&ae(e)?e:se(z(e))}function ce(e,t){var n;void 0===t&&(t=[]);var r=se(e),o=r===(null==(n=e.ownerDocument)?void 0:n.body),i=O(r),l=o?[i].concat(i.visualViewport||[],ae(r)?r:[]):r,a=t.concat(l);return o?a:a.concat(ce(z(l)))}function pe(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function de(e,t){return t===b?pe(function(e){var t=O(e),n=F(e),r=t.visualViewport,o=n.clientWidth,i=n.clientHeight,l=0,a=0;return r&&(o=r.width,i=r.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(l=r.offsetLeft,a=r.offsetTop)),{width:o,height:i,x:l+le(e),y:a}}(e)):D(t)?function(e){var t=_(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}(t):pe(function(e){var t,n=F(e),r=ie(e),o=null==(t=e.ownerDocument)?void 0:t.body,i=V(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),l=V(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),a=-r.scrollLeft+le(e),s=-r.scrollTop;return"rtl"===H(o||n).direction&&(a+=V(n.clientWidth,o?o.clientWidth:0)-i),{width:i,height:l,x:a,y:s}}(F(e)))}function he(e,t,n){var r="clippingParents"===t?function(e){var t=ce(z(e)),n=["absolute","fixed"].indexOf(H(e).position)>=0&&D(e)?j(e):e;return A(n)?t.filter((function(e){return A(e)&&R(e,n)&&"body"!==M(e)})):[]}(e):[].concat(t),o=[].concat(r,[n]),i=o[0],l=o.reduce((function(t,n){var r=de(e,n);return t.top=V(r.top,t.top),t.right=W(r.right,t.right),t.bottom=W(r.bottom,t.bottom),t.left=V(r.left,t.left),t}),de(e,i));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function ue(e){return e.split("-")[1]}function fe(e){var t,n=e.reference,r=e.element,o=e.placement,i=o?L(o):null,l=o?ue(o):null,a=n.x+n.width/2-r.width/2,s=n.y+n.height/2-r.height/2;switch(i){case p:t={x:a,y:n.y-r.height};break;case d:t={x:a,y:n.y+n.height};break;case h:t={x:n.x+n.width,y:s};break;case u:t={x:n.x-r.width,y:s};break;default:t={x:n.x,y:n.y}}var c=i?B(i):null;if(null!=c){var f="y"===c?"height":"width";switch(l){case g:t[c]=t[c]-(n[f]/2-r[f]/2);break;case v:t[c]=t[c]+(n[f]/2-r[f]/2)}}return t}function me(e,t){void 0===t&&(t={});var n=t,r=n.placement,o=void 0===r?e.placement:r,i=n.boundary,l=void 0===i?w:i,a=n.rootBoundary,s=void 0===a?b:a,c=n.elementContext,u=void 0===c?y:c,f=n.altBoundary,g=void 0!==f&&f,v=n.padding,S=void 0===v?0:v,C=G("number"!=typeof S?S:X(S,m)),k=u===y?x:y,M=e.elements.reference,O=e.rects.popper,D=e.elements[g?k:u],E=he(A(D)?D:D.contextElement||F(e.elements.popper),l,s),$=_(M),L=fe({reference:$,element:O,strategy:"absolute",placement:o}),T=pe(Object.assign({},O,L)),N=u===y?T:$,R={top:E.top-N.top+C.top,bottom:N.bottom-E.bottom+C.bottom,left:E.left-N.left+C.left,right:N.right-E.right+C.right},H=e.modifiersData.offset;if(u===y&&H){var P=H[o];Object.keys(R).forEach((function(e){var t=[h,d].indexOf(e)>=0?1:-1,n=[p,d].indexOf(e)>=0?"y":"x";R[e]+=P[n]*t}))}return R}function ge(e,t){void 0===t&&(t={});var n=t,r=n.placement,o=n.boundary,i=n.rootBoundary,l=n.padding,a=n.flipVariations,s=n.allowedAutoPlacements,c=void 0===s?C:s,p=ue(r),d=p?a?S:S.filter((function(e){return ue(e)===p})):m,h=d.filter((function(e){return c.indexOf(e)>=0}));0===h.length&&(h=d);var u=h.reduce((function(t,n){return t[n]=me(e,{placement:n,boundary:o,rootBoundary:i,padding:l})[L(n)],t}),{});return Object.keys(u).sort((function(e,t){return u[e]-u[t]}))}var ve={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var o=n.mainAxis,i=void 0===o||o,l=n.altAxis,a=void 0===l||l,s=n.fallbackPlacements,c=n.padding,m=n.boundary,v=n.rootBoundary,w=n.altBoundary,b=n.flipVariations,y=void 0===b||b,x=n.allowedAutoPlacements,S=t.options.placement,C=L(S),k=s||(C===S||!y?[ne(S)]:function(e){if(L(e)===f)return[];var t=ne(e);return[oe(e),t,oe(t)]}(S)),M=[S].concat(k).reduce((function(e,n){return e.concat(L(n)===f?ge(t,{placement:n,boundary:m,rootBoundary:v,padding:c,flipVariations:y,allowedAutoPlacements:x}):n)}),[]),O=t.rects.reference,A=t.rects.popper,D=new Map,E=!0,$=M[0],T=0;T<M.length;T++){var _=M[T],N=L(_),R=ue(_)===g,H=[p,d].indexOf(N)>=0,P=H?"width":"height",F=me(t,{placement:_,boundary:m,rootBoundary:v,altBoundary:w,padding:c}),z=H?R?h:u:R?d:p;O[P]>A[P]&&(z=ne(z));var I=ne(z),j=[];if(i&&j.push(F[N]<=0),a&&j.push(F[z]<=0,F[I]<=0),j.every((function(e){return e}))){$=_,E=!1;break}D.set(_,j)}if(E)for(var B=function(e){var t=M.find((function(t){var n=D.get(t);if(n)return n.slice(0,e).every((function(e){return e}))}));if(t)return $=t,"break"},V=y?3:1;V>0;V--){if("break"===B(V))break}t.placement!==$&&(t.modifiersData[r]._skip=!0,t.placement=$,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function we(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function be(e){return[p,h,d,u].some((function(t){return e[t]>=0}))}var ye={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,r=t.rects.reference,o=t.rects.popper,i=t.modifiersData.preventOverflow,l=me(t,{elementContext:"reference"}),a=me(t,{altBoundary:!0}),s=we(l,r),c=we(a,o,i),p=be(s),d=be(c);t.modifiersData[n]={referenceClippingOffsets:s,popperEscapeOffsets:c,isReferenceHidden:p,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":p,"data-popper-escaped":d})}};var xe={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,r=e.name,o=n.offset,i=void 0===o?[0,0]:o,l=C.reduce((function(e,n){return e[n]=function(e,t,n){var r=L(e),o=[u,p].indexOf(r)>=0?-1:1,i="function"==typeof n?n(Object.assign({},t,{placement:e})):n,l=i[0],a=i[1];return l=l||0,a=(a||0)*o,[u,h].indexOf(r)>=0?{x:a,y:l}:{x:l,y:a}}(n,t.rects,i),e}),{}),a=l[t.placement],s=a.x,c=a.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=s,t.modifiersData.popperOffsets.y+=c),t.modifiersData[r]=l}};var Se={name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=fe({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}};var Ce={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name,o=n.mainAxis,i=void 0===o||o,l=n.altAxis,a=void 0!==l&&l,s=n.boundary,c=n.rootBoundary,f=n.altBoundary,m=n.padding,v=n.tether,w=void 0===v||v,b=n.tetherOffset,y=void 0===b?0:b,x=me(t,{boundary:s,rootBoundary:c,padding:m,altBoundary:f}),S=L(t.placement),C=ue(t.placement),k=!C,M=B(S),O="x"===M?"y":"x",A=t.modifiersData.popperOffsets,D=t.rects.reference,E=t.rects.popper,$="function"==typeof y?y(Object.assign({},t.rects,{placement:t.placement})):y,T={x:0,y:0};if(A){if(i||a){var _="y"===M?p:u,R="y"===M?d:h,H="y"===M?"height":"width",P=A[M],F=A[M]+x[_],z=A[M]-x[R],I=w?-E[H]/2:0,U=C===g?D[H]:E[H],G=C===g?-E[H]:-D[H],X=t.elements.arrow,K=w&&X?N(X):{width:0,height:0},J=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},Y=J[_],Q=J[R],Z=q(0,D[H],K[H]),ee=k?D[H]/2-I-Z-Y-$:U-Z-Y-$,te=k?-D[H]/2+I+Z+Q+$:G+Z+Q+$,ne=t.elements.arrow&&j(t.elements.arrow),re=ne?"y"===M?ne.clientTop||0:ne.clientLeft||0:0,oe=t.modifiersData.offset?t.modifiersData.offset[t.placement][M]:0,ie=A[M]+ee-oe-re,le=A[M]+te-oe;if(i){var ae=q(w?W(F,ie):F,P,w?V(z,le):z);A[M]=ae,T[M]=ae-P}if(a){var se="x"===M?p:u,ce="x"===M?d:h,pe=A[O],de=pe+x[se],he=pe-x[ce],fe=q(w?W(de,ie):de,pe,w?V(he,le):he);A[O]=fe,T[O]=fe-pe}}t.modifiersData[r]=T}},requiresIfExists:["offset"]};function ke(e,t,n){void 0===n&&(n=!1);var r,o,i=D(t),l=D(t)&&function(e){var t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,r=t.height/e.offsetHeight||1;return 1!==n||1!==r}(t),a=F(t),s=_(e,l),c={scrollLeft:0,scrollTop:0},p={x:0,y:0};return(i||!i&&!n)&&(("body"!==M(t)||ae(a))&&(c=(r=t)!==O(r)&&D(r)?{scrollLeft:(o=r).scrollLeft,scrollTop:o.scrollTop}:ie(r)),D(t)?((p=_(t,!0)).x+=t.clientLeft,p.y+=t.clientTop):a&&(p.x=le(a))),{x:s.left+c.scrollLeft-p.x,y:s.top+c.scrollTop-p.y,width:s.width,height:s.height}}function Me(e){var t=new Map,n=new Set,r=[];function o(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!n.has(e)){var r=t.get(e);r&&o(r)}})),r.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||o(e)})),r}var Oe={placement:"bottom",modifiers:[],strategy:"absolute"};function Ae(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function De(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,r=void 0===n?[]:n,o=t.defaultOptions,i=void 0===o?Oe:o;return function(e,t,n){void 0===n&&(n=i);var o,l,a={placement:"bottom",orderedModifiers:[],options:Object.assign({},Oe,i),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},s=[],c=!1,p={state:a,setOptions:function(n){d(),a.options=Object.assign({},i,a.options,n),a.scrollParents={reference:A(e)?ce(e):e.contextElement?ce(e.contextElement):[],popper:ce(t)};var o,l,c=function(e){var t=Me(e);return k.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}((o=[].concat(r,a.options.modifiers),l=o.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e}),{}),Object.keys(l).map((function(e){return l[e]}))));return a.orderedModifiers=c.filter((function(e){return e.enabled})),a.orderedModifiers.forEach((function(e){var t=e.name,n=e.options,r=void 0===n?{}:n,o=e.effect;if("function"==typeof o){var i=o({state:a,name:t,instance:p,options:r}),l=function(){};s.push(i||l)}})),p.update()},forceUpdate:function(){if(!c){var e=a.elements,t=e.reference,n=e.popper;if(Ae(t,n)){a.rects={reference:ke(t,j(n),"fixed"===a.options.strategy),popper:N(n)},a.reset=!1,a.placement=a.options.placement,a.orderedModifiers.forEach((function(e){return a.modifiersData[e.name]=Object.assign({},e.data)}));for(var r=0;r<a.orderedModifiers.length;r++)if(!0!==a.reset){var o=a.orderedModifiers[r],i=o.fn,l=o.options,s=void 0===l?{}:l,d=o.name;"function"==typeof i&&(a=i({state:a,options:s,name:d,instance:p})||a)}else a.reset=!1,r=-1}}},update:(o=function(){return new Promise((function(e){p.forceUpdate(),e(a)}))},function(){return l||(l=new Promise((function(e){Promise.resolve().then((function(){l=void 0,e(o())}))}))),l}),destroy:function(){d(),c=!0}};if(!Ae(e,t))return p;function d(){s.forEach((function(e){return e()})),s=[]}return p.setOptions(n).then((function(e){!c&&n.onFirstUpdate&&n.onFirstUpdate(e)})),p}}De();var Ee=De({defaultModifiers:[ee,Se,Q,$,xe,ve,Ce,K,ye]});var $e=function(e){var t=e[0],n=e[1]/100,r=e[2]/100;return 0===r?[0,0,0]:[t,100*(2*(n*=(r*=2)<=1?r:2-r)/(r+n)),100*((r+n)/2)]};var Le=function(e){var t,n,r=e[0],o=e[1]/100,i=e[2]/100;return t=o*i,[r,100*(t=(t/=(n=(2-o)*i)<=1?n:2-n)||0),100*(n/=2)]};function Te(e){var t=e[0],n=e[1],r=e[2],o=Math.max(t,n,r),i=o-Math.min(t,n,r),l=i&&60*(o===t?(n-r)/i%6:o===n?(r-t)/i+2:(t-n)/i+4);return[l<0?l+360:l,o&&100*i/o,100*o/255]}function _e(e){var t=e[0]/60,n=e[1]/100,r=e[2]/100,o=r*n,i=r-o,l=255*(o*(1-Math.abs(t%2-1))+i)+.5|0,a=255*(o+i)+.5|0,s=255*i+.5|0,c=0|t;return 1===c?[l,a,s]:2===c?[s,a,l]:3===c?[s,l,a]:4===c?[l,s,a]:5===c?[a,s,l]:[a,l,s]}var Ne=function(e,t,n){return Math.min(Math.max(e,t),n)},Re=Ne;function He(e){var t=Math.round(Re(e,0,255)).toString(16);return 1==t.length?"0"+t:t}var Pe=function(e){var t=4===e.length?He(255*e[3]):"";return"#"+He(e[0])+He(e[1])+He(e[2])+t};var Fe=function(e){4!==e.length&&5!==e.length||(e=function(e){for(var t="#",n=1;n<e.length;n++){var r=e.charAt(n);t+=r+r}return t}(e));var t=[parseInt(e.substring(1,3),16),parseInt(e.substring(3,5),16),parseInt(e.substring(5,7),16)];if(9===e.length){var n=parseFloat((parseInt(e.substring(7,9),16)/255).toFixed(2));t.push(n)}return t};function ze(e,t){return e?[Ve(e[0])?je(e[0]):t[0],Ve(e[1])?Be(e[1]):t[1],Ve(e[2])?Be(e[2]):t[2]]:t}function Ie(e){return[je(e[0]),Be(e[1]),Be(e[2])]}function je(e){var t=Math.round(e%360*10)/10;return t<0?t+360:t}function Be(e){return e<0?0:e>100?100:(10*e+.5|0)/10}function Ve(e){return"number"==typeof e&&isFinite(e)}var We="undefined"!=typeof globalThis?globalThis:self,Ue="PointerEvent"in We?function(e,t,n){e.addEventListener("pointerdown",(function(e){0===e.button&&!1!==t(e)&&this.setPointerCapture(e.pointerId)})),e.addEventListener("pointermove",(function(e){this.hasPointerCapture(e.pointerId)&&n(e)}))}:"ontouchend"in We?function(e,t,n){var r=!1;e.addEventListener("touchstart",(function(e){1===e.touches.length&&!1!==t(e.touches[0])&&(r=!0,e.preventDefault())})),e.addEventListener("touchmove",(function(e){r&&1===e.touches.length&&(e.preventDefault(),n(e.touches[0]))}))}:function(e,t,n){var r=function(e){n(e)},o=function(){removeEventListener("mouseup",o),removeEventListener("mousemove",r)};e.addEventListener("mousedown",(function(e){0===e.button&&!1!==t(e)&&(addEventListener("mousemove",r),addEventListener("mouseup",o))}))},qe={hsv:[0,100,100],hsl:[0,100,50],wheelDiameter:200,wheelThickness:20,handleDiameter:16,wheelReflectsSaturation:!0,onChange:function(){}},Ge=We.DOMMatrix||We.WebKitCSSMatrix||We.MSCSSMatrix,Xe=function(e,t){return e===t||e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},Ke=function(){function e(t){var n=this;this.options=t,this.wheelDiameter=this.options.wheelDiameter||qe.wheelDiameter,this.wheelThickness=this.options.wheelThickness||qe.wheelThickness,this.handleDiameter=this.options.handleDiameter||qe.handleDiameter,this.onChange=this.options.onChange||qe.onChange,this.wheelReflectsSaturation=void 0!==this.options.wheelReflectsSaturation?this.options.wheelReflectsSaturation:qe.wheelReflectsSaturation,this.rootElement=this.options.appendTo.appendChild(Je("div","reinvented-color-wheel")),this.hueWheelElement=this.rootElement.appendChild(Je("canvas","reinvented-color-wheel--hue-wheel")),this.hueWheelContext=this.hueWheelElement.getContext("2d"),this.hueHandleElement=this.rootElement.appendChild(Je("div","reinvented-color-wheel--hue-handle")),this.svSpaceElement=this.rootElement.appendChild(Je("canvas","reinvented-color-wheel--sv-space")),this.svSpaceContext=this.svSpaceElement.getContext("2d"),this.svHandleElement=this.rootElement.appendChild(Je("div","reinvented-color-wheel--sv-handle")),this._redrawHueWheel=function(){n._redrawHueWheelRequested=!1;var e=n.wheelDiameter,t=e/2,r=t-n.wheelThickness/2,o=Math.PI/180,i=n.wheelReflectsSaturation?","+n._hsl[1]+"%,"+n._hsl[2]+"%)":",100%,50%)",l=n.hueWheelContext;l.clearRect(0,0,e,e),l.lineWidth=n.wheelThickness;for(var a=0;a<360;a++)l.beginPath(),l.arc(t,t,r,(a-90.7)*o,(a-89.3)*o),l.strokeStyle="hsl("+a+i,l.stroke()},this.hueWheelContext.imageSmoothingEnabled=!1,this.svSpaceContext.imageSmoothingEnabled=!1,this._hsv=ze(t.hsv?t.hsv:t.hsl?e.hsl2hsv(t.hsl):t.rgb?e.rgb2hsv(t.rgb):t.hex?e.rgb2hsv(e.hex2rgb(t.hex)):void 0,qe.hsv),this._hsl=Ie(e.hsv2hsl(this._hsv)),this._rgb=e.hsv2rgb(this._hsv),this._hex=e.rgb2hex(this._rgb);var r=function(e,t){var r=n._inverseTransform.multiply(new Ge("matrix(1,0,0,1,"+e+","+t+")"));return{x:r.e,y:r.f}},o=function(e){n._inverseTransform=function(e){for(var t=[e];e=e.parentElement;)t.push(e);for(var n=new Ge,r=t.length-1;r>=0;r--){var o=getComputedStyle(t[r]),i=o.transform;if(i&&"none"!==i){var l=o.transformOrigin.split(" ").map(parseFloat);n=n.translate(l[0],l[1]).multiply(new Ge(i)).translate(-l[0],-l[1])}}return n.inverse()}(e);var t=e.getBoundingClientRect();n._center=r(t.left+t.width/2,t.top+t.height/2)},i=function(e){var t=r(e.clientX,e.clientY),o=t.x-n._center.x,i=t.y-n._center.y,l=Math.atan2(i,o);n.hsv=[180*l/Math.PI+90,n.hsv[1],n.hsv[2]]},l=function(e){var t=r(e.clientX,e.clientY),o=100/n.svSpaceElement.width,i=(t.x-n._center.x)*o+50,l=(n._center.y-t.y)*o+50;n.hsv=[n._hsv[0],i,l]},a=function(e){o(n.svSpaceElement),l(e)};Ue(this.hueWheelElement,(function(e){o(n.hueWheelElement);var t=r(e.clientX,e.clientY),l=t.x-n._center.x,a=t.y-n._center.y,s=n.wheelDiameter/2-n.wheelThickness;if(l*l+a*a<s*s)return!1;i(e)}),i),Ue(this.svSpaceElement,a,l),Ue(this.svHandleElement,a,l),this.redraw()}return Object.defineProperty(e.prototype,"hsv",{get:function(){return this._hsv},set:function(e){Xe(this._hsv,e)||this._setHSV(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hsl",{get:function(){return this._hsl},set:function(t){Xe(this._hsl,t)||this._setHSV(e.hsl2hsv(t))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rgb",{get:function(){return this._rgb},set:function(t){Xe(this._rgb,t)||this._setHSV(e.rgb2hsv(t))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hex",{get:function(){return this._hex},set:function(t){this._hex!==t&&(this.rgb=e.hex2rgb(t))},enumerable:!1,configurable:!0}),e.prototype.setHSV=function(){this.hsv=arguments},e.prototype.setHSL=function(){this.hsl=arguments},e.prototype.redraw=function(){this.hueWheelElement.width=this.hueWheelElement.height=this.wheelDiameter,this.svSpaceElement.width=this.svSpaceElement.height=(this.wheelDiameter-2*this.wheelThickness)*Math.SQRT1_2;var e=this.hueHandleElement.style,t=this.svHandleElement.style;e.width=e.height=t.width=t.height=this.handleDiameter+"px",e.marginLeft=e.marginTop=t.marginLeft=t.marginTop=-this.handleDiameter/2+"px",this._redrawHueWheel(),this._redrawHueHandle(),this._redrawSvSpace(),this._redrawSvHandle()},e.prototype._setHSV=function(t){var n=this._hsv,r=this._hsv=ze(t,n),o=n[0]-r[0],i=n[1]-r[1]||n[2]-r[2];o&&(this._hsl=[r[0],this._hsl[1],this._hsl[2]],this._redrawHueHandle(),this._updateSvBackground()),i&&(this._hsl=Ie(e.hsv2hsl(r)),this._redrawSvHandle(),this.wheelReflectsSaturation&&!this._redrawHueWheelRequested&&(requestAnimationFrame(this._redrawHueWheel),this._redrawHueWheelRequested=!0)),(o||i)&&(this._rgb=e.hsv2rgb(r),this._hex=e.rgb2hex(this._rgb),this.onChange(this))},e.prototype._redrawSvSpace=function(){this._updateSvBackground();var e=this.svSpaceElement.width,t=this.svSpaceContext,n=t.createLinearGradient(0,0,e,0),r=t.createLinearGradient(0,0,0,e);n.addColorStop(0,"rgba(255,255,255,1)"),n.addColorStop(1,"rgba(255,255,255,0)"),r.addColorStop(0,"rgba(0,0,0,0)"),r.addColorStop(1,"rgba(0,0,0,1)"),t.fillStyle=n,t.fillRect(0,0,e,e),t.fillStyle=r,t.fillRect(0,0,e,e)},e.prototype._updateSvBackground=function(){this.svSpaceElement.style.backgroundColor="hsl("+this._hsv[0]+",100%,50%)"},e.prototype._redrawHueHandle=function(){var e=this.wheelDiameter/2,t=e-this.wheelThickness/2,n=(this._hsv[0]-90)*Math.PI/180,r=this.hueHandleElement.style;r.left=t*Math.cos(n)+e+"px",r.top=t*Math.sin(n)+e+"px"},e.prototype._redrawSvHandle=function(){var e=this.svSpaceElement.width,t=this.svHandleElement.style,n=(this.wheelDiameter-e)/2,r=this._hsv;t.left=n+e*r[1]/100+"px",t.top=n+e*(1-r[2]/100)+"px"},e.default=e,e.defaultOptions=qe,e.hsv2hsl=Le,e.hsl2hsv=$e,e.hsv2rgb=_e,e.rgb2hsv=Te,e.rgb2hex=Pe,e.hex2rgb=Fe,e}();function Je(e,t){var n=document.createElement(e);return n.className=t,n}var Ye={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t="check",n=[],r="f00c",o="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z";e.definition={prefix:"fas",iconName:t,icon:[512,512,n,r,o]},e.faCheck=e.definition,e.prefix="fas",e.iconName=t,e.width=512,e.height=512,e.ligatures=n,e.unicode=r,e.svgPathData=o}(Ye);var Qe,Ze,et,tt,nt={};function rt(){var e=arguments[0];"string"==typeof e&&(e=document.createElement(e));var t=1,n=arguments[1];if(n&&"object"==typeof n&&null==n.nodeType&&!Array.isArray(n)){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=n[r];"string"==typeof o?e.setAttribute(r,o):null!=o&&(e[r]=o)}t++}for(;t<arguments.length;t++)ot(e,arguments[t]);return e}function ot(e,t){if("string"==typeof t)e.appendChild(document.createTextNode(t));else if(null==t);else if(null!=t.nodeType)e.appendChild(t);else{if(!Array.isArray(t))throw new RangeError("Unsupported child node: "+t);for(var n=0;n<t.length;n++)ot(e,t[n])}}!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t="times",n=[],r="f00d",o="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z";e.definition={prefix:"fas",iconName:t,icon:[352,512,n,r,o]},e.faTimes=e.definition,e.prefix="fas",e.iconName=t,e.width=352,e.height=512,e.ligatures=n,e.unicode=r,e.svgPathData=o}(nt),Qe=t.customElement("rn-text-color-dialog"),Ze=t.query(".colorContainer"),Qe((et=class extends e.LitElementBase{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"colorContainer",tt,this),this.color="#000000"}static get properties(){return{color:{type:String}}}render(){return n.html` <div style="background-color: white;padding:20px; border: 1px solid #dfdfdf;border-radius: 5px;text-align: center;" class="rednao"> <div class="colorContainer"></div> <div style="position:relative;"> <div style="position:absolute;top:0;left: 0;height: 100%;width: 33.5px;background-color: ${this.color}"></div> <input .value=${this.color} style="padding-left: 36px" type="text" @change="${e=>{if(e.stopPropagation(),!/^#[0-9A-F]{6}$/i.test(e.target.value))return e.target.value=this.color,void this.forceUpdate();this.color=e.target.value,this.colorWheel.hex=e.target.value,this.colorWheel.redraw()}}"/> </div> <div> <button class="rnbtn rnbtn-danger" style="margin-top: 10px;display: inline-flex;align-items: center;margin-right: 10px;" @click="${e=>this.FireEvent("change",null)}"> <rn-fontawesome .icon="${nt.faTimes}" style="margin-right: 3px"></rn-fontawesome> Cancel </button> <button class="rnbtn rnbtn-primary" style="margin-top: 10px;display: inline-flex;align-items: center;" @click="${e=>this.FireEvent("change",this.color)}"> <rn-fontawesome .icon="${Ye.faCheck}" style="margin-right: 3px"></rn-fontawesome> Apply </button> </div> </div> `}firstUpdated(e){super.firstUpdated(e),this.colorWheel=new Ke({appendTo:this.colorContainer,hex:this.color,wheelDiameter:200,wheelThickness:20,handleDiameter:16,wheelReflectsSaturation:!0,onChange:e=>{this.color=e.hex}})}},tt=babelHelpers.applyDecoratedDescriptor(et.prototype,"colorContainer",[Ze],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),et));const it="ProseMirror-menubar";function lt(e,t){return n=>{let r=!1;for(let o=0;o<e.length;o++){let i=e[o](n);t[o].style.display=i?"":"none",i&&(r=!0)}return r}}function at(e,t){let n=document.createDocumentFragment(),r=[],o=[];for(let i=0;i<t.length;i++){let l=t[i],a=[],s=[];for(let t=0;t<l.length;t++){let{dom:r,update:o}=l[t].render(e),i=rt("span",{class:it+"item"},r);n.appendChild(i),s.push(i),a.push(o)}a.length&&(r.push(lt(a,s)),i<t.length-1&&o.push(n.appendChild(rt("span",{class:it+"separator"}))))}return{dom:n,update:function(e){let t=!1,n=!1;for(let i=0;i<r.length;i++){let l=r[i](e);i&&(o[i-1].style.display=n&&l?"":"none"),n=l,l&&(t=!0)}return t}}}class st{constructor(e,t){this.editorView=e,this.options=t,this.wrapper=rt("div",{class:it+"-wrapper"}),this.menu=this.wrapper.appendChild(rt("div",{class:it})),this.menu.className=it,this.spacer=null,this.wrapper2=rt("div",{class:it+"-wrapper"}),this.menu2=this.wrapper.appendChild(rt("div",{class:it})),this.menu2.className=it,e.dom.parentNode.replaceChild(this.wrapper,e.dom),this.wrapper.appendChild(e.dom),e.dom.parentNode.replaceChild(this.wrapper2,e.dom),this.wrapper2.appendChild(e.dom),this.maxHeight=0,this.widthForMaxHeight=0,this.floating=!1;let{dom:n,update:r}=at(this.editorView,this.GetMenuContent(this.options.content,!1)),o=at(this.editorView,this.GetMenuContent(this.options.content,!0));if(this.contentUpdate=r,this.contentUpdate2=o.update,this.menu.appendChild(n),this.menu2.appendChild(o.dom),this.update(),t.floating&&!function(){if("undefined"==typeof navigator)return!1;let e=navigator.userAgent;return!/Edge\/\d/.test(e)&&/AppleWebKit/.test(e)&&/Mobile\/\w+/.test(e)}()){this.updateFloat();let e=function(e){let t=[window];for(let n=e.parentNode;n;n=n.parentNode)t.push(n);return t}(this.wrapper);this.scrollFunc=t=>{let n=this.editorView.root;(n.body||n).contains(this.wrapper)?this.updateFloat(t.target.getBoundingClientRect&&t.target):e.forEach((e=>e.removeEventListener("scroll",this.scrollFunc)))},e.forEach((e=>e.addEventListener("scroll",this.scrollFunc)))}}GetMenuContent(e,t=!1){let n=[];for(let r of e){let e=[];for(let n of r)1==n.IsSubMenu&&t&&e.push(n),1==n.IsSubMenu||t||e.push(n);e.length>0&&n.push(e)}return n}update(){this.contentUpdate(this.editorView.state),this.contentUpdate2(this.editorView.state),this.floating?this.updateScrollCursor():(this.menu.offsetWidth!=this.widthForMaxHeight&&(this.widthForMaxHeight=this.menu.offsetWidth,this.maxHeight=0),this.menu.offsetHeight>this.maxHeight&&(this.maxHeight=this.menu.offsetHeight))}updateScrollCursor(){let e=this.editorView.root.getSelection();if(!e.focusNode)return;let t=e.getRangeAt(0).getClientRects(),n=t[function(e){return e.anchorNode==e.focusNode?e.anchorOffset>e.focusOffset:e.anchorNode.compareDocumentPosition(e.focusNode)==Node.DOCUMENT_POSITION_FOLLOWING}(e)?0:t.length-1];if(!n)return;let r=this.menu.getBoundingClientRect();if(n.top<r.bottom&&n.bottom>r.top){let e=function(e){for(let t=e.parentNode;t;t=t.parentNode)if(t.scrollHeight>t.clientHeight)return t}(this.wrapper);e&&(e.scrollTop-=r.bottom-n.top)}}updateFloat(e=void 0){let t=this.wrapper,n=t.getBoundingClientRect(),r=e?Math.max(0,e.getBoundingClientRect().top):0;if(this.floating)if(n.top>=r||n.bottom<this.menu.offsetHeight+10)this.floating=!1,this.menu.style.position=this.menu.style.left=this.menu.style.top=this.menu.style.width="",this.menu.style.display="",this.spacer.parentNode.removeChild(this.spacer),this.spacer=null;else{let o=(t.offsetWidth-t.clientWidth)/2;this.menu.style.left=n.left+o+"px",this.menu.style.display=n.top>window.innerHeight?"none":"",e&&(this.menu.style.top=r+"px")}else if(n.top<r&&n.bottom>=this.menu.offsetHeight+10){this.floating=!0;let n=this.menu.getBoundingClientRect();this.menu.style.left=n.left+"px",this.menu.style.width=n.width+"px",e&&(this.menu.style.top=r+"px"),this.menu.style.position="fixed",this.spacer=rt("div",{class:it+"-spacer",style:`height: ${n.height}px`}),t.insertBefore(this.spacer,this.menu)}}destroy(){this.wrapper.parentNode&&this.wrapper.parentNode.replaceChild(this.editorView.dom,this.wrapper)}}class ct{constructor(e,t=!1){this.Options=e,this.IsSubMenu=t}}const pt="ProseMirror-menu";let dt={time:0,node:null};function ht(e){dt.time=Date.now(),dt.node=e.target}function ut(e){return Date.now()-100<dt.time&&dt.node&&e.contains(dt.node)}function ft(e,t){return e._props.translate?e._props.translate(t):t}class mt extends ct{constructor(e,t,n=!1){super(t,n),this.content=Array.isArray(e)?e:[e]}render(e){let t=gt(this.content,e),n=rt("div",{class:pt+"-dropdown "+(this.Options.class||""),style:this.Options.css},ft(e,this.Options.label));this.Options.title&&n.setAttribute("title",ft(e,this.Options.title));let r=rt("div",{class:pt+"-dropdown-wrap"},n);this.wrap=r;let o=null,i=null,l=()=>{o&&o.close()&&(o=null,window.removeEventListener("mousedown",i))};return n.addEventListener("mousedown",(e=>{e.preventDefault(),ht(e),o?l():(o=this.expand(r,t.dom),window.addEventListener("mousedown",i=()=>{ut(r)||l()}))})),{dom:r,update:function(e){let n=t.update(e);return r.style.display=n?"":"none",n}}}expand(e,t){let n=rt("div",{class:pt+"-dropdown-menu "+(this.Options.class||"")},t),r=!1;return n.style.zIndex="10000000000000",document.body.appendChild(n),Ee(this.wrap,n,{placement:"bottom-start",modifiers:[{name:"offset",options:{offset:[0,2]}},{name:"arrow",options:{padding:5}}]}),{close:function(){if(!r)return r=!0,n.remove(),!0},node:n}}}function gt(e,t){let n=[],r=[];for(let o=0;o<e.length;o++){let{dom:i,update:l}=e[o].render(t);n.push(rt("div",{class:pt+"-dropdown-item"},i)),r.push(l)}return{dom:n,update:vt(r,n)}}function vt(e,t){return n=>{let r=!1;for(let o=0;o<e.length;o++){let i=e[o](n);t[o].style.display=i?"":"none",i&&(r=!0)}return r}}class wt{constructor(e,t){this.options=t||{},this.content=Array.isArray(e)?e:[e]}render(e){let t=gt(this.content,e),n=rt("div",{class:pt+"-submenu-label"},ft(e,this.options.label)),r=rt("div",{class:pt+"-submenu-wrap"},n,rt("div",{class:pt+"-submenu"},t.dom)),o=null;return n.addEventListener("mousedown",(e=>{var t,n,i;e.preventDefault(),ht(e),t=r,n=pt+"-submenu-wrap-active",i?t.classList.add(n):t.classList.remove(n),o||window.addEventListener("mousedown",o=()=>{ut(r)||(r.classList.remove(pt+"-submenu-wrap-active"),window.removeEventListener("mousedown",o),o=null)})})),{dom:r,update:function(e){let n=t.update(e);return r.style.display=n?"":"none",n}}}}const bt="ProseMirror-menu";function yt(e,t,n){n?e.classList.add(t):e.classList.remove(t)}function xt(e,t){return e._props.translate?e._props.translate(t):t}class St extends ct{constructor(e,t=!1){super(e,t)}render(e){let t=this.Options,n=t.render?t.render(e):t.icon?r.getIcon(t.icon):t.label?rt("div",null,xt(e,t.label)):null;if(!n)throw new RangeError("MenuItem without icon or label property");if(t.title){const r="function"==typeof t.title?t.title(e.state):t.title;n.setAttribute("title",xt(e,r))}return t.class&&n.classList.add(t.class),t.css&&(n.style.cssText+=t.css),n.addEventListener("mousedown",(r=>{r.preventDefault(),n.classList.contains(bt+"-disabled")||t.run(e.state,e.dispatch,e,r)})),{dom:n,update:function(e){if(t.select){let r=t.select(e);if(n.style.display=r?"":"none",!r)return!1}let r=!0;if(t.enable&&(r=t.enable(e)||!1,yt(n,bt+"-disabled",!r)),t.active){let o=r&&t.active(e)||!1;yt(n,bt+"-active",o)}return!0}}}}var Ct={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t="align-left",n=[],r="f036",o="M12.83 352h262.34A12.82 12.82 0 0 0 288 339.17v-38.34A12.82 12.82 0 0 0 275.17 288H12.83A12.82 12.82 0 0 0 0 300.83v38.34A12.82 12.82 0 0 0 12.83 352zm0-256h262.34A12.82 12.82 0 0 0 288 83.17V44.83A12.82 12.82 0 0 0 275.17 32H12.83A12.82 12.82 0 0 0 0 44.83v38.34A12.82 12.82 0 0 0 12.83 96zM432 160H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0 256H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z";e.definition={prefix:"fas",iconName:t,icon:[448,512,n,r,o]},e.faAlignLeft=e.definition,e.prefix="fas",e.iconName=t,e.width=448,e.height=512,e.ligatures=n,e.unicode=r,e.svgPathData=o}(Ct);var kt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t="align-center",n=[],r="f037",o="M432 160H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0 256H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zM108.1 96h231.81A12.09 12.09 0 0 0 352 83.9V44.09A12.09 12.09 0 0 0 339.91 32H108.1A12.09 12.09 0 0 0 96 44.09V83.9A12.1 12.1 0 0 0 108.1 96zm231.81 256A12.09 12.09 0 0 0 352 339.9v-39.81A12.09 12.09 0 0 0 339.91 288H108.1A12.09 12.09 0 0 0 96 300.09v39.81a12.1 12.1 0 0 0 12.1 12.1z";e.definition={prefix:"fas",iconName:t,icon:[448,512,n,r,o]},e.faAlignCenter=e.definition,e.prefix="fas",e.iconName=t,e.width=448,e.height=512,e.ligatures=n,e.unicode=r,e.svgPathData=o}(kt);var Mt,Ot,At,Dt,Et,$t,Lt,Tt,_t={};function Nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t="align-right",n=[],r="f038",o="M16 224h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16zm416 192H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm3.17-384H172.83A12.82 12.82 0 0 0 160 44.83v38.34A12.82 12.82 0 0 0 172.83 96h262.34A12.82 12.82 0 0 0 448 83.17V44.83A12.82 12.82 0 0 0 435.17 32zm0 256H172.83A12.82 12.82 0 0 0 160 300.83v38.34A12.82 12.82 0 0 0 172.83 352h262.34A12.82 12.82 0 0 0 448 339.17v-38.34A12.82 12.82 0 0 0 435.17 288z";e.definition={prefix:"fas",iconName:t,icon:[448,512,n,r,o]},e.faAlignRight=e.definition,e.prefix="fas",e.iconName=t,e.width=448,e.height=512,e.ligatures=n,e.unicode=r,e.svgPathData=o}(_t),Mt=t.customElement("rn-font-size-dialog"),Ot=t.query(".colorContainer"),Mt((At=class extends e.LitElementBase{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"colorContainer",Dt,this),this.color="#000000"}static get properties(){return{color:{type:String}}}render(){return n.html` <ul @click="${e=>e.stopImmediatePropagation()}" @mousedown="${e=>{e.stopPropagation(),e.preventDefault()}}" style="list-style: none; background-color: white;padding:20px; border: 1px solid #dfdfdf;border-radius: 5px;text-align: center;" class="rednao"> <li @click="${e=>this.FireChange("")}">Default</li> <li @click="${e=>this.FireChange("8px")}">8 px</li> <li @click="${e=>this.FireChange("10px")}">10 px</li> <li @click="${e=>this.FireChange("12px")}">12 px</li> <li @click="${e=>this.FireChange("14px")}">14 px</li> <li @click="${e=>this.FireChange("18px")}">18 px</li> <li @click="${e=>this.FireChange("24px")}">24 px</li> <li @click="${e=>this.FireChange("36px")}">36 px</li> <li>Custom: <input @click="${e=>{e.stopPropagation(),e.preventDefault()}}" @focus="${e=>e.stopPropagation()}" @mousedown="${e=>{e.stopPropagation()}}" type="text" style="width: 50px;display: inline-block" @change="${e=>{e.stopPropagation(),this.FireChange(e.target.value)}}"/></li> </ul> `}FireChange(e){let t=/^\d+(\.\d+)?(px|%|em)$/;""==e&&this.FireEvent("change",e),t.test(e)&&this.FireEvent("change",e),t.test(e+"px")&&this.FireEvent("change",e+"px")}},Dt=babelHelpers.applyDecoratedDescriptor(At.prototype,"colorContainer",[Ot],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),At));class Rt{static GetNodeInSelection(e,t,n=!0){if(i.Sanitizer.GetStringValueFromPath(e.state.selection,["node","type","name"])==t)return{node:e.state.selection.node,pos:e.state.selection.from};let r=e.state.selection.$head;for(let e=r.depth;e>0;e--)if(r.node(e).type.name==t)return{pos:r.before(e),node:r.node(e)};return null}static UpdateNodeAttributes(e,t,n,r,o=!0){let i=n.split("."),l={},a=e.state.doc.nodeAt(t);if(1==i.length)l[n]=r;else{let e=i.shift(),t=a.attrs[e];if(null==t)t={};else try{t=JSON.parse(t)}catch(e){t={}}let n=null,o=t;for(;n=i.shift();)0==i.length&&(o[n]=r),null==o[n]&&(n[n]={}),o=o[n];l[e]=JSON.stringify(t)}o&&(l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nt(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},a.attrs,{},l)),e.dispatch(e.state.tr.setNodeMarkup(t,void 0,l))}static SetMarkValue(e,t){return function(n,r){var o=n.selection,i=o.empty,l=o.$cursor,a=o.ranges;if(i&&!l||!function(e,t,n){for(var r=function(r){var o=t[r],i=o.$from,l=o.$to,a=0==i.depth&&e.type.allowsMarkType(n);if(e.nodesBetween(i.pos,l.pos,(function(e){if(a)return!1;a=e.inlineContent&&e.type.allowsMarkType(n)})),a)return{v:!0}},o=0;o<t.length;o++){var i=r(o);if(i)return i.v}return!1}(n.doc,a,e))return!1;if(r)if(l)e.isInSet(n.storedMarks||l.marks())&&r(n.tr.removeStoredMark(e)),null!=t&&r(n.tr.addStoredMark(e.create(t)));else{for(var s=!1,c=n.tr,p=0;!s&&p<a.length;p++){var d=a[p],h=d.$from,u=d.$to;s=n.doc.rangeHasMark(h.pos,u.pos,e)}for(var f=0;f<a.length;f++){var m=a[f],g=m.$from,v=m.$to;if(s&&c.removeMark(g.pos,v.pos,e),null!=t){var w=g.pos,b=v.pos,y=g.nodeAfter,x=v.nodeBefore,S=y&&y.isText?/^\s*/.exec(y.text)[0].length:0,C=x&&x.isText?/\s*$/.exec(x.text)[0].length:0;w+S<b&&(w+=S,b-=C),c.addMark(w,b,e.create(t))}}r(c.scrollIntoView())}return!0}}}Et=t.customElement("rn-font-family-dialog"),$t=t.query(".colorContainer"),Et((Lt=class extends e.LitElementBase{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"colorContainer",Tt,this),this.color="#000000"}static get properties(){return{color:{type:String}}}render(){let e=[];return null!=rednaoFormDesigner.Fonts&&(e=Object.keys(rednaoFormDesigner.Fonts)),n.html` <ul @click="${e=>e.stopImmediatePropagation()}" @mousedown="${e=>{e.stopPropagation(),e.preventDefault()}}" style="list-style: none; background-color: white;padding:20px; border: 1px solid #dfdfdf;border-radius: 5px;text-align: center;" class="rednao"> <li @click="${e=>this.FireChange("")}">Default</li> <li style="font-family: Arial" @click="${e=>this.FireChange("Arial")}">Arial</li> <li style="font-family: Comic Sans MS Black" @click="${e=>this.FireChange("Arial Black")}">Arial Black</li> <li style="font-family: Arial" @click="${e=>this.FireChange("Comic Sans MS")}">Comic Sans MS</li> <li style="font-family: Courier New" @click="${e=>this.FireChange("Courier New")}">Courier New</li> <li style="font-family: Georgia" @click="${e=>this.FireChange("Georgia")}">Georgia</li> <li style="font-family: Impact" @click="${e=>this.FireChange("Impact")}">Impact</li> <li style="font-family: Lucida Console" @click="${e=>this.FireChange("Lucida Console")}">Lucida Console</li> <li style="font-family: Lucida Sans Unicode" @click="${e=>this.FireChange("Lucida Sans Unicode")}">Lucida Sans Unicode</li> <li style="font-family: Palatino Linotype" @click="${e=>this.FireChange("Palatino Linotype")}">Palatino Linotype</li> <li style="font-family: Tahoma" @click="${e=>this.FireChange("Tahoma")}">Tahoma</li> <li style="font-family: Times New Roman" @click="${e=>this.FireChange("Times New Roman")}">Times New Roman</li> <li style="font-family: Trebuchet MS" @click="${e=>this.FireChange("Trebuchet MS")}">Trebuchet MS</li> <li style="font-family: Verdana" @click="${e=>this.FireChange("Verdana")}">Verdana</li> <li style="border-top: 1px solid #ccc;" @click="${e=>this.FireChange("New font")}">New font</li> ${a.repeat(e,(e=>e),(e=>n.html`<li style="font-family: ${e}" @click="${t=>this.FireChange(e)}">${e}</li>`))} </ul> `}FireChange(e){if("New font"==e)return l.EventManager.Publish("LicenseRequired")&&l.EventManager.Publish("OpenSettings",{Tab:"CustomFont"}),void this.FireEvent("change",null);this.FireEvent("change",e)}},Tt=babelHelpers.applyDecoratedDescriptor(Lt.prototype,"colorContainer",[$t],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lt));const Ht=["blockquote",0],Pt=["hr"],Ft=["pre",["code",0]],zt=["br"];function It(e=!1){return{doc:{content:e?"paragraph":"block+"},paragraph:{attrs:{align:{default:null}},content:"inline*",group:"block",parseDOM:[{tag:e?"div":"p",getAttrs:e=>({align:e.style.textAlign||null})}],toDOM(t){let n="";return null!=t.attrs.align&&(n="text-align:"+t.attrs.align+";"),[e?"div":"p",{style:n},0]}},blockquote:{content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:()=>Ht},horizontal_rule:{group:"block",parseDOM:[{tag:"hr"}],toDOM:()=>Pt},heading:{attrs:{level:{default:1},align:{default:null}},content:"inline*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM:e=>["h"+e.attrs.level,0]},code_block:{content:"text*",marks:"",group:"block",code:!0,defining:!0,parseDOM:[{tag:"pre",preserveWhitespace:"full"}],toDOM:()=>Ft},text:{group:"inline"},image:{inline:!0,attrs:{src:{},alt:{default:null},title:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs:e=>({src:e.getAttribute("src"),title:e.getAttribute("title"),alt:e.getAttribute("alt")})}],toDOM(e){let{src:t,alt:n,title:r}=e.attrs;return["img",{src:t,alt:n,title:r}]}},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:()=>zt}}}const jt=["em",0],Bt=["strong",0],Vt=["code",0],Wt={link:{attrs:{href:{},target:{default:"_blank"},type:{default:""}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:e=>({href:e.getAttribute("href"),target:e.getAttribute("target")})}],toDOM(e){let{href:t,target:n}=e.attrs;return["a",{href:t,target:n},0]}},em:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"}],toDOM:()=>jt},strong:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!=e.style.fontWeight&&null},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],toDOM:()=>Bt},code:{parseDOM:[{tag:"code"}],toDOM:()=>Vt}},Ut=new r.Schema({nodes:It(),marks:Wt}),qt=new r.Schema({nodes:It(!0),marks:Wt});function Gt(e){if(e.selection.empty){const t=e.selection.$from,n=e.storedMarks;return n||t.marks()}{const t=e.selection.$head,n=e.selection.$anchor,r=[];return t.marks().forEach((e=>r.push(e))),n.marks().forEach((e=>r.push(e))),Array.from(r)}}function Xt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xt(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Jt=function(e){this.options=e};function Yt(e,t){var n={label:t.title,run:e};for(var r in t)n[r]=t[r];return t.enable&&!0!==t.enable||t.select||(n[t.enable?"enable":"select"]=function(t){return e(t)}),new St(n)}function Qt(e,t){var n=e.selection,r=n.from,o=n.$from,i=n.to;return n.empty?t.isInSet(e.storedMarks||o.marks()):e.doc.rangeHasMark(r,i,t)}function Zt(e,t){var n={active:function(t){return Qt(t,e)},enable:!0};for(var o in t)n[o]=t[o];return Yt(r.toggleMark(e),n)}function en(e,t){return Yt(r.wrapInList(e,t.attrs),t)}function tn(e,t={}){var i,l={};if((i=e.marks.strong)&&(l.toggleStrong=Zt(i,{title:"Toggle strong style",icon:r.icons.strong})),(i=e.marks.em)&&(l.toggleEm=Zt(i,{title:"Toggle emphasis",icon:r.icons.em})),(i=e.marks.code)&&(l.toggleCode=Zt(i,{title:"Toggle code font",icon:r.icons.code})),(i=e.marks.link)&&(l.toggleLink=function(e,t={}){return new St({title:"Add or remove link",icon:r.icons.link,active:function(t){return Qt(t,e)},enable:function(e){return!e.selection.empty},run:async function(i,l,a){if(Qt(i,e))return r.toggleMark(e)(i,l),!0;let s=await o.Dialog.Show(n.html`<rn-te-link-dialog .linkTypes="${null==t.LinkTypes?[]:t.LinkTypes}"></rn-te-link-dialog>`);null!=s&&(r.toggleMark(e,{href:s.URL,target:s.Target,type:s.Type})(a.state,a.dispatch),a.focus())}})}(i,t)),(i=e.nodes.image)&&(i=e.nodes.bullet_list)&&(l.wrapBulletList=en(i,{title:"Wrap in bullet list",icon:r.icons.bulletList})),(i=e.nodes.ordered_list)&&(l.wrapOrderedList=en(i,{title:"Wrap in ordered list",icon:r.icons.orderedList})),(i=e.nodes.blockquote)&&(l.wrapBlockQuote=r.wrapItem(i,{title:"Wrap in block quote",icon:r.icons.blockquote})),(i=e.nodes.paragraph)&&(l.makeParagraph=r.blockTypeItem(i,{title:"Change to paragraph",label:"Plain"})),(i=e.nodes.code_block)&&(l.makeCodeBlock=r.blockTypeItem(i,{title:"Change to code block",label:"Code"})),i=e.nodes.heading)for(var a=1;a<=10;a++)l["makeHead"+a]=r.blockTypeItem(i,{title:"Change to heading "+a,label:"Level "+a,attrs:{level:a}});if(i=e.nodes.horizontal_rule){var s=i;l.insertHorizontalRule=new St({title:"Insert horizontal rule",label:"Horizontal rule",enable:function(e){return function(e,t){for(var n=e.selection.$from,r=n.depth;r>=0;r--){var o=n.index(r);if(n.node(r).canReplaceWith(o,o,t))return!0}return!1}(e,s)},run:function(e,t){t(e.tr.replaceSelectionWith(s.create()))}})}var p,d=function(e){return e.filter((function(e){return e}))};return l.insertMenu=new mt(d([l.insertHorizontalRule]),{label:"Insert"}),l.typeMenu=new mt(d([l.makeParagraph,l.makeHead1&&new wt(d([l.makeHead1,l.makeHead2,l.makeHead3,l.makeHead4,l.makeHead5,l.makeHead6]),{label:"Heading"})]),{label:"Type..."}),l.inlineMenu=[d([l.toggleStrong,l.toggleEm,l.toggleLink,(p=null,new St({title:"Color",select:e=>{let t=Gt(e).find((e=>"color"==e.type.name)),n="#000000";return null!=t&&(n=t.attrs.color),p.querySelector(".divColor").style.backgroundColor=n,!0},render:e=>p=n.renderInline(n.html` <div style="display: inline-flex;align-items: center;"> <div style="vertical-align:middle;border: 1px solid black;padding: 2px;cursor:pointer;display: block;align-items: center;" @click="${()=>{}}"> <div class="divColor" style="background-color: black;border: 1px solid black;height: 7px;width: 12px;"> </div> </div> </div>`),enable:function(e){return!0},run:async(e,t,r)=>{let o=await async function(e,t="#000000"){return new Promise((async r=>{let o=await n.renderInline(n.html`<rn-text-color-dialog .color="${t}" style="z-index: 1000000000000000" @change="${e=>{o.remove(),r(e.detail)}}"></rn-text-color-dialog>`);document.body.appendChild(o),Ee(e,o,{modifiers:[{name:"offset",options:{offset:[0,2]}},{name:"arrow",options:{padding:5}}]})}))}(p);null!=o&&(p.querySelector(".divColor").style.backgroundColor=o,Rt.SetMarkValue(e.doc.type.schema.marks.color,{color:o})(r.state,r.dispatch),r.focus())}}))])],l.blockMenu=[d([l.wrapBulletList,l.wrapOrderedList,l.wrapBlockQuote,new St({title:"Insert Table",render:e=>n.renderInline(n.html`<rn-fontawesome style="cursor: pointer; display: flex" .icon="${c.faTable}"></rn-fontawesome>`),active:()=>!1,enable:()=>!0,run:(e,t)=>{const n=e.tr.replaceSelectionWith(e.schema.nodes.table.create(void 0,r.Fragment.fromArray([e.schema.nodes.table_row.create(void 0,r.Fragment.fromArray([e.schema.nodes.table_cell.createAndFill(),e.schema.nodes.table_cell.createAndFill()]))])));return t&&t(n),!0}}),nn,r.liftItem,r.selectParentNodeItem])],l.fullMenu=l.inlineMenu.concat([[on()]],!0===t.AllowFontFamily?[[rn()]]:[],[[l.insertMenu,l.typeMenu]],[[r.undoItem,r.redoItem]],l.blockMenu,[d([pn("left",Ct.faAlignLeft),pn("center",kt.faAlignCenter),pn("right",_t.faAlignRight)])]),l}Jt.prototype.read=function(e){return e.value},Jt.prototype.validateType=function(e){},Jt.prototype.validate=function(e){return!e&&this.options.required?"Required field":this.validateType(e)||this.options.validate&&this.options.validate(e)},Jt.prototype.clean=function(e){return this.options.clean?this.options.clean(e):e},function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(){var e=document.createElement("input");return e.type="text",e.placeholder=this.options.label,e.value=this.options.value||"",e.autocomplete="off",e}}(Jt);const nn=new St({title:"Join with above block",run:r.joinUp,select:e=>r.joinUp(e),icon:r.icons.join},!0);function rn(){var e=null;return new St({title:"Font Family",select:t=>{let n=Gt(t).find((e=>"fontfamily"==e.type.name)),r="Default";return null!=n&&(r=n.attrs.name),e.innerText=""==r?"Default":r,!0},render:t=>e=n.renderInline(n.html` <div class="divSize" style="white-space: nowrap;width: 80px; display: inline-flex;align-items: center;margin:0 2px;cursor: pointer;text-align: center;text-overflow: ellipsis;overflow: hidden"> Default </div> </div>`),enable:function(e){return!0},run:async(t,r,o)=>{let i=await async function(e,t=""){return new Promise((async r=>{let o=await n.renderInline(n.html`<rn-font-family-dialog .name="${t}" style="z-index: 1000000000000000" @change="${e=>{o.remove(),r(e.detail)}}"></rn-font-family-dialog>`);document.body.appendChild(o);let i=Ee(e,o,{modifiers:[{name:"offset",options:{offset:[0,2]}},{name:"arrow",options:{padding:5}}]});document.addEventListener("mousedown",(t=>{e.contains(t.target)||i.destroy()}))}))}(e);null!==i&&(e.innerText=""==i?"Default":i,e.title=i,Rt.SetMarkValue(t.doc.type.schema.marks.fontfamily,""==i?null:{name:i})(o.state,o.dispatch),o.focus())}})}function on(){var e=null;return new St({title:"Font Size",select:t=>{let n=Gt(t).find((e=>"fontsize"==e.type.name)),r="Default";return null!=n&&(r=n.attrs.size),e.innerText=""==r?"Default":r,!0},render:t=>e=n.renderInline(n.html` <div class="divSize" style=" display: inline-flex;align-items: center;margin:0 2px;cursor: pointer;text-align: center;"> Default </div> </div>`),enable:function(e){return!0},run:async(t,r,o)=>{let i=await async function(e,t="#000000"){return new Promise((async r=>{let o=await n.renderInline(n.html`<rn-font-size-dialog .color="${t}" style="z-index: 1000000000000000" @change="${e=>{o.remove(),r(e.detail)}}"></rn-font-size-dialog>`);document.body.appendChild(o);let i=Ee(e,o,{modifiers:[{name:"offset",options:{offset:[0,2]}},{name:"arrow",options:{padding:5}}]});document.addEventListener("mousedown",(t=>{e.contains(t.target)||i.destroy()}))}))}(e);null!=i&&(e.innerText=""==i?"Default":i,Rt.SetMarkValue(t.doc.type.schema.marks.fontsize,""==i?null:{size:i})(o.state,o.dispatch),o.focus())}})}var ln="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);function an(e,t){var n,o={};function i(e,n){if(t){var r=t[e];if(!1===r)return;r&&(e=r)}o[e]=n}if(i("Mod-z",r.undo),i("Shift-Mod-z",r.redo),i("Backspace",r.undoInputRule),ln||i("Mod-y",r.redo),i("Alt-ArrowUp",r.joinUp),i("Alt-ArrowDown",r.joinDown),i("Mod-BracketLeft",r.lift),i("Escape",r.selectParentNode),(n=e.marks.strong)&&(i("Mod-b",r.toggleMark(n)),i("Mod-B",r.toggleMark(n))),(n=e.marks.em)&&(i("Mod-i",r.toggleMark(n)),i("Mod-I",r.toggleMark(n))),(n=e.marks.code)&&i("Mod-`",r.toggleMark(n)),(n=e.nodes.bullet_list)&&i("Shift-Ctrl-8",r.wrapInList(n)),(n=e.nodes.ordered_list)&&i("Shift-Ctrl-9",r.wrapInList(n)),(n=e.nodes.blockquote)&&i("Ctrl->",r.wrapIn(n)),n=e.nodes.hard_break){var l=n,a=r.chainCommands(r.exitCode,(function(e,t){return t(e.tr.replaceSelectionWith(l.create()).scrollIntoView()),!0}));i("Mod-Enter",a),i("Shift-Enter",a),ln&&i("Ctrl-Enter",a)}if((n=e.nodes.list_item)&&(i("Enter",r.splitListItem(n)),i("Mod-[",r.liftListItem(n)),i("Mod-]",r.sinkListItem(n))),(n=e.nodes.paragraph)&&i("Shift-Ctrl-0",r.setBlockType(n)),(n=e.nodes.code_block)&&i("Shift-Ctrl-\\",r.setBlockType(n)),n=e.nodes.heading)for(var s=1;s<=6;s++)i("Shift-Ctrl-"+s,r.setBlockType(n,{level:s}));if(n=e.nodes.horizontal_rule){var c=n;i("Mod-_",(function(e,t){return t(e.tr.replaceSelectionWith(c.create()).scrollIntoView()),!0}))}return o}function sn(e){var t,n,o=r.smartQuotes.concat(r.ellipsis,r.emDash);return(t=e.nodes.blockquote)&&o.push((n=t,r.wrappingInputRule(/^\s*>\s$/,n))),(t=e.nodes.ordered_list)&&o.push(function(e){return r.wrappingInputRule(/^(\d+)\.\s$/,e,(function(e){return{order:+e[1]}}),(function(e,t){return t.childCount+t.attrs.order==+e[1]}))}(t)),(t=e.nodes.bullet_list)&&o.push(function(e){return r.wrappingInputRule(/^\s*([-+*])\s$/,e)}(t)),(t=e.nodes.code_block)&&o.push(function(e){return r.textblockTypeInputRule(/^```$/,e)}(t)),(t=e.nodes.heading)&&o.push(function(e,t){return r.textblockTypeInputRule(new RegExp("^(#{1,"+t+"})\\s$"),e,(function(e){return{level:e[1].length}}))}(t,6)),r.inputRules({rules:o})}function cn(e){var t=[sn(e.schema),r.keymap(an(e.schema,e.mapKeys)),r.keymap(r.baseKeymap),r.dropCursor(),r.gapCursor()];return!1!==e.menuBar&&t.push(function(e){return new r.Plugin({view:t=>new st(t,e)})}({floating:!1!==e.floatingMenu,content:e.menuContent||tn(e.schema).fullMenu})),!1!==e.history&&t.push(r.history()),t.concat(new r.Plugin({props:{attributes:{class:"ProseMirror-example-setup-style"}}}))}function pn(e,t){return new St({title:"Color",select:e=>e.selection instanceof r.TextSelection||e.selection instanceof r.AllSelection,render:e=>n.renderInline(n.html`<div style="padding: 2px 8px"><rn-fontawesome class="proseAlignment" style="cursor: pointer; display: flex" .icon="${t}"></rn-fontawesome> </div>`),active:function(t){const{selection:n,doc:r}=t,{from:o,to:i}=n;let l=!0,a=!1;return r.nodesBetween(o,i,((t,n)=>(l&&t.attrs.align===e&&(l=!1,a=!0),l))),a},enable:function(e){return e.selection instanceof r.TextSelection||e.selection instanceof r.AllSelection},run:async(t,n,r)=>{let o=t.selection,i=t.doc;if(!o||!i)return;const{from:l,to:a}=o,{nodes:s}=Ut,c=[];e=e||null;const p=new Set([s.paragraph.name,s.heading.name,s.image.name]);i.nodesBetween(l,a,((t,n,r)=>{const o=t.type;return(t.attrs.align||null)!==e&&p.has(o.name)&&c.push({node:t,pos:n,nodeType:o}),!0})),c.length&&c.forEach((t=>{const{node:o,pos:i,nodeType:l}=t;let{attrs:a}=o;a=Kt({},a,e?{align:e}:{align:null}),n(r.state.tr.setNodeMarkup(i,l,a,o.marks))}))}})}const dn=["blockquote",0],hn=["hr"],un=["pre",["code",0]],fn=["br"];function mn(e=!1){return{doc:{content:e?"paragraph":"block+"},paragraph:{attrs:{align:{default:null}},content:"inline*",group:"block",parseDOM:[{tag:e?"div":"p",getAttrs:e=>({align:e.style.textAlign||null})}],toDOM(t){let n="";return null!=t.attrs.align&&(n="text-align:"+t.attrs.align+";"),[e?"div":"p",{style:n},0]}},blockquote:{content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:()=>dn},horizontal_rule:{group:"block",parseDOM:[{tag:"hr"}],toDOM:()=>hn},heading:{attrs:{level:{default:1},align:{default:null}},content:"inline*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM:e=>["h"+e.attrs.level,0]},code_block:{content:"text*",marks:"",group:"block",code:!0,defining:!0,parseDOM:[{tag:"pre",preserveWhitespace:"full"}],toDOM:()=>un},text:{group:"inline"},image:{inline:!0,attrs:{src:{},alt:{default:null},title:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs:e=>({src:e.getAttribute("src"),title:e.getAttribute("title"),alt:e.getAttribute("alt")})}],toDOM(e){let{src:t,alt:n,title:r}=e.attrs;return["img",{src:t,alt:n,title:r}]}},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:()=>fn}}}const gn=["em",0],vn=["strong",0],wn=["code",0],bn={link:{attrs:{href:{},target:{default:"_blank"},type:{default:""}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:e=>({href:e.getAttribute("href"),target:e.getAttribute("target")})}],toDOM(e){let{href:t,target:n}=e.attrs;return["a",{href:t,target:n},0]}},em:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"}],toDOM:()=>gn},strong:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!=e.style.fontWeight&&null},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],toDOM:()=>vn},code:{parseDOM:[{tag:"code"}],toDOM:()=>wn}},yn=new r.Schema({nodes:mn(),marks:bn});function xn(e,t){let n=e.getAttribute("data-colwidth"),r=n&&/^\d+(,\d+)*$/.test(n)?n.split(",").map((e=>Number(e))):null,o=Number(e.getAttribute("colspan")||1),i={colspan:o,rowspan:Number(e.getAttribute("rowspan")||1),colwidth:r&&r.length==o?r:null};for(let n in t){let r=t[n].getFromDOM,o=r&&r(e);null!=o&&(i[n]=o)}return i}function Sn(e,t){let n={};1!=e.attrs.colspan&&(n.colspan=e.attrs.colspan),1!=e.attrs.rowspan&&(n.rowspan=e.attrs.rowspan),e.attrs.colwidth&&(n["data-colwidth"]=e.attrs.colwidth.join(","));for(let r in t){let o=t[r].setDOMAttr;o&&o(e.attrs[r],n)}return n}function Cn(e){let t=e.cellAttributes||{},n={colspan:{default:1},rowspan:{default:1},colwidth:{default:null}};for(let e in t)n[e]={default:t[e].default};return{table:{content:"table_row+",tableRole:"table",isolating:!0,group:e.tableGroup,parseDOM:[{tag:"table"}],toDOM:()=>["table",["tbody",0]]},table_row:{content:"(table_cell | table_header)*",tableRole:"row",parseDOM:[{tag:"tr"}],toDOM:()=>["tr",0]},table_cell:{content:e.cellContent,attrs:n,tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs:e=>xn(e,t)}],toDOM:e=>["td",Sn(e,t),0]},table_header:{content:e.cellContent,attrs:n,tableRole:"header_cell",isolating:!0,parseDOM:[{tag:"th",getAttrs:e=>xn(e,t)}],toDOM:e=>["th",Sn(e,t),0]}}}let kn,Mn;if(new r.Schema({nodes:mn(!0),marks:bn}),"undefined"!=typeof WeakMap){let e=new WeakMap;kn=t=>e.get(t),Mn=(t,n)=>(e.set(t,n),n)}else{let e=[],t=10,n=0;kn=t=>{for(let n=0;n<e.length;n+=2)if(e[n]==t)return e[n+1]},Mn=(r,o)=>(n==t&&(n=0),e[n++]=r,e[n++]=o)}class On{constructor(e,t,n,r){this.left=e,this.top=t,this.right=n,this.bottom=r}}class An{constructor(e,t,n,r){this.width=e,this.height=t,this.map=n,this.problems=r}findCell(e){for(let t=0;t<this.map.length;t++){let n=this.map[t];if(n!=e)continue;let r=t%this.width,o=t/this.width|0,i=r+1,l=o+1;for(let e=1;i<this.width&&this.map[t+e]==n;e++)i++;for(let e=1;l<this.height&&this.map[t+this.width*e]==n;e++)l++;return new On(r,o,i,l)}throw new RangeError("No cell with offset "+e+" found")}colCount(e){for(let t=0;t<this.map.length;t++)if(this.map[t]==e)return t%this.width;throw new RangeError("No cell with offset "+e+" found")}nextCell(e,t,n){let{left:r,right:o,top:i,bottom:l}=this.findCell(e);return"horiz"==t?(n<0?0==r:o==this.width)?null:this.map[i*this.width+(n<0?r-1:o)]:(n<0?0==i:l==this.height)?null:this.map[r+this.width*(n<0?i-1:l)]}rectBetween(e,t){let{left:n,right:r,top:o,bottom:i}=this.findCell(e),{left:l,right:a,top:s,bottom:c}=this.findCell(t);return new On(Math.min(n,l),Math.min(o,s),Math.max(r,a),Math.max(i,c))}cellsInRect(e){let t=[],n={};for(let r=e.top;r<e.bottom;r++)for(let o=e.left;o<e.right;o++){let i=r*this.width+o,l=this.map[i];n[l]||(n[l]=!0,o==e.left&&o&&this.map[i-1]==l||r==e.top&&r&&this.map[i-this.width]==l||t.push(l))}return t}positionAt(e,t,n){for(let r=0,o=0;;r++){let i=o+n.child(r).nodeSize;if(r==e){let n=t+e*this.width,r=(e+1)*this.width;for(;n<r&&this.map[n]<o;)n++;return n==r?i-1:this.map[n]}o=i}}static get(e){return kn(e)||Mn(e,function(e){if("table"!=e.type.spec.tableRole)throw new RangeError("Not a table node: "+e.type.name);let t=function(e){let t=-1,n=!1;for(let r=0;r<e.childCount;r++){let o=e.child(r),i=0;if(n)for(let t=0;t<r;t++){let n=e.child(t);for(let e=0;e<n.childCount;e++){let o=n.child(e);t+o.attrs.rowspan>r&&(i+=o.attrs.colspan)}}for(let e=0;e<o.childCount;e++){let t=o.child(e);i+=t.attrs.colspan,t.attrs.rowspan>1&&(n=!0)}-1==t?t=i:t!=i&&(t=Math.max(t,i))}return t}(e),n=e.childCount,r=[],o=0,i=null,l=[];for(let e=0,o=t*n;e<o;e++)r[e]=0;for(let a=0,s=0;a<n;a++){let c=e.child(a);s++;for(let e=0;;e++){for(;o<r.length&&0!=r[o];)o++;if(e==c.childCount)break;let p=c.child(e),{colspan:d,rowspan:h,colwidth:u}=p.attrs;for(let e=0;e<h;e++){if(e+a>=n){(i||(i=[])).push({type:"overlong_rowspan",pos:s,n:h-e});break}let c=o+e*t;for(let e=0;e<d;e++){0==r[c+e]?r[c+e]=s:(i||(i=[])).push({type:"collision",row:a,pos:s,n:d-e});let n=u&&u[e];if(n){let r=(c+e)%t*2,o=l[r];null==o||o!=n&&1==l[r+1]?(l[r]=n,l[r+1]=1):o==n&&l[r+1]++}}}o+=d,s+=p.nodeSize}let p=(a+1)*t,d=0;for(;o<p;)0==r[o++]&&d++;d&&(i||(i=[])).push({type:"missing",row:a,n:d}),s++}let a=new An(t,n,r,i),s=!1;for(let e=0;!s&&e<l.length;e+=2)null!=l[e]&&l[e+1]<n&&(s=!0);s&&function(e,t,n){e.problems||(e.problems=[]);for(let r=0,o={};r<e.map.length;r++){let i=e.map[r];if(o[i])continue;o[i]=!0;let l=n.nodeAt(i),a=null;for(let n=0;n<l.attrs.colspan;n++){let o=t[2*((r+n)%e.width)];null==o||l.attrs.colwidth&&l.attrs.colwidth[n]==o||((a||(a=Dn(l.attrs)))[n]=o)}a&&e.problems.unshift({type:"colwidth mismatch",pos:i,colwidth:a})}}(a,l,e);return a}(e))}}function Dn(e){if(e.colwidth)return e.colwidth.slice();let t=[];for(let n=0;n<e.colspan;n++)t.push(0);return t}function En(e){let t=e.cached.tableNodeTypes;if(!t){t=e.cached.tableNodeTypes={};for(let n in e.nodes){let r=e.nodes[n],o=r.spec.tableRole;o&&(t[o]=r)}}return t}const $n=new r.PluginKey("selectingCells");function Ln(e){for(let t=e.depth-1;t>0;t--)if("row"==e.node(t).type.spec.tableRole)return e.node(0).resolve(e.before(t+1));return null}function Tn(e){let t=e.selection.$head;for(let e=t.depth;e>0;e--)if("row"==t.node(e).type.spec.tableRole)return!0;return!1}function _n(e){let t=e.selection;return t.$anchorCell?t.$anchorCell.pos>t.$headCell.pos?t.$anchorCell:t.$headCell:t.node&&"cell"==t.node.type.spec.tableRole?t.$anchor:Ln(t.$head)||function(e){for(let t=e.nodeAfter,n=e.pos;t;t=t.firstChild,n++){let r=t.type.spec.tableRole;if("cell"==r||"header_cell"==r)return e.doc.resolve(n)}for(let t=e.nodeBefore,n=e.pos;t;t=t.lastChild,n--){let r=t.type.spec.tableRole;if("cell"==r||"header_cell"==r)return e.doc.resolve(n-t.nodeSize)}}(t.$head)}function Nn(e){return"row"==e.parent.type.spec.tableRole&&e.nodeAfter}function Rn(e,t){return e.depth==t.depth&&e.pos>=t.start(-1)&&e.pos<=t.end(-1)}function Hn(e,t,n){let r=e.start(-1),o=An.get(e.node(-1)).nextCell(e.pos-r,t,n);return null==o?null:e.node(0).resolve(r+o)}function Pn(e,t,n){let r={};for(let t in e)r[t]=e[t];return r[t]=n,r}function Fn(e,t,n=1){let r=Pn(e,"colspan",e.colspan-n);return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(t,n),r.colwidth.some((e=>e>0))||(r.colwidth=null)),r}function zn(e,t,n=1){let r=Pn(e,"colspan",e.colspan+n);if(r.colwidth){r.colwidth=r.colwidth.slice();for(let e=0;e<n;e++)r.colwidth.splice(t,0,0)}return r}class In extends r.Selection{constructor(e,t=e){let n=e.node(-1),o=An.get(n),i=e.start(-1),l=o.rectBetween(e.pos-i,t.pos-i),a=e.node(0),s=o.cellsInRect(l).filter((e=>e!=t.pos-i));s.unshift(t.pos-i);let c=s.map((e=>{let t=n.nodeAt(e),o=e+i+1;return new r.SelectionRange(a.resolve(o),a.resolve(o+t.content.size))}));super(c[0].$from,c[0].$to,c),this.$anchorCell=e,this.$headCell=t}map(e,t){let n=e.resolve(t.map(this.$anchorCell.pos)),o=e.resolve(t.map(this.$headCell.pos));if(Nn(n)&&Nn(o)&&Rn(n,o)){let e=this.$anchorCell.node(-1)!=n.node(-1);return e&&this.isRowSelection()?In.rowSelection(n,o):e&&this.isColSelection()?In.colSelection(n,o):new In(n,o)}return r.TextSelection.between(n,o)}content(){let e=this.$anchorCell.node(-1),t=An.get(e),n=this.$anchorCell.start(-1),o=t.rectBetween(this.$anchorCell.pos-n,this.$headCell.pos-n),i={},l=[];for(let n=o.top;n<o.bottom;n++){let a=[];for(let r=n*t.width+o.left,l=o.left;l<o.right;l++,r++){let n=t.map[r];if(!i[n]){i[n]=!0;let r=t.findCell(n),l=e.nodeAt(n),s=o.left-r.left,c=r.right-o.right;if(s>0||c>0){let e=l.attrs;s>0&&(e=Fn(e,0,s)),c>0&&(e=Fn(e,e.colspan-c,c)),l=r.left<o.left?l.type.createAndFill(e):l.type.create(e,l.content)}if(r.top<o.top||r.bottom>o.bottom){let e=Pn(l.attrs,"rowspan",Math.min(r.bottom,o.bottom)-Math.max(r.top,o.top));l=r.top<o.top?l.type.createAndFill(e):l.type.create(e,l.content)}a.push(l)}}l.push(e.child(n).copy(r.Fragment.from(a)))}const a=this.isColSelection()&&this.isRowSelection()?e:l;return new r.Slice(r.Fragment.from(a),1,1)}replace(e,t=r.Slice.empty){let n=e.steps.length,o=this.ranges;for(let i=0;i<o.length;i++){let{$from:l,$to:a}=o[i],s=e.mapping.slice(n);e.replace(s.map(l.pos),s.map(a.pos),i?r.Slice.empty:t)}let i=r.Selection.findFrom(e.doc.resolve(e.mapping.slice(n).map(this.to)),-1);i&&e.setSelection(i)}replaceWith(e,t){this.replace(e,new r.Slice(r.Fragment.from(t),0,0))}forEachCell(e){let t=this.$anchorCell.node(-1),n=An.get(t),r=this.$anchorCell.start(-1),o=n.cellsInRect(n.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r));for(let n=0;n<o.length;n++)e(t.nodeAt(o[n]),r+o[n])}isColSelection(){let e=this.$anchorCell.index(-1),t=this.$headCell.index(-1);if(Math.min(e,t)>0)return!1;let n=e+this.$anchorCell.nodeAfter.attrs.rowspan,r=t+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(n,r)==this.$headCell.node(-1).childCount}static colSelection(e,t=e){let n=An.get(e.node(-1)),r=e.start(-1),o=n.findCell(e.pos-r),i=n.findCell(t.pos-r),l=e.node(0);return o.top<=i.top?(o.top>0&&(e=l.resolve(r+n.map[o.left])),i.bottom<n.height&&(t=l.resolve(r+n.map[n.width*(n.height-1)+i.right-1]))):(i.top>0&&(t=l.resolve(r+n.map[i.left])),o.bottom<n.height&&(e=l.resolve(r+n.map[n.width*(n.height-1)+o.right-1]))),new In(e,t)}isRowSelection(){let e=An.get(this.$anchorCell.node(-1)),t=this.$anchorCell.start(-1),n=e.colCount(this.$anchorCell.pos-t),r=e.colCount(this.$headCell.pos-t);if(Math.min(n,r)>0)return!1;let o=n+this.$anchorCell.nodeAfter.attrs.colspan,i=r+this.$headCell.nodeAfter.attrs.colspan;return Math.max(o,i)==e.width}eq(e){return e instanceof In&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos}static rowSelection(e,t=e){let n=An.get(e.node(-1)),r=e.start(-1),o=n.findCell(e.pos-r),i=n.findCell(t.pos-r),l=e.node(0);return o.left<=i.left?(o.left>0&&(e=l.resolve(r+n.map[o.top*n.width])),i.right<n.width&&(t=l.resolve(r+n.map[n.width*(i.top+1)-1]))):(i.left>0&&(t=l.resolve(r+n.map[i.top*n.width])),o.right<n.width&&(e=l.resolve(r+n.map[n.width*(o.top+1)-1]))),new In(e,t)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(e,t){return new In(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,n=t){return new In(e.resolve(t),e.resolve(n))}getBookmark(){return new jn(this.$anchorCell.pos,this.$headCell.pos)}}In.prototype.visible=!1,r.Selection.jsonID("cell",In);class jn{constructor(e,t){this.anchor=e,this.head=t}map(e){return new jn(e.map(this.anchor),e.map(this.head))}resolve(e){let t=e.resolve(this.anchor),n=e.resolve(this.head);return"row"==t.parent.type.spec.tableRole&&"row"==n.parent.type.spec.tableRole&&t.index()<t.parent.childCount&&n.index()<n.parent.childCount&&Rn(t,n)?new In(t,n):r.Selection.near(n,1)}}function Bn(e){if(!(e.selection instanceof In))return null;let t=[];return e.selection.forEachCell(((e,n)=>{t.push(r.Decoration.node(n,n+e.nodeSize,{class:"selectedCell"}))})),r.DecorationSet.create(e.doc,t)}function Vn(e){let t,n=e.selection,r=_n(e),o=r.node(-1),i=r.start(-1),l=An.get(o);return t=n instanceof In?l.rectBetween(n.$anchorCell.pos-i,n.$headCell.pos-i):l.findCell(r.pos-i),t.tableStart=i,t.map=l,t.table=o,t}function Wn(e,{map:t,tableStart:n,table:r},o){let i=o>0?-1:0;(function(e,t,n){let r=En(t.type.schema).header_cell;for(let o=0;o<e.height;o++)if(t.nodeAt(e.map[n+o*e.width]).type!=r)return!1;return!0})(t,r,o+i)&&(i=0==o||o==t.width?null:0);for(let l=0;l<t.height;l++){let a=l*t.width+o;if(o>0&&o<t.width&&t.map[a-1]==t.map[a]){let i=t.map[a],s=r.nodeAt(i);e.setNodeMarkup(e.mapping.map(n+i),null,zn(s.attrs,o-t.colCount(i))),l+=s.attrs.rowspan-1}else{let s=null==i?En(r.type.schema).cell:r.nodeAt(t.map[a+i]).type,c=t.positionAt(l,o,r);e.insert(e.mapping.map(n+c),s.createAndFill())}}return e}function Un(e,t){if(!Tn(e))return!1;if(t){let n=Vn(e);t(Wn(e.tr,n,n.left))}return!0}function qn(e,t){if(!Tn(e))return!1;if(t){let n=Vn(e);t(Wn(e.tr,n,n.right))}return!0}function Gn(e,{map:t,table:n,tableStart:r},o){let i=e.mapping.maps.length;for(let l=0;l<t.height;){let a=l*t.width+o,s=t.map[a],c=n.nodeAt(s);if(o>0&&t.map[a-1]==s||o<t.width-1&&t.map[a+1]==s)e.setNodeMarkup(e.mapping.slice(i).map(r+s),null,Fn(c.attrs,o-t.colCount(s)));else{let t=e.mapping.slice(i).map(r+s);e.delete(t,t+c.nodeSize)}l+=c.attrs.rowspan}}function Xn(e,t){if(!Tn(e))return!1;if(t){let n=Vn(e),r=e.tr;if(0==n.left&&n.right==n.map.width)return!1;for(let e=n.right-1;Gn(r,n,e),e!=n.left;e--)n.table=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc,n.map=An.get(n.table);t(r)}return!0}function Kn(e,{map:t,tableStart:n,table:r},o){let i=n;for(let e=0;e<o;e++)i+=r.child(e).nodeSize;let l=[],a=o>0?-1:0;(function(e,t,n){let r=En(t.type.schema).header_cell;for(let o=0;o<e.width;o++)if(t.nodeAt(e.map[o+n*e.width]).type!=r)return!1;return!0})(t,r,o+a)&&(a=0==o||o==t.height?null:0);for(let i=0,s=t.width*o;i<t.width;i++,s++)if(o>0&&o<t.height&&t.map[s]==t.map[s-t.width]){let o=t.map[s],l=r.nodeAt(o).attrs;e.setNodeMarkup(n+o,null,Pn(l,"rowspan",l.rowspan+1)),i+=l.colspan-1}else{let e=null==a?En(r.type.schema).cell:r.nodeAt(t.map[s+a*t.width]).type;l.push(e.createAndFill())}return e.insert(i,En(r.type.schema).row.create(null,l)),e}function Jn(e,t){if(!Tn(e))return!1;if(t){let n=Vn(e);t(Kn(e.tr,n,n.top))}return!0}function Yn(e,t){if(!Tn(e))return!1;if(t){let n=Vn(e);t(Kn(e.tr,n,n.bottom))}return!0}function Qn(e,{map:t,table:n,tableStart:r},o){let i=0;for(let e=0;e<o;e++)i+=n.child(e).nodeSize;let l=i+n.child(o).nodeSize,a=e.mapping.maps.length;e.delete(i+r,l+r);for(let i=0,l=o*t.width;i<t.width;i++,l++){let s=t.map[l];if(o>0&&s==t.map[l-t.width]){let t=n.nodeAt(s).attrs;e.setNodeMarkup(e.mapping.slice(a).map(s+r),null,Pn(t,"rowspan",t.rowspan-1)),i+=t.colspan-1}else if(o<t.width&&s==t.map[l+t.width]){let l=n.nodeAt(s),c=l.type.create(Pn(l.attrs,"rowspan",l.attrs.rowspan-1),l.content),p=t.positionAt(o+1,i,n);e.insert(e.mapping.slice(a).map(r+p),c),i+=l.attrs.colspan-1}}}function Zn(e,t){if(!Tn(e))return!1;if(t){let n=Vn(e),r=e.tr;if(0==n.top&&n.bottom==n.map.height)return!1;for(let e=n.bottom-1;Qn(r,n,e),e!=n.top;e--)n.table=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc,n.map=An.get(n.table);t(r)}return!0}function er(e){let t=e.content;return 1==t.childCount&&t.firstChild.isTextblock&&0==t.firstChild.childCount}function tr(e,t){let n=e.selection;if(!(n instanceof In)||n.$anchorCell.pos==n.$headCell.pos)return!1;let o=Vn(e),{map:i}=o;if(function({width:e,height:t,map:n},r){let o=r.top*e+r.left,i=o,l=(r.bottom-1)*e+r.left,a=o+(r.right-r.left-1);for(let t=r.top;t<r.bottom;t++){if(r.left>0&&n[i]==n[i-1]||r.right<e&&n[a]==n[a+1])return!0;i+=e,a+=e}for(let i=r.left;i<r.right;i++){if(r.top>0&&n[o]==n[o-e]||r.bottom<t&&n[l]==n[l+e])return!0;o++,l++}return!1}(i,o))return!1;if(t){let n,l,a=e.tr,s={},c=r.Fragment.empty;for(let e=o.top;e<o.bottom;e++)for(let t=o.left;t<o.right;t++){let r=i.map[e*i.width+t],p=o.table.nodeAt(r);if(!s[r])if(s[r]=!0,null==n)n=r,l=p;else{er(p)||(c=c.append(p.content));let e=a.mapping.map(r+o.tableStart);a.delete(e,e+p.nodeSize)}}if(a.setNodeMarkup(n+o.tableStart,null,Pn(zn(l.attrs,l.attrs.colspan,o.right-o.left-l.attrs.colspan),"rowspan",o.bottom-o.top)),c.size){let e=n+1+l.content.size,t=er(l)?n+1:e;a.replaceWith(t+o.tableStart,e+o.tableStart,c)}a.setSelection(new In(a.doc.resolve(n+o.tableStart))),t(a)}return!0}function nr(e,t){const n=En(e.schema);return(r=({node:e})=>n[e.type.spec.tableRole],(e,t)=>{let n,o,i=e.selection;if(i instanceof In){if(i.$anchorCell.pos!=i.$headCell.pos)return!1;n=i.$anchorCell.nodeAfter,o=i.$anchorCell.pos}else{if(n=function(e){for(let t=e.depth;t>0;t--){const n=e.node(t).type.spec.tableRole;if("cell"===n||"header_cell"===n)return e.node(t)}return null}(i.$from),!n)return!1;o=Ln(i.$from).pos}if(1==n.attrs.colspan&&1==n.attrs.rowspan)return!1;if(t){let l=n.attrs,a=[],s=l.colwidth;l.rowspan>1&&(l=Pn(l,"rowspan",1)),l.colspan>1&&(l=Pn(l,"colspan",1));let c,p=Vn(e),d=e.tr;for(let e=0;e<p.right-p.left;e++)a.push(s?Pn(l,"colwidth",s&&s[e]?[s[e]]:null):l);for(let e=p.top;e<p.bottom;e++){let t=p.map.positionAt(e,p.left,p.table);e==p.top&&(t+=n.nodeSize);for(let o=p.left,i=0;o<p.right;o++,i++)o==p.left&&e==p.top||d.insert(c=d.mapping.map(t+p.tableStart,1),r({node:n,row:e,col:o}).createAndFill(a[i]))}d.setNodeMarkup(o,r({node:n,row:p.top,col:p.left}),a[0]),i instanceof In&&d.setSelection(new In(d.doc.resolve(i.$anchorCell.pos),c&&d.doc.resolve(c))),t(d)}return!0})(e,t);var r}function rr(e,t,n){const r=t.map.cellsInRect({left:0,top:0,right:"row"==e?t.map.width:1,bottom:"column"==e?t.map.height:1});for(let e=0;e<r.length;e++){const o=t.table.nodeAt(r[e]);if(o&&o.type!==n.header_cell)return!1}return!0}function or(e,t){return(t=t||{useDeprecatedLogic:!1}).useDeprecatedLogic?function(e){return function(t,n){if(!Tn(t))return!1;if(n){let r=En(t.schema),o=Vn(t),i=t.tr,l=o.map.cellsInRect("column"==e?new On(o.left,0,o.right,o.map.height):"row"==e?new On(0,o.top,o.map.width,o.bottom):o),a=l.map((e=>o.table.nodeAt(e)));for(let e=0;e<l.length;e++)a[e].type==r.header_cell&&i.setNodeMarkup(o.tableStart+l[e],r.cell,a[e].attrs);if(0==i.steps.length)for(let e=0;e<l.length;e++)i.setNodeMarkup(o.tableStart+l[e],r.header_cell,a[e].attrs);n(i)}return!0}}(e):function(t,n){if(!Tn(t))return!1;if(n){let r=En(t.schema),o=Vn(t),i=t.tr,l=rr("row",o,r),a=rr("column",o,r),s=("column"===e?l:"row"===e&&a)?1:0,c="column"==e?new On(0,s,1,o.map.height):"row"==e?new On(s,0,o.map.width,1):o,p="column"==e?a?r.cell:r.header_cell:"row"==e?l?r.cell:r.header_cell:r.cell;o.map.cellsInRect(c).forEach((e=>{const t=e+o.tableStart,n=i.doc.nodeAt(t);n&&i.setNodeMarkup(t,p,n.attrs)})),n(i)}return!0}}function ir(e){return function(t,n){if(!Tn(t))return!1;let o=function(e,t){if(t<0){let t=e.nodeBefore;if(t)return e.pos-t.nodeSize;for(let t=e.index(-1)-1,n=e.before();t>=0;t--){let r=e.node(-1).child(t);if(r.childCount)return n-1-r.lastChild.nodeSize;n-=r.nodeSize}}else{if(e.index()<e.parent.childCount-1)return e.pos+e.nodeAfter.nodeSize;let t=e.node(-1);for(let n=e.indexAfter(-1),r=e.after();n<t.childCount;n++){let e=t.child(n);if(e.childCount)return r+1;r+=e.nodeSize}}}(_n(t),e);if(null!=o){if(n){let e=t.doc.resolve(o);n(t.tr.setSelection(r.TextSelection.between(e,(i=e,i.node(0).resolve(i.pos+i.nodeAfter.nodeSize)))).scrollIntoView())}var i;return!0}}}function lr(e,t){let n=e.selection.$anchor;for(let r=n.depth;r>0;r--){if("table"==n.node(r).type.spec.tableRole)return t&&t(e.tr.delete(n.before(r),n.after(r)).scrollIntoView()),!0}return!1}or("row",{useDeprecatedLogic:!0}),or("column",{useDeprecatedLogic:!0}),or("cell",{useDeprecatedLogic:!0});class ar{constructor(e,t,n){this.node=e,this.cellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),sr(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type==this.node.type&&(this.node=e,sr(e,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(e){return"attributes"==e.type&&(e.target==this.table||this.colgroup.contains(e.target))}}function sr(e,t,n,r,o=void 0,i=void 0){let l=0,a=!0,s=t.firstChild,c=e.firstChild;for(let e=0,n=0;e<c.childCount;e++){let{colspan:p,colwidth:d}=c.child(e).attrs;for(let e=0;e<p;e++,n++){let c=o==n?i:d&&d[e],p=c?c+"px":"";l+=c||r,c||(a=!1),s?(s.style.width!=p&&(s.style.width=p),s=s.nextSibling):t.appendChild(document.createElement("col")).style.width=p}}for(;s;){let e=s.nextSibling;s.parentNode.removeChild(s),s=e}a?(n.style.width=l+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=l+"px")}const cr=new r.PluginKey("tableColumnResizing");function pr({handleWidth:e=5,cellMinWidth:t=25,View:n=ar,lastColumnResizable:o=!0}={}){let i=new r.Plugin({key:cr,state:{init(e,r){return this.spec.props.nodeViews[En(r.schema).table.name]=(e,r)=>new n(e,t,r),new dr(-1,!1)},apply:(e,t)=>t.apply(e)},props:{attributes:e=>cr.getState(e).activeHandle>-1?{class:"resize-cursor"}:null,handleDOMEvents:{mousemove(t,n){!function(e,t,n,r,o){let i=cr.getState(e.state);if(!i.dragging){let r=function(e){for(;e&&"TD"!=e.nodeName&&"TH"!=e.nodeName;)e=e.classList.contains("ProseMirror")?null:e.parentNode;return e}(t.target),l=-1;if(r){let{left:o,right:i}=r.getBoundingClientRect();t.clientX-o<=n?l=hr(e,t,"left"):i-t.clientX<=n&&(l=hr(e,t,"right"))}if(l!=i.activeHandle){if(!o&&-1!==l){let t=e.state.doc.resolve(l),n=t.node(-1),r=An.get(n),o=t.start(-1);if(r.colCount(t.pos-o)+t.nodeAfter.attrs.colspan-1==r.width-1)return}fr(e,l)}}}(t,n,e,0,o)},mouseleave(e){!function(e){let t=cr.getState(e.state);t.activeHandle>-1&&!t.dragging&&fr(e,-1)}(e)},mousedown(e,n){!function(e,t,n){let r=cr.getState(e.state);if(-1==r.activeHandle||r.dragging)return!1;let o=e.state.doc.nodeAt(r.activeHandle),i=function(e,t,{colspan:n,colwidth:r}){let o=r&&r[r.length-1];if(o)return o;let i=e.domAtPos(t),l=i.node.childNodes[i.offset].offsetWidth,a=n;if(r)for(let e=0;e<n;e++)r[e]&&(l-=r[e],a--);return l/a}(e,r.activeHandle,o.attrs);function l(t){window.removeEventListener("mouseup",l),window.removeEventListener("mousemove",a);let r=cr.getState(e.state);r.dragging&&(!function(e,t,n){let r=e.state.doc.resolve(t),o=r.node(-1),i=An.get(o),l=r.start(-1),a=i.colCount(r.pos-l)+r.nodeAfter.attrs.colspan-1,s=e.state.tr;for(let e=0;e<i.height;e++){let t=e*i.width+a;if(e&&i.map[t]==i.map[t-i.width])continue;let r=i.map[t],{attrs:c}=o.nodeAt(r),p=1==c.colspan?0:a-i.colCount(r);if(c.colwidth&&c.colwidth[p]==n)continue;let d=c.colwidth?c.colwidth.slice():mr(c.colspan);d[p]=n,s.setNodeMarkup(l+r,null,Pn(c,"colwidth",d))}s.docChanged&&e.dispatch(s)}(e,r.activeHandle,ur(r.dragging,t,n)),e.dispatch(e.state.tr.setMeta(cr,{setDragging:null})))}function a(t){if(!t.which)return l(t);let r=cr.getState(e.state),o=ur(r.dragging,t,n);!function(e,t,n,r){let o=e.state.doc.resolve(t),i=o.node(-1),l=o.start(-1),a=An.get(i).colCount(o.pos-l)+o.nodeAfter.attrs.colspan-1,s=e.domAtPos(o.start(-1)).node;for(;"TABLE"!=s.nodeName;)s=s.parentNode;sr(i,s.firstChild,s,r,a,n)}(e,r.activeHandle,o,n)}e.dispatch(e.state.tr.setMeta(cr,{setDragging:{startX:t.clientX,startWidth:i}})),window.addEventListener("mouseup",l),window.addEventListener("mousemove",a),t.preventDefault()}(e,n,t)}},decorations(e){let t=cr.getState(e);if(t.activeHandle>-1)return function(e,t){let n=[],o=e.doc.resolve(t),i=o.node(-1),l=An.get(i),a=o.start(-1),s=l.colCount(o.pos-a)+o.nodeAfter.attrs.colspan;for(let e=0;e<l.height;e++){let t=s+e*l.width-1;if(!(s!=l.width&&l.map[t]==l.map[t+1]||0!=e&&l.map[t-1]==l.map[t-1-l.width])){let e=l.map[t],o=a+e+i.nodeAt(e).nodeSize-1,s=document.createElement("div");s.className="column-resize-handle",n.push(r.Decoration.widget(o,s))}}return r.DecorationSet.create(e.doc,n)}(e,t.activeHandle)},nodeViews:{}}});return i}class dr{constructor(e,t){this.activeHandle=e,this.dragging=t}apply(e){let t=this,n=e.getMeta(cr);if(n&&null!=n.setHandle)return new dr(n.setHandle,null);if(n&&void 0!==n.setDragging)return new dr(t.activeHandle,n.setDragging);if(t.activeHandle>-1&&e.docChanged){let n=e.mapping.map(t.activeHandle,-1);Nn(e.doc.resolve(n))||(n=null),t=new dr(n,t.dragging)}return t}}function hr(e,t,n){let r=e.posAtCoords({left:t.clientX,top:t.clientY});if(!r)return-1;let{pos:o}=r,i=Ln(e.state.doc.resolve(o));if(!i)return-1;if("right"==n)return i.pos;let l=An.get(i.node(-1)),a=i.start(-1),s=l.map.indexOf(i.pos-a);return s%l.width==0?-1:a+l.map[s-1]}function ur(e,t,n){let r=t.clientX-e.startX;return Math.max(n,e.startWidth+r)}function fr(e,t){e.dispatch(e.state.tr.setMeta(cr,{setHandle:t}))}function mr(e){let t=[];for(let n=0;n<e;n++)t.push(0);return t}function gr(e){if(!e.size)return null;let{content:t,openStart:n,openEnd:o}=e;for(;1==t.childCount&&(n>0&&o>0||"table"==t.firstChild.type.spec.tableRole);)n--,o--,t=t.firstChild.content;let i=t.firstChild,l=i.type.spec.tableRole,a=i.type.schema,s=[];if("row"==l)for(let e=0;e<t.childCount;e++){let i=t.child(e).content,l=e?0:Math.max(0,n-1),c=e<t.childCount-1?0:Math.max(0,o-1);(l||c)&&(i=vr(En(a).row,new r.Slice(i,l,c)).content),s.push(i)}else{if("cell"!=l&&"header_cell"!=l)return null;s.push(n||o?vr(En(a).row,new r.Slice(t,n,o)).content:t)}return function(e,t){let n=[];for(let e=0;e<t.length;e++){let r=t[e];for(let t=r.childCount-1;t>=0;t--){let{rowspan:o,colspan:i}=r.child(t).attrs;for(let t=e;t<e+o;t++)n[t]=(n[t]||0)+i}}let o=0;for(let e=0;e<n.length;e++)o=Math.max(o,n[e]);for(let i=0;i<n.length;i++)if(i>=t.length&&t.push(r.Fragment.empty),n[i]<o){let l=En(e).cell.createAndFill(),a=[];for(let e=n[i];e<o;e++)a.push(l);t[i]=t[i].append(r.Fragment.from(a))}return{height:t.length,width:o,rows:t}}(a,s)}function vr(e,t){let n=e.createAndFill();return new r.Transform(n).replace(0,n.content.size,t).doc}function wr(e,t,n,r,o,i,l,a){if(0==l||l==t.height)return!1;let s=!1;for(let c=o;c<i;c++){let o=l*t.width+c,i=t.map[o];if(t.map[o-t.width]==i){s=!0;let o=n.nodeAt(i),{top:p,left:d}=t.findCell(i);e.setNodeMarkup(e.mapping.slice(a).map(i+r),null,Pn(o.attrs,"rowspan",l-p)),e.insert(e.mapping.slice(a).map(t.positionAt(l,d,n)),o.type.createAndFill(Pn(o.attrs,"rowspan",p+o.attrs.rowspan-l))),c+=o.attrs.colspan-1}}return s}function br(e,t,n,r,o,i,l,a){if(0==l||l==t.width)return!1;let s=!1;for(let c=o;c<i;c++){let o=c*t.width+l,i=t.map[o];if(t.map[o-1]==i){s=!0;let o=n.nodeAt(i),p=t.colCount(i),d=e.mapping.slice(a).map(i+r);e.setNodeMarkup(d,null,Fn(o.attrs,l-p,o.attrs.colspan-(l-p))),e.insert(d+o.nodeSize,o.type.createAndFill(Fn(o.attrs,0,l-p))),c+=o.attrs.rowspan-1}}return s}function yr(e,t,n,o,i){let l=n?e.doc.nodeAt(n-1):e.doc,a=An.get(l),{top:s,left:c}=o,p=c+i.width,d=s+i.height,h=e.tr,u=0;function f(){l=n?h.doc.nodeAt(n-1):h.doc,a=An.get(l),u=h.mapping.maps.length}(function(e,t,n,o,i,l,a){let s,c,p=En(e.doc.type.schema);if(i>t.width)for(let r=0,l=0;r<t.height;r++){let d=n.child(r);l+=d.nodeSize;let h,u=[];h=null==d.lastChild||d.lastChild.type==p.cell?s||(s=p.cell.createAndFill()):c||(c=p.header_cell.createAndFill());for(let e=t.width;e<i;e++)u.push(h);e.insert(e.mapping.slice(a).map(l-1+o),u)}if(l>t.height){let d=[];for(let e=0,r=(t.height-1)*t.width;e<Math.max(t.width,i);e++){let o=!(e>=t.width)&&n.nodeAt(t.map[r+e]).type==p.header_cell;d.push(o?c||(c=p.header_cell.createAndFill()):s||(s=p.cell.createAndFill()))}let h=p.row.create(null,r.Fragment.from(d)),u=[];for(let e=t.height;e<l;e++)u.push(h);e.insert(e.mapping.slice(a).map(o+n.nodeSize-2),u)}return!(!s&&!c)})(h,a,l,n,p,d,u)&&f(),wr(h,a,l,n,c,p,s,u)&&f(),wr(h,a,l,n,c,p,d,u)&&f(),br(h,a,l,n,s,d,c,u)&&f(),br(h,a,l,n,s,d,p,u)&&f();for(let e=s;e<d;e++){let t=a.positionAt(e,c,l),o=a.positionAt(e,p,l);h.replace(h.mapping.slice(u).map(t+n),h.mapping.slice(u).map(o+n),new r.Slice(i.rows[e-s],0,0))}f(),h.setSelection(new In(h.doc.resolve(n+a.positionAt(s,c,l)),h.doc.resolve(n+a.positionAt(d-1,p-1,l)))),t(h)}const xr=r.keydownHandler({ArrowLeft:Cr("horiz",-1),ArrowRight:Cr("horiz",1),ArrowUp:Cr("vert",-1),ArrowDown:Cr("vert",1),"Shift-ArrowLeft":kr("horiz",-1),"Shift-ArrowRight":kr("horiz",1),"Shift-ArrowUp":kr("vert",-1),"Shift-ArrowDown":kr("vert",1),Backspace:Mr,"Mod-Backspace":Mr,Delete:Mr,"Mod-Delete":Mr});function Sr(e,t,n){return!n.eq(e.selection)&&(t&&t(e.tr.setSelection(n).scrollIntoView()),!0)}function Cr(e,t){return(n,o,i)=>{let l=n.selection;if(l instanceof In)return Sr(n,o,r.Selection.near(l.$headCell,t));if("horiz"!=e&&!l.empty)return!1;let a=Er(i,e,t);if(null==a)return!1;if("horiz"==e)return Sr(n,o,r.Selection.near(n.doc.resolve(l.head+t),t));{let i,l=n.doc.resolve(a),s=Hn(l,e,t);return i=s?r.Selection.near(s,1):t<0?r.Selection.near(n.doc.resolve(l.before(-1)),-1):r.Selection.near(n.doc.resolve(l.after(-1)),1),Sr(n,o,i)}}}function kr(e,t){return(n,r,o)=>{let i=n.selection;if(!(i instanceof In)){let r=Er(o,e,t);if(null==r)return!1;i=new In(n.doc.resolve(r))}let l=Hn(i.$headCell,e,t);return!!l&&Sr(n,r,new In(i.$anchorCell,l))}}function Mr(e,t){let n=e.selection;if(!(n instanceof In))return!1;if(t){let o=e.tr,i=En(e.schema).cell.createAndFill().content;n.forEachCell(((e,t)=>{e.content.eq(i)||o.replace(o.mapping.map(t+1),o.mapping.map(t+e.nodeSize-1),new r.Slice(i,0,0))})),o.docChanged&&t(o)}return!0}function Or(e,t){let n=Ln(e.state.doc.resolve(t));return!!n&&(e.dispatch(e.state.tr.setSelection(new In(n))),!0)}function Ar(e,t,n){if(!Tn(e.state))return!1;let o=gr(n),i=e.state.selection;if(i instanceof In){o||(o={width:1,height:1,rows:[r.Fragment.from(vr(En(e.state.schema).cell,n))]});let t=i.$anchorCell.node(-1),l=i.$anchorCell.start(-1),a=An.get(t).rectBetween(i.$anchorCell.pos-l,i.$headCell.pos-l);return o=function({width:e,height:t,rows:n},o,i){if(e!=o){let t=[],i=[];for(let e=0;e<n.length;e++){let l=n[e],a=[];for(let n=t[e]||0,r=0;n<o;r++){let i=l.child(r%l.childCount);n+i.attrs.colspan>o&&(i=i.type.create(Fn(i.attrs,i.attrs.colspan,n+i.attrs.colspan-o),i.content)),a.push(i),n+=i.attrs.colspan;for(let n=1;n<i.attrs.rowspan;n++)t[e+n]=(t[e+n]||0)+i.attrs.colspan}i.push(r.Fragment.from(a))}n=i,e=o}if(t!=i){let e=[];for(let o=0,l=0;o<i;o++,l++){let a=[],s=n[l%t];for(let e=0;e<s.childCount;e++){let t=s.child(e);o+t.attrs.rowspan>i&&(t=t.type.create(Pn(t.attrs,"rowspan",Math.max(1,i-t.attrs.rowspan)),t.content)),a.push(t)}e.push(r.Fragment.from(a))}n=e,t=i}return{width:e,height:t,rows:n}}(o,a.right-a.left,a.bottom-a.top),yr(e.state,e.dispatch,l,a,o),!0}if(o){let t=_n(e.state),n=t.start(-1);return yr(e.state,e.dispatch,n,An.get(t.node(-1)).findCell(t.pos-n),o),!0}return!1}function Dr(e,t){if(t.ctrlKey||t.metaKey)return;let n,r=$r(e,t.target);if(t.shiftKey&&e.state.selection instanceof In)o(e.state.selection.$anchorCell,t),t.preventDefault();else if(t.shiftKey&&r&&null!=(n=Ln(e.state.selection.$anchor))&&Lr(e,t).pos!=n.pos)o(n,t),t.preventDefault();else if(!r)return;function o(t,n){let r=Lr(e,n),o=null==$n.getState(e.state);if(!r||!Rn(t,r)){if(!o)return;r=t}let i=new In(t,r);if(o||!e.state.selection.eq(i)){let n=e.state.tr.setSelection(i);o&&n.setMeta($n,t.pos),e.dispatch(n)}}function i(){e.root.removeEventListener("mouseup",i),e.root.removeEventListener("dragstart",i),e.root.removeEventListener("mousemove",l),null!=$n.getState(e.state)&&e.dispatch(e.state.tr.setMeta($n,-1))}function l(n){let l,a=$n.getState(e.state);if(null!=a)l=e.state.doc.resolve(a);else if($r(e,n.target)!=r&&(l=Lr(e,t),!l))return i();l&&o(l,n)}e.root.addEventListener("mouseup",i),e.root.addEventListener("dragstart",i),e.root.addEventListener("mousemove",l)}function Er(e,t,n){if(!(e.state.selection instanceof r.TextSelection))return null;let{$head:o}=e.state.selection;for(let r=o.depth-1;r>=0;r--){let i=o.node(r);if((n<0?o.index(r):o.indexAfter(r))!=(n<0?0:i.childCount))return null;if("cell"==i.type.spec.tableRole||"header_cell"==i.type.spec.tableRole){let i=o.before(r),l="vert"==t?n>0?"down":"up":n>0?"right":"left";return e.endOfTextblock(l)?i:null}}return null}function $r(e,t){for(;t&&t!=e.dom;t=t.parentNode)if("TD"==t.nodeName||"TH"==t.nodeName)return t}function Lr(e,t){let n=e.posAtCoords({left:t.clientX,top:t.clientY});return n&&n?Ln(e.state.doc.resolve(n.pos)):null}const Tr=new r.PluginKey("fix-tables");function _r(e,t,n,r){let o=e.childCount,i=t.childCount;e:for(let l=0,a=0;l<i;l++){let i=t.child(l);for(let t=a,r=Math.min(o,l+3);t<r;t++)if(e.child(t)==i){a=t+1,n+=i.nodeSize;continue e}r(i,n),a<o&&e.child(a).sameMarkup(i)?_r(e.child(a),i,n+1,r):i.nodesBetween(0,i.content.size,r,n+1),n+=i.nodeSize}}function Nr(e,t){let n,r=(t,r)=>{"table"==t.type.spec.tableRole&&(n=function(e,t,n,r){let o=An.get(t);if(!o.problems)return r;r||(r=e.tr);let i,l,a=[];for(let e=0;e<o.height;e++)a.push(0);for(let e=0;e<o.problems.length;e++){let i=o.problems[e];if("collision"==i.type){let e=t.nodeAt(i.pos);for(let t=0;t<e.attrs.rowspan;t++)a[i.row+t]+=i.n;r.setNodeMarkup(r.mapping.map(n+1+i.pos),null,Fn(e.attrs,e.attrs.colspan-i.n,i.n))}else if("missing"==i.type)a[i.row]+=i.n;else if("overlong_rowspan"==i.type){let e=t.nodeAt(i.pos);r.setNodeMarkup(r.mapping.map(n+1+i.pos),null,Pn(e.attrs,"rowspan",e.attrs.rowspan-i.n))}else if("colwidth mismatch"==i.type){let e=t.nodeAt(i.pos);r.setNodeMarkup(r.mapping.map(n+1+i.pos),null,Pn(e.attrs,"colwidth",i.colwidth))}}for(let e=0;e<a.length;e++)a[e]&&(null==i&&(i=e),l=e);for(let s=0,c=n+1;s<o.height;s++){let n=t.child(s),o=c+n.nodeSize,p=a[s];if(p>0){let t="cell";n.firstChild&&(t=n.firstChild.type.spec.tableRole);let a=[];for(let n=0;n<p;n++)a.push(En(e.schema)[t].createAndFill());let d=0!=s&&i!=s-1||l!=s?o-1:c+1;r.insert(r.mapping.map(d),a)}c=o}return r.setMeta(Tr,{fixTables:!0})}(e,t,r,n))};return t?t.doc!=e.doc&&_r(t.doc,e.doc,0,r):e.doc.descendants(r),n}function Rr({allowTableNodeSelection:e=!1}={}){return new r.Plugin({key:$n,state:{init:()=>null,apply(e,t){let n=e.getMeta($n);if(null!=n)return-1==n?null:n;if(null==t||!e.docChanged)return t;let{deleted:r,pos:o}=e.mapping.mapResult(t);return r?null:o}},props:{decorations:Bn,handleDOMEvents:{mousedown:Dr},createSelectionBetween(e){if(null!=$n.getState(e.state))return e.state.selection},handleTripleClick:Or,handleKeyDown:xr,handlePaste:Ar},appendTransaction:(t,n,o)=>function(e,t,n){let o,i,l=(t||e).selection,a=(t||e).doc;if(l instanceof r.NodeSelection&&(i=l.node.type.spec.tableRole)){if("cell"==i||"header_cell"==i)o=In.create(a,l.from);else if("row"==i){let e=a.resolve(l.from+1);o=In.rowSelection(e,e)}else if(!n){let e=An.get(l.node),t=l.from+1,n=t+e.map[e.width*e.height-1];o=In.create(a,t+1,n)}}else l instanceof r.TextSelection&&function({$from:e,$to:t}){if(e.pos==t.pos||e.pos<e.pos-6)return!1;let n=e.pos,r=t.pos,o=e.depth;for(;o>=0&&!(e.after(o+1)<e.end(o));o--,n++);for(let e=t.depth;e>=0&&!(t.before(e+1)>t.start(e));e--,r--);return n==r&&/row|table/.test(e.node(o).type.spec.tableRole)}(l)?o=r.TextSelection.create(a,l.from):l instanceof r.TextSelection&&function({$from:e,$to:t}){let n,r;for(let t=e.depth;t>0;t--){let r=e.node(t);if("cell"===r.type.spec.tableRole||"header_cell"===r.type.spec.tableRole){n=r;break}}for(let e=t.depth;e>0;e--){let n=t.node(e);if("cell"===n.type.spec.tableRole||"header_cell"===n.type.spec.tableRole){r=n;break}}return n!==r&&0===t.parentOffset}(l)&&(o=r.TextSelection.create(a,l.$from.start(),l.$from.end()));return o&&(t||(t=e.tr)).setSelection(o),t}(o,Nr(o,n),e)})}var Hr,Pr,Fr,zr,Ir,jr={color:{attrs:{color:{default:""}},parseDOM:[{consuming:!1,tag:"span",getAttrs:e=>({color:e.style.color})}],toDOM:e=>["span",{style:"color:"+e.attrs.color},0]}},Br={fontsize:{attrs:{size:{default:""}},parseDOM:[{consuming:!1,tag:"span",getAttrs:e=>({size:e.style.fontSize})}],toDOM:e=>["span",{style:"font-size:"+e.attrs.size},0]}},Vr={fontfamily:{attrs:{name:{default:""}},parseDOM:[{tag:"span",getAttrs:e=>({name:e.style.fontfamily})}],toDOM:e=>["span",{style:"font-family:"+e.attrs.name},0]}};function Wr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ur(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wr(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}new r.Schema({nodes:r.addListNodes(yn.spec.nodes,"paragraph block*","block"),marks:Ur({},bn,{},jr,{},Br)});let qr=(Hr=t.customElement("rn-text-editor"),Pr=t.query(".editor"),Hr((zr=class extends e.LitElementBase{constructor(...e){super(...e),babelHelpers.initializerDefineProperty(this,"Editor",Ir,this),this.View=null,this.LatestValue=null,this.nodes=[],this.LinkTypes=[],this.AllowFontFamily=!1}static get properties(){return{value:{type:Object}}}render(){return null==this.LatestValue&&(this.LatestValue=this.value),n.html` <div class="editor" style="min-height: inherit"> </div> `}update(e){if(this.LatestValue!=this.value)if(null!=this.View){let e=this.CreateState();this.View.updateState(e)}else this.LatestValue=this.value;super.update(e)}CreateState(){let e=tn(this.Schema,{LinkTypes:this.LinkTypes,AllowFontFamily:this.AllowFontFamily}).fullMenu;function t(e,t){return new St({label:e,select:t,run:t})}let n=[t("Insert column before",Un),t("Insert column after",qn),t("Delete column",Xn),t("Insert row before",Jn),t("Insert row after",Yn),t("Delete row",Zn),t("Delete table",lr),t("Merge cells",tr),t("Split cell",nr)];e.splice(2,0,[new mt(n,{label:"Table"},!0)]);let o=[];for(let e of this.nodes){let t=e.GetMenuItems();t.length>0&&t.forEach((e=>o.push(e)))}o.length>0&&e.push(o);let i=r.EditorState.create({doc:null==this.value||""==this.value?r.DOMParser.fromSchema(this.Schema).parse(""):this.Schema.nodeFromJSON(this.value),plugins:[...cn({schema:this.Schema,menuContent:e}),pr(),Rr(),r.keymap({Tab:ir(1),"Shift-Tab":ir(-1)})]}),l=Nr(i,void 0);return l&&(i=i.apply(l.setMeta("addToHistory",!1))),i}get Schema(){if(null==this._schema){var e;let t={};null===(e=this.nodes)||void 0===e||e.forEach((e=>{t=Ur({},t,{},e.GetNodes())}));const n=new r.Schema({nodes:r.addListNodes(yn.spec.nodes.append(Cn({tableGroup:"block",cellContent:"block+",cellAttributes:{background:{default:null,getFromDOM:e=>e.style.backgroundColor||null,setDOMAttr(e,t){e&&(t.style=(t.style||"")+`background-color: ${e};`)}}}})).append(t),"paragraph block*","block"),marks:Ur({},bn,{},jr,{},Br,{},this.AllowFontFamily?Vr:{})});this._schema=n}return this._schema}firstUpdated(e){super.firstUpdated(e);let t=this.CreateState();this.View=new r.EditorView(this.Editor,{dispatchTransaction:e=>{const t=this.View.state.apply(e);this.View.updateState(t);let n=t.toJSON().doc;1==n.content.length&&"paragraph"==n.content[0].type&&null==n.content[0].content&&(n=null),this.LatestValue=n,this.FireEvent("change",n)},state:t}),this.FireEvent("Inititialized",null,!1)}},Ir=babelHelpers.applyDecoratedDescriptor(zr.prototype,"Editor",[Pr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fr=zr))||Fr);t.customElement("rn-te-link-dialog")(class extends s.DialogBase{constructor(...e){super(...e),this.linkTypes=[],this.Target="_blank",this.LinkURL="",this.Type=""}static get properties(){return{Target:{type:String},LinkURL:{type:String},applyIsBusy:{type:Boolean}}}InternalGetOptions(){return{Title:"Link Options",ShowCloseButton:!1,ShowApplyButton:!0,Styles:{maxWidth:"80%",width:"400px"}}}SubRender(){return n.html` <table style="width: 100%;" class="linkDialog"> <tr> <td> <label style="font-weight: bold;">Link Target</label> </td> <td> <select style="width: 100%" .value="${this.Target}" @change="${e=>this.Target=e.target.value}"> <option value="_self">Same tab</option> <option value="_blank">New Tab</option> </select> </td> </tr> <tr> <td> <label style="font-weight: bold;">Link Type</label> </td> <td> <select style="width: 100%" .value="${this.Type}" @change="${e=>{this.LinkURL="",this.Type=e.target.value,this.forceUpdate()}}"> <option value="">Custom url</option> ${this.linkTypes.map((e=>n.html`<option value="${e.GetType()}">${e.GetLabel()}</option>`))} </select> </td> </tr> ${this.GetAdditionalOptions()} <table/> `}async OnApply(){return this.SendResult({Target:this.Target,URL:this.LinkURL,Type:this.Type}),!0}GetAdditionalOptions(){if(""==this.Type)return n.html` <tr> <td> <label style="font-weight: bold">Link URL</label> </td> <td> <input style="width: 100%" type="text" value="${this.LinkURL}" @change="${e=>this.LinkURL=e.target.value}"/> </td> </tr> `;this.linkTypes.find((e=>e.GetType()==this.Type)).Render()}});class Gr{GetNodes(){return{}}GetMenuItems(){return[]}}function Xr(e){return function(t){var n,o;return t.selection instanceof r.NodeSelection&&(null===(n=t.selection.node)||void 0===n||null===(o=n.type)||void 0===o?void 0:o.name)==e}}class Kr extends ct{constructor(e){super(null,!1),this.AttributeName=e,this.Update=this.Update.bind(this)}SetActive(e=null){return this.Active=e,this}SetSelectOnlyNode(e){return this.Select=Xr(e),this}SetIsInsideNode(e){return this.Select=t=>{let n=t.selection.$head;for(let t=n.depth;t>0;t--)if(n.node(t).type.name==e)return!0;return!1},this}SetEnable(e=null){return this.IsEnable=e,this}GetNodeValue(e=""){if(""==e&&(e=this.AttributeName),!(this.View.state.selection instanceof r.NodeSelection))return"";let t=e.split(".");if(1==t.length)return null==this.View.state.selection.node.attrs[e]?"":this.View.state.selection.node.attrs[e];let n=t.shift();if(null==this.View.state.selection.node.attrs[n])return"";let o=null;try{o=JSON.parse(this.View.state.selection.node.attrs[n])}catch(e){return""}return i.Sanitizer.GetStringValueFromPath(o,t)}SetNodeValue(e){this.View.state.selection instanceof r.NodeSelection&&Rt.UpdateNodeAttributes(this.View,this.View.state.selection.from,this.AttributeName,e)}SetIsSubMenu(){return this.IsSubMenu=!0,this}Update(e){if(null!=this.Select){let t=this.Select(e);if(this.dom.style.display=t?"block":"none",!t)return!1}let t=!0;if(null!=this.IsEnable&&(t=this.IsEnable(e),this.UpdateEnable(e,t)),this.Active){let n=t&&this.Active(e)||!1;this.UpdateActive(e,n)}this.SubUpdate(e)}UpdateEnable(e,t=!0){}UpdateActive(e,t=!0){}render(e){return this.View=e,this.dom=n.renderInline(this.SubRender(e)),{dom:this.dom,update:this.Update}}SubUpdate(e){}SubActive(e){}}class Jr{}exports.TextEditor=qr,exports.SchemaBase=Gr,exports.MenuItem=St,exports.SchemaBase=Gr,exports.SharedMenuFunctions={},exports.NodeIsSelected=Xr,exports.NumberMenuItem=class extends Kr{constructor(e,t){super(t),this.Label=e,this.AttributeName=t}SubRender(e){return n.renderInline(n.html` <div style="display: flex;align-items: center;margin-right: 5px"> <span style="font-weight: bold">${this.Label}:</span> <input @change="${e=>{e.stopPropagation(),this.Change(e.target.value)}}" placeholder="Default" style="display:inline-block;text-align: right;width: 80px;margin:0;margin-left: 3px;min-height: 25px;height: 25px;padding: 0 3px" type="number"/> </div>`)}Change(e){this.SetNodeValue(e)}SubUpdate(e){super.SubUpdate(e);let t=this.GetNodeValue();this.dom.querySelector("input").value=t}},exports.DropDownMenuItem=class extends Kr{constructor(e,t){super(t),this.Label=e,this.AttributeName=t,this.Items=[]}AddOption(e,t){return this.Items.push({Label:e,Value:t}),this}SubRender(e){return n.renderInline(n.html` <div style="display: flex;align-items: center;margin-right: 5px"> <span style="font-weight: bold">${this.Label}:</span> <select @change="${e=>{e.stopPropagation(),this.Change(e.target.value)}}" style="display:inline-block;margin:0;margin-left: 3px;min-height: 25px;height: 25px;padding: 0 3px" > ${this.Items.map((e=>n.html`<option value="${e.Value}">${e.Label}</option>`))} </select> </div>`)}SubUpdate(e){this.dom.querySelector("select").value=this.GetNodeValue()}Change(e){this.SetNodeValue(e)}},exports.ButtonMenuItem=class extends Kr{constructor(e,t){super(""),this.Label=e,this.OnClick=t,this.Items=[]}SubRender(e){return n.renderInline(n.html` <div style="display: flex;align-items: center;margin-right: 5px"> <button style="cursor: pointer" @click="${e=>this.OnClick(this.View)}">${this.Label}</button> </div>`)}SubUpdate(e){}},exports.TextEditorUtilities=Rt,exports.TextEditorUtils=class{static CreateSimpleText(e){return{type:"doc",content:[{type:"paragraph",content:[{type:"text",text:e}]}]}}static CreateOneLineText(e){return{type:"doc",content:[{type:"text",text:e}]}}},exports.Utils={},exports.Utils.getActiveMarks=Gt,exports.ColorMark={},exports.ColorMark.ColorMark=jr,exports.FontSizeMark={},exports.FontSizeMark.FontSizeMark=Br,exports.BasicLinkType=class extends Jr{constructor(e,t){super(),this.Type=e,this.Label=t}GetLabel(){return this.Label}GetType(){return this.Type}Render(){return null}},exports.LinkTypeBase=Jr,exports.AlignMenu=pn,exports.Schema={},exports.Schema.schema=Ut,exports.Schema.schemaSingleLine=qt,exports.Schema.marks=Wt}));
