rndefine("#RNMainRatingField",["#RNMainCore/EventManager","#RNMainFormBuilderCore/FieldWithPrice.Options","#RNMainFormBuilderCore/FieldWithPrice.Model","lit","#RNMainCore/Sanitizer","lit/decorators","#RNMainFormBuilderCore/FieldBase","#RNMainFormBuilderCore/FieldWithPrice"],(function(e,t,i,s,r,a,l,o){"use strict";class n extends t.FieldWithPriceOptions{LoadDefaultValues(){super.LoadDefaultValues(),this.Type="rating",this.Label="Rating",this.ReadOnly=!1,this.DefaultValue=0,this.NumberOfItems=5,this.AllowHalf=!1}}class u extends i.FieldWithPriceModel{constructor(e,t){super(e,t),this.IsFocused=!1}InternalSerialize(e){super.InternalSerialize(e),e.Value=this.GetValue(),e.NumberOfItems=this.Options.NumberOfItems}GetStoresInformation(){return!0}GetIsUsed(){return!!super.GetIsUsed()&&0!=this.Value}get IsReadonly(){return!!this.Options.ReadOnly||super.IsReadonly}GetValue(){return this.GetIsVisible()&&0!=this.Value?this.Value:""}InitializeStartingValues(){this.Options.NumberOfItems<=0&&(this.Options.NumberOfItems=1),this.Value=Math.min(this.Options.NumberOfItems,this.GetPreviousDataProperty("Value",this.Options.DefaultValue))}GetText(){return 0==this.Value?"":this.Value+"/"+this.Options.NumberOfItems}SetValue(e,t=null){if((e=r.Sanitizer.SanitizeNumber(e,0))>0&&this.RemoveError("required"),isNaN(e))return this.Value=e,void this.FireValueChanged(t);e=Math.min(e,this.Options.NumberOfItems),this.Value=e,this.FireValueChanged()}render(){return s.html`<rn-rating-field .model="${this}"></rn-rating-field>`}}var d;let h=a.customElement("rn-rating-field")(d=class extends o.FieldWithPrice{constructor(...e){super(...e),this.HoverValue=0}static get properties(){return l.FieldBase.properties}SubRender(){return s.html` <div style="position: relative;"> <div class='ratingContainer' @mouseleave=${()=>{this.HoverValue=0,this.forceUpdate()}}> ${new Array(Math.max(1,this.model.Options.NumberOfItems)).fill(1).map(((e,t)=>s.html` <div style="display: inline-block;position: relative" @mousemove=${e=>this.MouseMove(e,t)}> <img src=${this.model.RootFormBuilder.AdditionalOptions.URL+"images/rating/"+this.GetStarImage(t)} @click=${()=>{this.ValueSelected(t+1)}}/> <div style="position: absolute;height: 100%;width: 50%;top:0;left:0" @click=${e=>{e.stopPropagation(),this.ValueSelected(t+(this.model.Options.AllowHalf?.5:1))}} @mousemove=${e=>{this.model.Options.AllowHalf&&(e.stopPropagation(),console.log(t+.5),this.HoverValue=t+.5,this.forceUpdate())}}></div> </div>`))} </div> </div> `}MouseMove(e,t){this.HoverValue=t+1,this.forceUpdate()}ValueSelected(e){this.HoverValue=0,this.model.SetValue(e)}GetStarImage(e){let t=this.model.Value;return this.HoverValue>0&&(t=this.HoverValue),e>=t?"star-empty.png":e+1<=t?"star.png":"star-half.png"}})||d;exports.RatingFieldModel=u,exports.RatingField=h,exports.RatingFieldOptions=n,e.EventManager.Subscribe("GetFieldOptions",(e=>{if("rating"==e)return new n})),e.EventManager.Subscribe("GetFieldModel",(e=>{if("rating"==e.Options.Type)return new u(e.Options,e.Parent)}))}));
